(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1466:function(e,t,a){},1499:function(e,t,a){"use strict";a.r(t);a(100);var n=a(43),r=(a(67),a(20)),o=(a(99),a(45)),l=(a(129),a(24)),c=(a(141),a(465),a(22),a(62),a(368),a(35),a(26),a(27),a(28),a(19),a(34),a(39),a(38),a(40),a(32),a(41),a(0)),i=a.n(c),u=a(463),s=a(4),d=function(e){return s.c.request({url:"/manage-open/module/search",data:e,method:"post",headers:{}})},m=function(e){return s.c.request({url:"/manage-open/product/published/module",method:"post",data:e,headers:{}})},p=function(e){return s.c.request({url:"/manage-open/firmware/device/version/addAll",method:"post",data:e,headers:{}})},f=function(e){return s.c.request({url:"/manage-open/firmware/device/version/inform",method:"post",data:e,headers:{}})},b=a(97),y=a(33),v=(a(196),a(85)),h=(a(220),a(117)),g=(a(816),a(371)),E=(a(175),a(71)),O=a(106),w=a.n(O),j=(a(55),a(485));var I=l.a.create()(Object(c.forwardRef)(function(e,t){var a=e.form,n=e.setStepCur,r=e.actionData,u=a.getFieldDecorator,s=(a.validateFields,Object(c.useRef)(null)),d=function(){a.validateFields(function(e,t){if(!e){console.log("Received values of form: ",t);var a={deviceVersionName:t.deviceVersionName,filePath:t.filePath,totalVersion:t.totalVersion,extVersion:r.burnFileVersion,deviceVersionType:t.deviceVersionType,firmwareVersionType:"",mainVersion:"",deviceVersionId:""};n(1,a)}})};return Object(c.useImperativeHandle)(t,function(){return{onFinish:d}},[]),i.a.createElement("div",{style:{padding:"0 100px"}},i.a.createElement(l.a,{labelCol:{span:8},wrapperCol:{span:16},className:"basic-params",colon:!1},i.a.createElement(l.a.Item,{label:"插件名称："},u("deviceVersionName",{rules:[{required:!0,whitespace:!0,message:"请输入插件名称"}]})(i.a.createElement(o.a,{maxLength:30}))),i.a.createElement(l.a.Item,{label:"插件编号："},i.a.createElement("span",null,"0")),i.a.createElement(l.a.Item,{label:"硬件版本号："},u("totalVersion",{})(i.a.createElement(o.a,null))),i.a.createElement(l.a.Item,{label:"当前软件版本号："},i.a.createElement("span",null,r.burnFileVersion)),i.a.createElement(l.a.Item,{label:"待上传软件版本号："},u("deviceVersionType",{rules:[{required:!0,message:"请输入待上传软件版本号"}]})(i.a.createElement(o.a,{maxLength:30}))),i.a.createElement(l.a.Item,{label:"固件程序："},u("filePath",{})(i.a.createElement(o.a,{placeholder:"请输入下载URL或者上传附件"}))),i.a.createElement(l.a.Item,{label:" "},u("filePath2",{})(i.a.createElement(j.a,{ref:s,maxCount:1,cb:function(){console.log(a.getFieldValue("filePath2")),a.setFieldsValue({filePath:a.getFieldValue("filePath2")[0].url})},format:".bin,.hex,.zip,.cyacd,.apk,.dpkg",isNotImg:!0,maxSize:200})))))})),x=(a(294),a(162));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach(function(t){T(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function T(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done)&&(a.push(l.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var C=[{title:"已使用模组的产品",dataIndex:"productName"},{title:"发布时间",dataIndex:"createTime",render:function(e){var t=e&&y.b.utcToDev(e);return i.a.createElement("span",null,t)}},{title:"创建账号",dataIndex:"contact"},{title:"联系号码",dataIndex:"tel"}];var P=l.a.create()(Object(c.forwardRef)(function(e,t){var a=e.setStepCur,n=e.actionData,r=e.subObj,o=k(Object(c.useState)([]),2),l=o[0],u=o[1],s=k(Object(c.useState)([]),2),d=s[0],f=s[1],b=k(Object(c.useState)([]),2),y=b[0],v=b[1];Object(c.useEffect)(function(){m({moduleId:n.moduleId}).then(function(e){0===e.data.code&&u(e.data.data.list)})},[]);var g={onChange:function(e,t){console.log(e,"勾选的数据"),f(e),v(t)},selectedRowKeys:d},E=function(){if(d.length){var e=N(N({},r.one),{},{productIdList:d});p(e).then(function(e){0===e.data.code?(h.a.success("升级成功"),a(2,y)):h.a.error("升级失败")})}else h.a.info("请勾选数据")};return Object(c.useImperativeHandle)(t,function(){return{onFinish:E}},[d]),i.a.createElement("div",null,i.a.createElement(x.a,{rowKey:"productId",rowSelection:g,columns:C,dataSource:l}))})),R=o.a.TextArea;var V=l.a.create()(Object(c.forwardRef)(function(e,t){var a=e.form,n=e.commitAll,r=a.getFieldDecorator,o=(Object(c.useRef)(null),function(){a.validateFields(function(e,t){e||n(t.textTemplate)})});return Object(c.useImperativeHandle)(t,function(){return{onFinish:o}},[]),i.a.createElement("div",{style:{padding:"0 100px"}},i.a.createElement(l.a,{labelCol:{span:6},wrapperCol:{span:18},className:"basic-params"},i.a.createElement(l.a.Item,{label:"短信文案"},i.a.createElement("span",null,"短信通知")),i.a.createElement(l.a.Item,{label:"短信文案"},r("textTemplate",{})(i.a.createElement(R,{rows:4,readOnly:!0,placeholder:"尊敬的客户您好：clife平台已升级通信模组 {模组名称} ，您关联使用的产品 {产品名称}，可进行设备模组固件升级，敬请留意~"})))))}));function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done)&&(a.push(l.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var F=E.a.TabPane,A=g.a.Step,J=["更新模组固件","选择产品对象","发送升级通知"];var M=function(e){var t=e.noticeVis,a=e.handleCancel,n=(e.handleOk,e.actionData),o=D(Object(c.useState)(0),2),l=o[0],u=o[1],s=Object(c.useRef)(),d=Object(c.useRef)(),m=Object(c.useRef)(),p=D(Object(c.useState)({one:{},two:{},three:{}}),2),b=p[0],y=p[1],O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;0===l?y(function(e){var a=w()(e);return a.one=w()(t),a}):1===l&&y(function(e){var a=w()(e);return a.two=w()(t),a}),u(e)};return i.a.createElement(v.a,{title:"更新通知",visible:t,onOk:function(){},onCancel:a,width:"800px",wrapClassName:"module-upgrade-notice",footer:[0!==l&&i.a.createElement(r.a,{key:"previous",onClick:function(){u(l-1)}},"上一步"),i.a.createElement(r.a,{type:"primary",key:"next",onClick:function(){0===l?s.current.onFinish():1===l?d.current.onFinish():2===l&&m.current.onFinish()}},2===l?"升级通知":"下一步")]},i.a.createElement("div",{className:"add-scheme-modal"},i.a.createElement("div",{className:"step-box "},i.a.createElement(g.a,{current:l},J.map(function(e,t){return i.a.createElement(A,{key:e,title:e})}))),i.a.createElement("div",{className:"formbox"},i.a.createElement(E.a,{activeKey:l+"",animated:!1},i.a.createElement(F,{tab:"基本参数",key:"0"},i.a.createElement(I,{setStepCur:O,wrappedComponentRef:s,actionData:n})),i.a.createElement(F,{tab:"功能参数",key:"1"},i.a.createElement(P,{setStepCur:O,subObj:b,wrappedComponentRef:d,actionData:n})),i.a.createElement(F,{tab:"功能参数",key:"2"},i.a.createElement(V,{wrappedComponentRef:m,actionData:n,commitAll:function(e){var t=b.two.map(function(e){return{productId:e.productId,productName:e.productName,contact:e.contact,tel:e.tel}}),r={textTemplate:"尊敬的客户您好：clife平台已升级通信模组 {模组名称} ，您关联使用的产品 {产品名称}，可进行设备模组固件升级，敬请留意~",version:b.one.deviceVersionType,hetModuleTypeName:n.moduleName,productDTOList:t};f(r).then(function(e){0===e.data.code&&(h.a.success("操作成功"),a())})}}))))))};a(1466);function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(a,!0).forEach(function(t){L(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function L(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done)&&(a.push(l.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var K=l.a.Item;t.default=l.a.create()(function(e){var t=e.form,a=t.getFieldDecorator,s=(t.validateFields,t.getFieldsValue),m=H(Object(c.useState)({pageIndex:1,pageRows:10}),2),p=m[0],f=m[1],v=H(Object(c.useState)(0),2),h=v[0],g=v[1],E=H(Object(c.useState)([]),2),O=E[0],w=E[1],j=H(Object(c.useState)(!1),2),I=j[0],x=j[1],S=H(Object(c.useState)(!1),2),N=S[0],T=S[1],k=H(Object(c.useState)({}),2),C=k[0],P=k[1],R=[{title:"模组型号",dataIndex:"hetModuleTypeName",key:"hetModuleTypeName",render:function(e){return i.a.createElement("span",{title:e},e)}},{title:"生产厂家",dataIndex:"brandName",key:"brandName",render:function(e){return i.a.createElement("span",{title:e},e)}},{title:"模组IC型号",dataIndex:"productName",key:"productName",render:function(e){return i.a.createElement("span",{title:e},e)}},{title:"模组尺寸",dataIndex:"schemeType",key:"schemeType",render:function(e,t){return i.a.createElement("span",null,t.sizeThickness,"*",t.sizeWidth,"*",t.sizeHeight,"mm")}},{title:"更新时间",dataIndex:"modifyTime",key:"modifyTime",render:function(e){var t=e&&y.b.utcToDev(e);return i.a.createElement("span",{title:t},t)}},{title:"操作",key:"",render:function(e,t){return i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{onClick:function(){V(t)}},"更新通知"))}}],V=function(e){P(e),T(!0)};Object(c.useEffect)(function(){D()},[p.pageRows,p.pageIndex]);var D=function(){var e={},t=s().hetModuleTypeName;t&&t.trim()&&(e.hetModuleTypeName=t.trim()),e=z(z({},e),p),x(!0),d(e).then(function(e){0==e.data.code&&(w(e.data.data.list),g(e.data.data.pager.totalRows))}).finally(function(){x(!1)})};return i.a.createElement("div",{className:"panelMn-page",style:{minWidth:"1200px"}},i.a.createElement(u.a,{title:"模组升级&通知"},i.a.createElement(l.a,{layout:"inline"},i.a.createElement(K,{label:"关键字"},a("hetModuleTypeName",{})(i.a.createElement(o.a,{placeholder:"请输入生产厂商或模组型号",style:{width:240},allowClear:!0}))),i.a.createElement(K,null,i.a.createElement(r.a,{type:"primary",onClick:function(){1==p.pageIndex?D():f({pageIndex:1,pageRows:10})}},"查询")),i.a.createElement(K,null,i.a.createElement(r.a,{onClick:function(){t.resetFields()}},"重置")))),i.a.createElement(n.a,null,i.a.createElement(b.a,{rowKey:"moduleId",columns:R,dataSource:O,loading:I,pagination:{defaultCurrent:1,current:p.pageIndex,onChange:function(e,t){t===p.pageRows?f(function(a){var n=JSON.parse(JSON.stringify(a));return Object.assign(n,{pageIndex:e,pageRows:t})}):f(function(e){var a=JSON.parse(JSON.stringify(e));return Object.assign(a,{pageIndex:1,pageRows:t})})},pageSize:p.pageRows,total:h,showQuickJumper:!0,showTotal:function(){return i.a.createElement("span",null,"共 ",i.a.createElement("a",null,h)," 条")}}})),N&&i.a.createElement(M,{noticeVis:N,handleCancel:function(){T(!1)},actionData:C}))})}}]);