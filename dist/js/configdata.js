(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1339:function(e,t,n){"use strict";n(20),n(35),n(36),n(28),n(45),n(46),n(22),n(31),n(32);var a=n(0),r=n.n(a);n(1342);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,c(t).apply(this,arguments))}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,r.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.children,n=e.title;return r.a.createElement("div",{className:"title-tab"},r.a.createElement("div",{className:"title-tab-option"},r.a.createElement("span",{className:"title-tab-title"},n)),r.a.createElement("div",{className:"title-tab-option"},t))}}])&&i(n.prototype,a),o&&i(n,o),t}();s.Option=function(e){var t=e.children,n=e.label,a=e.align,o=void 0===a?"left":a;return r.a.createElement("div",{className:"".concat("left"===o?"title-tab-item":"title-tab-item-right")},r.a.createElement("span",{className:n?"title-table-label":"title-table-label-non"},n?n+":":""),t)},t.a=s},1340:function(e,t,n){"use strict";n(20),n(35),n(36),n(117),n(29),n(335),n(28),n(334),n(65),n(280),n(164),n(40),n(41),n(45),n(37),n(46),n(22),n(336),n(31),n(166),n(439),n(243),n(30),n(32);var a=n(0);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}t.a=function(e){return function(t){function n(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=s(this,(e=p(n)).call.apply(e,[this].concat(r)))).state={pageIndex:1},t.onChange=function(e){var n=t.state.pageIndex;t.setState({pageIndex:e||n||1},function(){var e=t.state,n=[];for(var a in e)e[a]&&n.push("".concat(a,"=").concat(e[a]));t.props.history.replace("?"+n.join("&")),t.props.getList(l({},e))})},t.onFilter=function(e){var n=t.props.form;n&&(e=n.getFieldsValue()),t.setState(l({},e),function(){t.onChange(1)})},t.onReset=function(){var e=t.props.form;e&&e.resetFields()},t}var r,i,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,a["Component"]),r=n,(i=[{key:"componentDidMount",value:function(){var e=this,t={pageIndex:1},n=this.props.history.location.search;n&&n.length&&n.slice(1).split("&").map(function(e){if(/^(.+)=(.+)$/.test(e)){var n=e.split("=");t[n[0]]=decodeURI(n[1])}}),this.setState(l({},t),function(){e.props.getList(t)});var a=this.props.form;if(a){var r=a.getFieldsValue(),o=Object.keys(r);for(var i in t)o.includes(i)&&a.setFieldsValue(c({},i,+t[i]||t[i]))}}},{key:"render",value:function(){return a.createElement(e,o({},this.props,{onChange:this.onChange,onFilter:this.onFilter,onReset:this.onReset,query:this.state}))}}])&&u(r.prototype,i),d&&u(r,d),n}()}},1341:function(e,t,n){"use strict";n(20),n(35),n(36),n(28),n(45),n(46),n(22),n(31),n(32);var a=n(0),r=n(13),o=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}t.a=function(e){return function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),c(this,u(n).apply(this,arguments))}var r,i,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,a["Component"]),r=n,(i=[{key:"componentDidMount",value:function(){var e=o.a.findDOMNode(this);e&&e.parentElement&&e.parentElement.parentElement&&(e.parentElement.parentElement.scrollTop=0)}},{key:"render",value:function(){return a.createElement(e,this.props)}}])&&l(r.prototype,i),p&&l(r,p),n}()}},1342:function(e,t,n){},1344:function(e,t,n){"use strict";n(20),n(35),n(36),n(117),n(29),n(333),n(335),n(281),n(28),n(65),n(435),n(164),n(45),n(37),n(46),n(22),n(207),n(773),n(336),n(31),n(243),n(774),n(775),n(776),n(777),n(778),n(779),n(780),n(781),n(782),n(783),n(784),n(785),n(786),n(787),n(788),n(789),n(30),n(32),n(284);var a=n(209),r=(n(339),n(176)),o=n(0);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=r.a.TreeNode;var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,s(t).call(this,e))).handleCheck=function(e,t){"function"==typeof n.props.onChange&&n.props.onChange(e,t)},n.handleSelect=function(e,t){var a=n.state.expandedKeys,r=t.node.props.eventKey;a.includes(r)?n.setState({expandedKeys:a.filter(function(e){return e!==r})}):n.setState({expandedKeys:[].concat(l(a),[r])})},n.handleExpand=function(e){n.setState({expandedKeys:e})},n.state={expandedKeys:[],selectedKeys:[]},n}var n,i,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,o["Component"]),n=t,(i=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isExpand,n=e.dataSource,a=[];t&&function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;t&&t.forEach(function(t){t.children&&t.children.length&&a.push(n+t.id),e(t.children,n+t.id+"-",a)})}(n,"",a),this.setState({expandedKeys:a})}},{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.target,i=e.isCheck,l=void 0===i||i,c=e.checkStrictly,u=void 0!==c&&c,s=e.searchStr,p=void 0===s?"":s,y=this.state,h=y.expandedKeys,b=y.selectedKeys,g=l&&!u?n:Array.from(new Set(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.map(function(e){var n=e.split("-"),a="";n.map(function(e){e&&(a+=e,t.push(a),a+="-")})}),t}(n)));return l||g.length?o.createElement(r.a,{blockNode:!0,checkable:l,defaultExpandParent:!0,multiple:!0,showLine:!l,checkStrictly:u,selectedKeys:b,checkedKeys:g,expandedKeys:h,onCheck:this.handleCheck,onSelect:this.handleSelect,onExpand:this.handleExpand},l?function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map(function(t){var r=t.children,i=d(t,["children"]),l=i.name.toLowerCase(),c=a.toLowerCase(),u=l.indexOf(c),s=i.name.substr(0,u),p=i.name.substring(u,u+a.length),y=i.name.substr(u+a.length),h=u>-1?o.createElement("span",null,s,o.createElement("span",{style:{color:"#f50"}},p),y):o.createElement("span",null,i.name);return o.createElement(m,f({},i,{key:n+i.id,title:h}),e(r,n+i.id+"-",a))})}(t,"",p):function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map(function(t){var r=t.children,i=d(t,["children"]);return n.includes(a+i.id)?o.createElement(m,f({},i,{disableCheckbox:!0,key:a+i.id,title:i.name}),e(r,n,a+i.id+"-")):null}).filter(function(e){return e})}(t,g)):o.createElement(a.a,null)}}])&&c(n.prototype,i),y&&c(n,y),t}();t.a=y},1347:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return c});var a=n(4),r=function(e){return a.b.request({url:"/manage-open/panel/template/list",params:e,method:"get"})},o=function(e){return a.b.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},i=function(e){return a.b.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},l=function(e){return a.b.request({url:"/manage-open/panel/template/delTemplate",data:e,method:"post"})},c=function(e){return a.b.request({url:"/manage-open/panel/template/get",params:e,method:"get"})}},1350:function(e,t,n){"use strict";n(20),n(35),n(36),n(29),n(28),n(65),n(164),n(40),n(41),n(45),n(37),n(46),n(22),n(31),n(30),n(32),n(186);var a=n(72),r=n(0),o=n.n(r);n(287),n(12),n(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=a.a.Option,h={},b={},g={},v=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=f(this,d(t).call(this,e))).triggerChange=function(e){var t=n.props.onChange;t&&(n.props.value?t(u({categoryId:n.props.value.categoryId,subCategoryId:n.props.value.subCategoryId,deviceTypeId:n.props.value.deviceTypeId,deviceSubTypeId:n.props.value.deviceSubTypeId},e)):t(u({},e)))};n.props.value;return n.state={deviceSubCategoryList:[],deviceTypeList:[],isCalculate:!1},n}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,r["Component"]),n=t,(i=[{key:"deviceCategorySelect",value:function(e){if(h[e]){var t=h[e];this.setState({deviceSubCategoryList:t})}this.triggerChange({categoryId:e,subCategoryId:void 0,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceSubCategorySelect",value:function(e){if(b[e]){var t=b[e];this.setState({deviceTypeList:t})}this.triggerChange({subCategoryId:e,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceTypeListSelect",value:function(e){if(g[e]){var t=g[e].defaultDeviceSubtype.deviceSubtypeId;this.triggerChange({deviceTypeId:g[e].deviceTypeId,deviceSubTypeId:t})}}},{key:"componentDidMount",value:function(){this.props.deviceCategoryList}},{key:"componentWillUpdate",value:function(e,t){var n=this;if(!this.state.isCalculate&&e.value&&e.deviceCategoryList&&e.deviceCategoryList.length>0){var a=e.value.categoryId,r=e.value.subCategoryId;if(!a||!r)return;e.deviceCategoryList.map(function(e,t){if(h[e.categoryId]=e.subCategoryList,e.categoryId==a){var o=e.subCategoryList;n.setState({deviceSubCategoryList:o}),o.map(function(e,t){if(b[e.subCategoryId]=e.deviceTypeList,e.subCategoryId==r){var a=e.deviceTypeList;n.setState({deviceTypeList:a}),a.map(function(e,t){g[e.deviceTypeId]=e})}})}}),this.setState({isCalculate:!0})}}},{key:"render",value:function(){var e=this.props.deviceCategoryList||[],t=this.state.deviceSubCategoryList,n=this.state.deviceTypeList,r={},i={},c={};if(void 0!==this.props.value){var u=this.props.value.subCategoryId,s=this.props.value.categoryId;this.props.value.deviceSubTypeId,r={value:s},i={value:u},c={value:this.props.value.deviceTypeId}}return o.a.createElement("div",null,o.a.createElement(a.a,l({onSelect:this.deviceCategorySelect.bind(this),placeholder:"选择一级类目",style:{width:150}},r),e.map(function(e,t){return h[e.categoryId]=e.subCategoryList,o.a.createElement(y,{value:e.categoryId,key:t},e.categoryName)})),o.a.createElement(a.a,l({onSelect:this.deviceSubCategorySelect.bind(this),placeholder:"选择二级类目",style:{width:150}},i),t.map(function(e,t){return b[e.subCategoryId]=e.deviceTypeList,o.a.createElement(y,{value:e.subCategoryId,key:t},e.subCategoryName)})),o.a.createElement(a.a,l({onSelect:this.deviceTypeListSelect.bind(this),placeholder:"选择三级类目",style:{width:150}},c),n.map(function(e,t){return g[e.deviceTypeId]=e,o.a.createElement(y,{value:e.deviceTypeId,key:t},e.deviceTypeName)})))}}])&&p(n.prototype,i),c&&p(n,c),t}();t.a=v},1351:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var a=n(4),r="manage-open",o=function(e){return a.b.request({url:"/".concat(r,"/param/dictionary/list"),params:e,method:"get"})},i=function(e){return a.b.request({url:"/".concat(r,"/param/dictionary/get"),params:{paramId:e},method:"get"})},l=function(e){return a.b.request({url:"/".concat(r,"/param/dictionary/add"),data:e,method:"post"})},c=function(e){return a.b.request({url:"/".concat(r,"/param/dictionary/update"),data:e,method:"post"})},u=function(e){return a.b.request({url:"/".concat(r,"/param/dictionary/delete"),params:{paramId:e},method:"get"})}},1352:function(e,t,n){},1353:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return c});var a=n(4),r="manage-open",o=function(e){return a.b.request({url:"/".concat(r,"/protocol/template/getList"),params:e,method:"get"})},i=function(e){return a.b.request({url:"/".concat(r,"/protocol/template/getByTemplateNumber"),params:{templateNumber:e},method:"get"})},l=function(e){return a.b.request({url:"/".concat(r,"/protocol/template/update"),data:e,method:"post"})},c=function(e){return a.b.request({url:"/".concat(r,"/protocol/template/insert"),data:e,method:"post"})}},1355:function(e,t,n){},1356:function(e,t,n){},1357:function(e,t,n){},1358:function(e,t,n){},1359:function(e,t,n){},1360:function(e,t,n){},1361:function(e,t,n){},1362:function(e,t,n){},1363:function(e,t,n){},1364:function(e,t,n){},1365:function(e,t,n){},1366:function(e,t,n){},1392:function(e,t,n){"use strict";n.r(t),n.d(t,"H5TemplateInfo",function(){return k});n(20),n(35),n(36),n(29),n(28),n(65),n(435),n(164),n(40),n(41),n(45),n(37),n(46),n(22),n(74),n(790),n(31),n(242),n(243),n(30),n(32),n(92);var a=n(33),r=(n(71),n(21)),o=(n(241),n(118)),i=(n(1308),n(1307)),l=(n(138),n(79)),c=(n(165),n(10)),u=(n(279),n(152)),s=(n(443),n(186),n(72)),p=(n(163),n(50)),f=n(0),d=n.n(f),m=n(1347),y=(n(1352),n(27));function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t,n,a,r,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(a,r)}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=p.a.Item,j=s.a.Option,k=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=w(this,I(t).call(this,e))).getH5TemplateInfo=function(e){n.setState({loading:!0}),Object(m.c)({templateId:e}).then(function(e){var t=e.data;if(0===t.code){var a=n.doWithPages(t.data);n.setState({templateInfo:t.data,fileList:a})}}).finally(function(){n.setState(function(){return{loading:!1}})})},n.doWithPages=function(e){for(var t=[],n=0;n<=5;n++){var a="page".concat(n),r=e[a];e[a]&&t.push({url:r,status:"done",type:"image/png",name:"page".concat(n),uid:n})}return t},n.handlePreview=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,n.getBase64(t.originFileObj);case 3:t.preview=e.sent;case 4:n.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){E(o,a,r,i,l,"next",e)}function l(e){E(o,a,r,i,l,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),n.handleCancelPreview=function(){n.setState({previewVisible:!1})},n.handleChange=function(e){"error"===e.file.status?(u.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),n.setState({fileList:e.fileList})},n.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},n.handleSubmit=function(){var e=n.state,t=e.templateInfo,a=e.fileList,r={};a.length<=0?u.a.warning("请上传模板图片!"):(a.map(function(e,t){"done"===e.status&&(e.hasOwnProperty("url")?r["page".concat(t+1)]=e.url:r["page".concat(t+1)]=e.response.data.url)}),n.props.form.validateFields(function(e,a){if(!e){console.log("values =====",a);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{templateNumber:t.templateNumber,templateId:t.templateId,deviceTypeId:t.deviceTypeId,deviceSubtypeId:t.deviceSubtypeId},r);delete o.templatePicList,n.setState({loading:!0}),Object(m.e)(o).then(function(e){0===e.data.code&&u.a.success("模板信息更新成功",3,n.props.history.goBack())}).finally(function(){n.setState(function(){return{loading:!1}})})}}))},n.getCategoryList=function(e){return"string"==typeof e?e.split("-"):["","",""]},n.usercodeValidator=function(e,t,n){t||n("内容不能为空")},n.state={templateInfo:{},fileList:[],productNameList:[]},n}var n,h,k;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,f["Component"]),n=t,(h=[{key:"componentWillMount",value:function(){var e=this.props.match.params;e&&e.templateId&&this.getH5TemplateInfo(e.templateId)}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||u.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||u.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:y.j,data:function(e){return{appId:31438,domainType:4}}},t=this.state,n=t.templateInfo,u=t.fileList,f=this.props.form.getFieldDecorator,m={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:15}}},h=d.a.createElement("div",null,d.a.createElement(c.a,{type:"plus"}),d.a.createElement("div",{className:"ant-upload-text"},"Upload")),g=this.getCategoryList(n.allCategoryName);return d.a.createElement("div",null,d.a.createElement(a.a,{title:"模板基本信息",loading:this.state.loading},d.a.createElement(p.a,{layout:"horizontal",className:"CreataH5Template_from"},d.a.createElement(C,b({label:"模板名称"},m),f("templateName",{initialValue:n.templateName,rules:[{required:!0,message:"模板名称不能为空"}]})(d.a.createElement(l.a,{style:{width:"460px"},type:"text",placeholder:"请输入您喜欢的模板名称",disabled:Boolean(n.status),allowClear:Boolean(!n.templateId),maxLength:20}))),d.a.createElement(p.a.Item,b({className:"chooseProduct",label:"所属分类"},m),d.a.createElement(p.a.Item,{style:{display:"inline-block",width:"150px"}},f("deviceTypeId",{initialValue:g[0],rules:[{required:!0,message:"请您选择一级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"一级类目"}))),d.a.createElement("span",null," "),d.a.createElement(p.a.Item,{style:{display:"inline-block",width:"150px"}},f("deviceSubtypeId",{initialValue:g[1],rules:[{required:!0,message:"请您选择二级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"二级类目"}))),d.a.createElement("span",null," "),d.a.createElement(p.a.Item,{style:{display:"inline-block",width:"150px"}},f("deviceSubtypeId",{initialValue:g[2],rules:[{required:!0,message:"请您选择三级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),initialValue:n.deviceSubtypeId,placeholder:"三级类目"})))),d.a.createElement(C,b({},m,{label:"产品协议"}),f("templateNumber",{initialValue:n.protocolTemplateName,rules:[{required:!0,message:"请您选择协议"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择协议"}))),d.a.createElement(C,b({},m,{label:"性质"}),f("isFree",{initialValue:1,rules:[{required:!0,message:"请您选择性质"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择"},d.a.createElement(j,{value:1},"免费")))),d.a.createElement(C,b({},m,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"}),f("templatePicList",{initialValue:u,rules:[{required:!0,message:"请上传一张图片"}]})(d.a.createElement("div",{className:"product-div"},d.a.createElement(i.a,b({},e,{accept:"image/png",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),u.length>=5?null:h),d.a.createElement(o.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},d.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),d.a.createElement(C,b({},m,{label:"描述"}),f("remark",{initialValue:n.remark})(d.a.createElement(l.a.TextArea,{disabled:Boolean(this.state.status),style:{width:460},onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))),Boolean(this.state.status)?d.a.createElement("div",null):d.a.createElement(C,{style:{textAlign:"center"}},d.a.createElement(r.a,{type:"primary",onClick:this.handleSubmit},"保存")))))}}])&&O(n.prototype,h),k&&O(n,k),t}();t.default=p.a.create()(k)},1393:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(29),n(28),n(435),n(164),n(40),n(41),n(45),n(37),n(46),n(22),n(31),n(30),n(32),n(92);var a,r=n(33),o=(n(138),n(79)),i=(n(279),n(152)),l=(n(1305),n(1306)),c=(n(206),n(80)),u=(n(71),n(21)),s=(n(186),n(72)),p=(n(163),n(50)),f=n(0),d=n.n(f),m=(n(39),n(1351)),y=n(12),h=n(27),b=n(96);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=p.a.Item,j=(s.a.Option,p.a.create()(a=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=w(t).call(this,e),(n=!r||"object"!==g(r)&&"function"!=typeof r?I(a):r).column=[{title:"参数ID",dataIndex:"paramId",key:"paramId",width:"80px"},{title:"名称",dataIndex:"name",key:"name",width:"15%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"参数值",dataIndex:"value",key:"value",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"desc",key:"desc",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"status",key:"status",width:"100px",render:function(e){return d.a.createElement("span",null,e?"有效":"无效")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return d.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"操作",dataIndex:"paramId",key:"operation",width:"120px",render:function(e){return d.a.createElement("div",null,d.a.createElement(c.a,{title:"编辑",placement:"top"},d.a.createElement(u.a,{onClick:n.pushToDetail.bind(I(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",d.a.createElement(l.a,{title:"确认要删除吗",onConfirm:n.deleteDataDic.bind(I(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},d.a.createElement(c.a,{title:"删除",placement:"top"},d.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.state={pageIndex:1,pageRows:10,dataManagerList:[],totalRows:0,searchParams:{},loading:!1,pager:{}},n}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,f["Component"]),n=t,(a=[{key:"pushToDetail",value:function(e){this.props.history.push("/config/datadic/edit/".concat(e))}},{key:"deleteDataDic",value:function(e){var t=this;Object(m.b)(e).then(function(e){e.data.code===y.a&&(i.a.success("删除成功"),t.requestListData())}).catch(function(e){i.a.error("删除失败")})}},{key:"handleReset",value:function(){this.props.form.resetFields(["name"]),this.setState({pageIndex:0,searchParams:{}}),this.requestListData({pageIndex:0,name:""})}},{key:"handleFilter",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){if(!e){console.log("Received values of form: ",n);var a=n.name;t.setState({searchParams:{name:a}}),t.requestListData({name:a,pageIndex:0})}})}},{key:"componentDidMount",value:function(){this.requestListData()}},{key:"requestListData",value:function(e){var t=this,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({pageIndex:this.state.pageIndex,pageRows:this.state.pageRows,order:"asc"},this.state.searchParams);e&&(n=Object.assign({},n,e)),this.setState({loading:!0}),Object(m.e)(n).then(function(e){if(e.data.code===y.a){var n=e.data.data;t.setState({dataManagerList:n.list,totalRows:n.pager.totalRows,pageIndex:n.pager.pageIndex,loading:!1,pager:n.pager})}}).catch(function(e){t.setState({loading:!0})})}},{key:"addDataDic",value:function(){this.props.history.push("/config/datadic/add")}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({pageIndex:e}),this.requestListData({pageRows:this.state.pageRows,pageIndex:e})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.dataManagerList;return d.a.createElement("div",{style:{minWidth:"1400"}},d.a.createElement(r.a,null,d.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"数据字典管理"),d.a.createElement(p.a,{layout:"inline",onSubmit:this.handleFilter.bind(this)},d.a.createElement(C,{label:"名称"},e("name")(d.a.createElement(o.a,{style:{width:"240px"},placeholder:"请输入名称"}))),d.a.createElement(C,null,d.a.createElement(u.a,{type:"primary",htmlType:"submit"},"查询")),d.a.createElement(C,null,d.a.createElement(u.a,{onClick:this.handleReset.bind(this)},"重置")),d.a.createElement(C,null,d.a.createElement(u.a,{type:"primary",onClick:this.addDataDic.bind(this)},"新增")))),d.a.createElement(r.a,{style:{marginTop:"10px"}},d.a.createElement(b.a,{rowKey:function(e){return e.paramId},columns:this.column,dataSource:t,bordered:!0,pager:this.state.pager,loading:this.state.loading,onPageChange:this.handlePagination.bind(this)})))}}])&&O(n.prototype,a),s&&O(n,s),t}())||a);t.default=j},1394:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(28),n(435),n(164),n(45),n(46),n(22),n(31),n(242),n(32),n(71);var a,r,o,i=n(21),l=(n(436),n(168)),c=(n(138),n(79)),u=(n(92),n(33)),s=(n(165),n(10)),p=(n(186),n(72)),f=(n(163),n(50)),d=n(0),m=n.n(d),y=n(39),h=n(104),b=n(73),g=n(1351),v=n(12),E=n(27);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function S(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=f.a.Item,P=(p.a.Option,a=Object(y.b)(function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"])}}),r=f.a.create({name:"template"}),a(o=Object(h.g)(o=r(o=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=S(this,C(t).call(this,e))).handeleUpdate=function(e){e.paramId=n.state.paramId,Object(g.d)(e).then(function(e){n.props.history.push("/config/datadic/list")})},n.handleAdd=function(e){Object(g.a)(e).then(function(e){n.props.history.push("/config/datadic/list")})},n.handleSubmit=function(e){e.preventDefault(),n.props.form.validateFieldsAndScroll(function(e,t){if(!e){console.log("Received values of form: ",t);var a={name:t.dicname,status:t.dicstatus,desc:t.dicdesc,value:t.dicvalue};a=E.d.filterParam(a),n.state.isEdit?n.handeleUpdate(a):n.handleAdd(a)}})},n.state={isEdit:!1,paramId:"",dicname:"",dicstatus:"",dicdesc:"",dicvalue:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,d["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if(t&&t.paramId){this.setState({isEdit:!0,paramId:t.paramId});var n=t.paramId;Object(g.c)(n).then(function(t){if(t.data.code===v.a){var n=t.data.data;e.setState({paramId:n.paramId,dicname:n.name,dicstatus:n.status+"",dicdesc:n.desc,dicvalue:n.value})}})}}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.isEdit||!1,n=this.state,a=n.dicname,r=n.dicstatus,o=n.dicdesc,p=n.dicvalue;return m.a.createElement("div",null,m.a.createElement(u.a,null,m.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},m.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},t?"编辑数据字典":"新增数据字典"),m.a.createElement("div",null,m.a.createElement(b.b,{to:"/config/datadic/list",style:{padding:"10px"}},m.a.createElement(s.a,{type:"left"})," 返回")))),m.a.createElement(u.a,{style:{marginTop:"20px"}},m.a.createElement(f.a,w({},{labelCol:{xs:{span:16},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),m.a.createElement(k,{label:"名称"},e("dicname",{initialValue:a,rules:[{required:!0,message:"模板名称不能为空"}]})(m.a.createElement(c.a,{type:"text",style:{width:"300px"},maxLength:30,placeholder:"请输入您喜欢的模板名称,长度不超过30"}))),m.a.createElement(k,{label:"参数值"},e("dicvalue",{initialValue:p,rules:[{required:!0,message:"参数值不能为空"}]})(m.a.createElement(c.a.TextArea,{rows:7,placeholder:"请输入参数值,限制内容长度5000",maxLength:5e3}))),m.a.createElement(f.a.Item,{label:"状态"},e("dicstatus",{rules:[{required:!0,message:"请选择状态"}],initialValue:r})(m.a.createElement(l.a.Group,{style:{width:150}},m.a.createElement(l.a,{value:"1"},"有效"),m.a.createElement(l.a,{value:"0"},"无效")))),m.a.createElement(k,{label:"描述"},e("dicdesc",{rules:[{required:!0,message:"请输入描述"}],initialValue:o})(m.a.createElement(c.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容,限制内容长度50",maxLength:50}))),m.a.createElement(k,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:4}}},m.a.createElement(i.a,{type:"primary",htmlType:"submit"},t?"保存":"添加")))))}}])&&I(n.prototype,a),r&&I(n,r),t}())||o)||o)||o);t.default=P},1400:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(28),n(45),n(46),n(22),n(31),n(166),n(243),n(32),n(92);var a,r=n(33),o=(n(341),n(102)),i=n(0),l=n.n(i),c=n(458),u=n(73),s=n(104),p=n(39),f=(n(281),n(65),n(241),n(118)),d=(n(138),n(79)),m=(n(139),n(44)),y=(n(1305),n(1306)),h=(n(206),n(80)),b=(n(71),n(21)),g=(n(186),n(72)),v=(n(163),n(50)),E=(n(1310),n(1313)),O=(n(435),n(164),n(792),n(446)),w=(n(279),n(152)),I=n(12),S=(n(1350),n(96));n(1362);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function k(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x,T=v.a.Item,N=Object(p.b)(function(e){return{deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}})(a=v.a.create()(a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=k(this,P(t).call(this,e))).state={dataSource:[],pageIndex:0,pageRows:10,isLoading:!1,pager:{},searchParams:{}},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,l.a.Component),n=t,(a=[{key:"handelUploadFile",value:function(e){if(e.file.status,"done"===e.file.status){var t=e.file.response;0==t.code?(w.a.success("".concat(e.file.name," 文件上传成功")),this.refreshTable()):w.a.error("".concat(t.msg))}else"error"===e.file.status&&w.a.error("".concat(e.file.name," 文件上传失败."),10)}},{key:"refreshTable",value:function(){console.log("refresh Table");var e={pageRows:this.state.pageRows,pageIndex:this.state.current};this.getChildTableRequest(e)}},{key:"handleSearch",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){console.log("value:"+JSON.stringify(n));var a={};t.props.filterPannel.map(function(e,t){if("DeviceType"==e.type){var r=n.deviceTypeSelect;if(r&&3==r.length){var o=e.paramskey,i=r[2];a[o]=i}}else{var l=e.paramskey,c=n[l];c&&(a[l]=c)}}),t.setState({searchParams:a}),t.getChildTableRequest(a)})}},{key:"handlePagination",value:function(e){this.setState({pageIndex:e});var t={pageRows:this.state.pageRows,pageIndex:e};t=Object.assign({},this.state.searchParams,t),this.getChildTableRequest(t)}},{key:"getFilterPannel",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.deviceCascaderList;return this.props.filterPannel.map(function(n,a){return"Input"===n.type?l.a.createElement(T,{label:n.title,key:a},e(n.paramskey)(l.a.createElement(d.a,{placeholder:n.placeholder,maxLength:20,style:{width:"260px"}}))):"DeviceType"===n.type?l.a.createElement(T,{label:n.title,key:a},e("deviceTypeSelect")(l.a.createElement(O.a,{options:t,placeholder:"请选择所属分类",style:{width:"260px"}}))):l.a.createElement("span",null)})}},{key:"componentDidMount",value:function(){this.getChildTableRequest(),this.props.refFunction(this.refreshTable.bind(this))}},{key:"getChildTableRequest",value:function(e){var t=this;this.setState({isLoading:!0}),this.props.getTableRequest(e).then(function(e){if(t.setState({isLoading:!1}),e.data.code===I.a){var n=e.data.data.list,a=e.data.data.pager;t.setState({dataSource:n,isLoading:!1,pager:a})}}).catch(function(e){t.setState({isLoading:!1})})}},{key:"handleNewProtocolDic",value:function(){this.props.handleNewProtocolDic()}},{key:"resetFields",value:function(){this.setState({searchParams:{}}),this.props.form.resetFields()}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{style:{marginBottom:"10px"}},l.a.createElement(b.a,{style:{float:"right"},type:"primary",onClick:this.handleNewProtocolDic.bind(this)},"新建")),l.a.createElement(v.a,{layout:"inline",onSubmit:this.handleSearch.bind(this),style:{marginBottom:"10px"}},this.getFilterPannel(),l.a.createElement(T,null,l.a.createElement(b.a,{htmlType:"submit"},"查询")),l.a.createElement(T,null,l.a.createElement(b.a,{onClick:this.resetFields.bind(this)},"重置"))),l.a.createElement(S.a,{className:"proptcolDicBase",bordered:!0,columns:this.props.columns,dataSource:this.state.dataSource,rowKey:this.props.rowKey,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,loading:this.state.isLoading}))}}])&&j(n.prototype,a),r&&j(n,r),t}())||a)||a,D=n(221),_=n(27),M=n(440);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=E.a.SHOW_PARENT,U=v.a.Item,z=g.a.Option,K=Object(p.b)(function(e){return{subjectMenuList:e.getIn(["globalProtocolDicInfo","subjectMenu"]),subjectExtendsMenuLsit:e.getIn(["globalProtocolDicInfo","subjectExtendsMenu"]),functionMenuList:e.getIn(["globalProtocolDicInfo","functionMenu"]),functionExtendsMenuList:e.getIn(["globalProtocolDicInfo","functionExtendsMenu"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}},function(e){return{getSubjectMenu:function(){e(M.e())},getSubjectExtendsMenu:function(){e(M.d())},getFunctionMenu:function(){e(M.c())},getFunctionExtendsMenu:function(){e(M.b())}}})(x=v.a.create()(x=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=F(t).call(this,e),(n=!r||"object"!==R(r)&&"function"!=typeof r?q(a):r).columns=[{title:"ID",dataIndex:"commonId",width:"100px"},{title:"协议数据",dataIndex:"protocolName"},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"协议类型",dataIndex:"dataTypeNameList",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"commonId",key:"0",width:"100px",render:function(e){return l.a.createElement("div",null,l.a.createElement(h.a,{title:"编辑",placement:"top"},l.a.createElement(b.a,{onClick:n.handleEdit.bind(q(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",l.a.createElement(y.a,{title:"确认要删除吗",onConfirm:n.handleDelete.bind(q(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},l.a.createElement(h.a,{title:"删除",placement:"top"},l.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.state={visibleModal:!1,isEdit:!1,commonData:{}},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,l.a.Component),n=t,(a=[{key:"handleEdit",value:function(e){var t=this;Object(D.b)({commonId:e}).then(function(e){if(e.data.code===I.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(D.a)({commonId:e}).then(function(e){e.data.code===I.a&&(m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(D.d)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getSubjectMenu(),this.props.getSubjectExtendsMenu(),this.props.getFunctionMenu(),this.props.getFunctionExtendsMenu()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a=n.selectDeviceType,r={},o=[];_.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.protocolName=n.protocolName,r.subjectId=n.subjectId,r.functionId=n.functionId,n.subjectExtendId&&(r.subjectExtendId=n.subjectExtendId),n.functionExtendId&&(r.functionExtendId=n.functionExtendId),t.state.isEdit&&(r.commonId=t.state.commonData.commonId),Object(D.c)(r).then(function(e){e.data.code===I.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.subjectMenuList||[],n=this.props.subjectExtendsMenuLsit||[],a=this.props.functionMenuList||[],r=this.props.functionExtendsMenuList||[],o={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:V,searchPlaceholder:"请选择管理设备类型",style:{width:300},showArrow:!0},i=this.state.isEdit,c=i?this.state.commonData.protocolName:void 0,u=i?this.state.commonData.subjectId:void 0,s=i?this.state.commonData.subjectExtendId:void 0,p=i?this.state.commonData.functionId:void 0,m=i?this.state.commonData.functionExtendId:void 0,y=void 0;if(i){var h=this.state.commonData.deviceTypeList,b=[];h instanceof Array&&(h.map(function(e){var t=e.deviceTypeId;b.push(t)}),b.length>0&&(y=b))}return l.a.createElement("div",null,l.a.createElement(N,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"commonId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,deviceCascaderList:this.props.deviceCascaderList,filterPannel:[{type:"Input",title:"协议数据",paramskey:"protocolName",placeholder:"请输入协议数据"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/common/importExcel",download:"/v1/web/manage-open/protocol/dictionary/common/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),l.a.createElement(f.a,{title:this.state.isEdit?"编辑常用":"新建常用",visible:this.state.visibleModal,onOk:this.handleSubmitSave.bind(this),onCancel:this.handleCancel.bind(this),destroyOnClose:!0},l.a.createElement(v.a,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},l.a.createElement(U,{label:"协议数据"},e("protocolName",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:c})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(U,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!0,message:"请关联所属分类"}],initialValue:y})(l.a.createElement(E.a,o))),l.a.createElement(U,{label:"主体"},e("subjectId",{rules:[{required:!0,message:"请输入主体"}],initialValue:u})(l.a.createElement(g.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map(function(e,t){return l.a.createElement(z,{key:t,value:e.menuId},e.menuName)})))),l.a.createElement(U,{label:"主体扩展名"},e("subjectExtendId",{rules:[{required:!1,message:"请输入主体数据"}],initialValue:s})(l.a.createElement(g.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e,t){return l.a.createElement(z,{key:t,value:e.menuId},e.menuName)})))),l.a.createElement(U,{label:"功能"},e("functionId",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:p})(l.a.createElement(g.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.map(function(e,t){return l.a.createElement(z,{key:t,value:e.menuId},e.menuName)})))),l.a.createElement(U,{label:"功能扩展名"},e("functionExtendId",{rules:[{required:!1,message:"请输入协议数据"}],initialValue:m})(l.a.createElement(g.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e,t){return l.a.createElement(z,{key:t,value:e.menuId},e.menuName)})))))))}}])&&A(n.prototype,a),r&&A(n,r),t}())||x)||x;n(335),n(336);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function H(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $,X=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=H(this,Q(t).call(this,e))).onChange=function(e,t){if(e.includes("all"))if((n.props.value||[]).length===n.props.children.length)n.triggerChange([]);else{var a=n.props.children.map(function(e){return e.props.value});n.triggerChange(a)}else n.triggerChange(e)},n.triggerChange=function(e){var t=n.props.onChange;t&&t(e)},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,l.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return l.a.createElement(g.a,W({mode:"multiple"},this.props,{onChange:this.onChange,showArrow:!0}),l.a.createElement(g.a.Option,{key:"all",style:{backgroundColor:"#eee"}},l.a.createElement("span",{style:{fontWeight:"bold"}},"全选")),this.props.children)}}])&&G(n.prototype,a),r&&G(n,r),t}();function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function te(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe,ie=v.a.Item,le=Object(p.b)(function(e){return{functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}},function(e){return{getFunctionAllList:function(){e(M.a())}}})($=v.a.create()($=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=ne(t).call(this,e),(n=!r||"object"!==Z(r)&&"function"!=typeof r?ae(a):r).columns=[{title:"ID",dataIndex:"subjectId",key:"subjectId",width:"100px"},{title:"主体（中文）",dataIndex:"subjectNameCN",key:"subjectNameCN"},{title:"主体（英文)",dataIndex:"subjectNameEN",key:"subjectNameEN"},{title:"主体标识",dataIndex:"subjectMark",key:"subjectMark"},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"30%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectId",key:"1",width:"100px",render:function(e){return l.a.createElement("div",null,l.a.createElement(h.a,{title:"编辑",placement:"top"},l.a.createElement(b.a,{onClick:n.handleEdit.bind(ae(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",l.a.createElement(y.a,{title:"确认要删除吗",onConfirm:n.handleDelete.bind(ae(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},l.a.createElement(h.a,{title:"删除",placement:"top"},l.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.onChange=function(e){var t=n.props.functionAllList;n.setState({checkedList:e,indeterminate:!!e.length&&e.length<t.length,checkAll:e.length===t.length})},n.onCheckAllChange=function(e){var t=n.props.functionAllList;n.setState({checkedList:e.target.checked?t:[],indeterminate:!1,checkAll:e.target.checked})},n.state={commonData:{},visibleModal:!1,isEdit:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,l.a.Component),n=t,(a=[{key:"handleEdit",value:function(e){var t=this;Object(D.t)({subjectId:e}).then(function(e){if(e.data.code===I.a){var n=e.data.data,a=n.functionList,r=[];a.map(function(e){var t=e.functionId;r.push(t)}),n.functionList=r,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(D.s)({subjectId:e}).then(function(n){n.data.code===I.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"getTableRequest",value:function(e){return Object(D.v)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a={};if(a.subjectNameCN=n.subjectNameCN,a.subjectNameEN=n.subjectNameEN,a.subjectMark=n.subjectMark,t.state.isEdit&&(a.subjectId=t.state.commonData.subjectId),n.functionList){var r=n.functionList,o=[];r.map(function(e){var t={functionId:e};o.push(t)}),a.functionList=o}Object(D.u)(a).then(function(e){e.data.code===I.a&&(m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"render",value:function(){var e=this.props.functionAllList||[],t=this.state.isEdit,n=t?this.state.commonData.subjectNameCN:void 0,a=t?this.state.commonData.subjectNameEN:void 0,r=t?this.state.commonData.subjectMark:void 0,o=t?this.state.commonData.functionList:void 0,i=this.props.form.getFieldDecorator;return l.a.createElement("div",null,l.a.createElement(N,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体",paramskey:"subjectNameCN",placeholder:"请输入主体名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/subject/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subject/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),l.a.createElement(f.a,{title:this.state.isEdit?"编辑主体":"新建主体",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},l.a.createElement(v.a,ee({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),l.a.createElement(ie,{label:"主体-中文"},i("subjectNameCN",{rules:[{required:!0,message:"请输入主体中文"}],initialValue:n})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(ie,{label:"主体-英文"},i("subjectNameEN",{rules:[{required:!0,message:"请输入主体英文"}],initialValue:a})(l.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),l.a.createElement(ie,{label:"主体识符"},i("subjectMark",{rules:[{required:!0,message:"请输入主体识符"}],initialValue:r})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(ie,{label:"关联功能"},i("functionList",{rules:[{required:!1,message:"请输入关联功能"}],initialValue:o})(l.a.createElement(X,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},e.map(function(e,t){return l.a.createElement(g.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)})))),l.a.createElement(ie,{labelCol:{span:24},wrapperCol:{span:24}},l.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},l.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),l.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&te(n.prototype,a),r&&te(n,r),t}())||$)||$;function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function se(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var me=v.a.Item,ye=E.a.SHOW_PARENT,he=Object(p.b)(function(e){return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}})(oe=v.a.create()(oe=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=pe(t).call(this,e),(n=!r||"object"!==ce(r)&&"function"!=typeof r?fe(a):r).columns=[{title:"ID",dataIndex:"subjectExtendId",key:"subjectExtendId",width:"80px"},{title:"主体扩展名（中文）",dataIndex:"subjectExtendNameCN",key:"subjectExtendNameCN"},{title:"主体扩展名（英文）",dataIndex:"subjectExtendNameEN",key:"subjectExtendNameEN"},{title:"主体扩展名标识",dataIndex:"subjectExtendMark",key:"subjectExtendMark"},{title:"匹配所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"30%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectExtendId",key:"1",width:"100px",render:function(e){return l.a.createElement("div",null,l.a.createElement(h.a,{title:"编辑",placement:"top"},l.a.createElement(b.a,{onClick:n.handleEdit.bind(fe(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",l.a.createElement(y.a,{title:"确认要删除吗",onConfirm:n.handleDelete.bind(fe(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},l.a.createElement(h.a,{title:"删除",placement:"top"},l.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.state={visibleModal:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,l.a.Component),n=t,(a=[{key:"handleEdit",value:function(e){var t=this;Object(D.q)({subjectExtendId:e}).then(function(e){if(e.data.code===I.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;Object(D.p)({subjectExtendId:e}).then(function(n){n.data.code===I.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(D.w)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){var a=n.selectDeviceType,r={},o=[];_.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.subjectExtendNameCN=n.subjectExtendNameCN,r.subjectExtendNameEN=n.subjectExtendNameEN,r.subjectExtendMark=n.subjectExtendMark,t.state.isEdit&&(r.subjectExtendId=t.state.commonData.subjectExtendId),Object(D.r)(r).then(function(e){e.data.code===I.a&&(m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"render",value:function(){var e={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:ye,searchPlaceholder:"请选择管理设备类型",style:{width:300}},t=this.state.isEdit,n=t?this.state.commonData.subjectExtendNameCN:void 0,a=t?this.state.commonData.subjectExtendNameEN:void 0,r=t?this.state.commonData.subjectExtendMark:void 0,o=void 0;if(t){var i=this.state.commonData.deviceTypeList,c=[];i instanceof Array&&(i.map(function(e){var t=e.deviceTypeId;c.push(t)}),c.length>0&&(o=c))}var u=this.props.form.getFieldDecorator;return l.a.createElement("div",null,l.a.createElement(N,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体扩展名（中文）",paramskey:"subjectExtendNameCN",placeholder:"请输入主体扩展名（中文）"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/subjectExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subjectExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),l.a.createElement(f.a,{title:this.state.isEdit?"编辑主体扩展":"新建主体扩展",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},l.a.createElement(v.a,ue({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),l.a.createElement(me,{label:"主体扩展名-中文"},u("subjectExtendNameCN",{rules:[{required:!0,message:"请输入主体扩展名中文"}],initialValue:n})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(me,{label:"主体扩展名-英文"},u("subjectExtendNameEN",{rules:[{required:!0,message:"请输入主体扩展名英文"}],initialValue:a})(l.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),l.a.createElement(me,{label:"主体扩展名识符"},u("subjectExtendMark",{rules:[{required:!0,message:"请主体扩展名识符"}],initialValue:r})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(me,{label:"关联所属分类"},u("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:o})(l.a.createElement(E.a,e))),l.a.createElement(me,{labelCol:{span:24},wrapperCol:{span:24}},l.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},l.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),l.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&se(n.prototype,a),r&&se(n,r),t}())||oe)||oe,be=(n(29),n(40),n(41),n(37),n(30),n(451),n(770),n(208)),ge=(n(771),n(133));n(117);function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oe(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Se=v.a.Item,Ce=g.a.Option,je=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Oe(this,we(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,l.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.defaultField,a=e.defaultLen,r=e.defaultUnit,o=e.form,i=e.name,c=o.getFieldDecorator;return l.a.createElement(be.a,{type:"flex",justify:"space-around"},l.a.createElement(ge.a,null,l.a.createElement(Se,null,c("id_"+i,{rules:[{required:!1}]})(l.a.createElement(d.a,{style:{display:"none"},size:"small"})))),l.a.createElement(ge.a,{span:11},l.a.createElement(Se,null,c("field_"+i,{initialValue:n||"",rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{placeholder:t,size:"small"})))),l.a.createElement(ge.a,{span:5},c("len_"+i,{initialValue:a||1,rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{size:"small"}))),l.a.createElement(ge.a,{span:6},c("unit_"+i,{initialValue:r||1,rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(g.a,{size:"small"},l.a.createElement(Ce,{value:1},"字节"),l.a.createElement(Ce,{value:2},"位")))))}}])&&Ee(n.prototype,a),r&&Ee(n,r),t}();function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Le(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ne=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Le(this,(e=xe(t)).call.apply(e,[this].concat(r)))).getFieldsItem=function(){var e=n.props,t=e.protocolType,a=e.form;return t?t.content.map(function(e,n){return l.a.createElement(je,{key:t.id+"_"+n,form:a,placeholder:e.placeholder,defaultLen:e.defaultLen,defaultUnit:e.defaultUnit,name:n})}):null},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,l.a.Component),n=t,(a=[{key:"render",value:function(){return l.a.createElement("div",{className:"value-type"},l.a.createElement(be.a,null,l.a.createElement(ge.a,{span:11},l.a.createElement("span",null,"数据标识")),l.a.createElement(ge.a,{span:6},l.a.createElement("span",null,"长度")),l.a.createElement(ge.a,{span:7},l.a.createElement("span",null,"单位"))),this.getFieldsItem())}}])&&Pe(n.prototype,a),r&&Pe(n,r),t}();n(333);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Me(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fe=v.a.Item,qe=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Me(this,(e=Re(t)).call.apply(e,[this].concat(r)))).state={functionDetailList:n.props.functionDetailList||[{functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}]},n.handleAdd=function(){var e=n.state.functionDetailList,t=Array.from(e);t.push({functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}),n.setState({functionDetailList:t})},n.handleDel=function(e){var t=n.props.form,a=t.getFieldsValue(),r=[],o={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(a).map(function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");r[t[1]]||(r[t[1]]={}),r[t[1]][o[t[0]]]=a[e]}}),r=r.filter(function(t,n){return n!=e});var i={};r.map(function(e,t){i["id_"+t]=e.functionDetailId,i["field_"+t]=e.functionMark,i["len_"+t]=e.functionLength,i["unit_"+t]=e.functionUnit}),t.setFieldsValue(i),n.setState({functionDetailList:r})},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,l.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){this.props.flag!=e.flag&&this.setState({functionDetailList:e.functionDetailList||[{functionDetailId:null,functionMark:null}]})}},{key:"render",value:function(){var e=this,t=this.props.form,n=this.state.functionDetailList,a=t.getFieldDecorator;return l.a.createElement("div",{className:"value-type"},l.a.createElement(be.a,null,l.a.createElement(ge.a,{span:4},l.a.createElement("span",null," ")),l.a.createElement(ge.a,{span:15},l.a.createElement("span",null,"数据标识")),l.a.createElement(ge.a,{span:4},l.a.createElement("span",null," "))),n&&n.map(function(t,n){return l.a.createElement(be.a,{type:"flex",justify:"space-around",key:n+t.functionMark},l.a.createElement(ge.a,{span:4},l.a.createElement(Fe,null,l.a.createElement("p",null,"BIT".concat(n)))),l.a.createElement(ge.a,{span:0},l.a.createElement(Fe,null,a("id_"+n,{initialValue:t.functionDetailId||null,rules:[{required:!1}]})(l.a.createElement(d.a,{style:{display:"none"},size:"small"})))),l.a.createElement(ge.a,{span:15},l.a.createElement(Fe,null,a("field_"+n,{initialValue:t.functionMark,rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{size:"small"})))),l.a.createElement(ge.a,{span:0},a("len_"+n,{initialValue:t.functionLength||1,rules:[{required:!1,message:"字段不能为空"}]})(l.a.createElement(d.a,{style:{opacity:0},size:"small"}))),l.a.createElement(ge.a,{span:0},a("unit_"+n,{initialValue:t.Unit||2,rules:[{required:!1,message:"字段不能为空"}]})(l.a.createElement(d.a,{style:{opacity:0},size:"small"}))),l.a.createElement(ge.a,{span:4,style:{textAlign:"center"}},n>0?l.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):l.a.createElement("p",null," ")))}),l.a.createElement(be.a,null,l.a.createElement(ge.a,{span:4},l.a.createElement("a",{onClick:this.handleAdd},"添加"))))}}])&&_e(n.prototype,a),r&&_e(n,r),t}();function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(){return(Ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ue(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ze(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We,Ge=v.a.Item,He=g.a.Option,Qe=[{id:1,name:"字符",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:2,name:"数值",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:3,name:"枚举",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:4,name:"布尔",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:5,name:"绝对时间",content:[{placeholder:"时间戳数据位",defaultLen:13,defaultUnit:1}]},{id:6,name:"相对时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:7,name:"循环时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"周"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:8,name:"RGB颜色",content:[{placeholder:'"红色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"黄色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"蓝色"数据位',defaultLen:1,defaultUnit:1}]},{id:9,name:"二进制",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:10,name:"数组",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]},{id:11,name:"结构体",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]}],Ye=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ze(this,Ke(t).call(this,e))).handleChange=function(e){n.setState({protocolType:Qe[e-1]},function(){if(e<10){for(var t=Qe[e-1].content.length,n=[],a=0;a<t;a++)n.push("id_"+a),n.push("field_"+a),n.push("len_"+a),n.push("unit_"+a);this.props.form.resetFields(n)}})},n.handleAdd=function(){var e=n.state.childfunclist,t=JSON.parse(JSON.stringify(e));t.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),n.setState({childfunclist:t})},n.handleAdd=function(){var e=n.state.childfunclist,t=JSON.parse(JSON.stringify(e));t.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),n.setState({childfunclist:t})},n.handleDel=function(e){var t=n.state.childfunclist,a=JSON.parse(JSON.stringify(t));a.splice(e,1),n.setState({childfunclist:a})},n.state={functionDetailList:null,childfunclist:[{functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}],protocolType:Qe[n.props.functionDataType-1]||Qe[0]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,l.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.functionDataType,a=t.visibleModal,r=t.functionDetailList;if(console.log("....Props..functionDetailList---",r,e.functionDetailList),(n!=e.functionDataType||a!=e.visibleModal)&&(this.setState({protocolType:Qe[e.functionDataType-1],functionDetailList:e.functionDetailList}),11==e.functionDataType)){var o=e.functionDetailList&&e.functionDetailList[0]&&e.functionDetailList[0].subFunctionDetailList||[];0==o.length&&o.push({functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}),console.log(111,e.functionDetailList),this.setState({childfunclist:o})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.protocolType,a=t.functionDetailList,r=t.childfunclist;console.log("...childfunclist...",r);var o=this.props.form.getFieldDecorator,i={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},c={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:16}}},u=l.a.createElement("div",null);return u=9==n.id?l.a.createElement(qe,{functionDetailList:a,form:this.props.form}):10==n.id?l.a.createElement("div",null,l.a.createElement(Ge,Ve({label:"数据标识"},c),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(l.a.createElement(d.a,{placeholder:"50个以内的字符",maxLength:50}))),l.a.createElement(Ge,Ve({label:"元素类型"},c),o("functionDataTypeChild",{rules:[{required:!0,message:"元素类型不能为空"}],initialValue:1})(l.a.createElement(g.a,{placeholder:"选择元素类型"},l.a.createElement(He,{value:1},"字符型"),l.a.createElement(He,{value:2},"数值型")))),l.a.createElement(Ge,Ve({label:"元素字节长度"},c),o("functionLength",{rules:[{required:!0,message:"元素字节长度"}]})(l.a.createElement(d.a,{placeholder:"最大不超过1000",maxLength:4})))):11==n.id?l.a.createElement("div",null,l.a.createElement(Ge,Ve({label:"数据标识"},i,{style:{marginBottom:"0"}}),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(l.a.createElement(d.a,{placeholder:"50个以内的字符",maxLength:50}))),l.a.createElement(Ge,Ve({label:"JSON对象"},i,{style:{marginBottom:"0"}}),o("JSONobj",{rules:[{required:!0,message:""}],initialValue:123})(l.a.createElement(d.a,{type:"hidden"}))),l.a.createElement(be.a,null,l.a.createElement(ge.a,{span:6},l.a.createElement("span",null,"参数名称")),l.a.createElement(ge.a,{span:6},l.a.createElement("span",null,"数据标识")),l.a.createElement(ge.a,{span:5},l.a.createElement("span",null,"数据类型")),l.a.createElement(ge.a,{span:4},l.a.createElement("span",null,"字节长度")),l.a.createElement(ge.a,{span:3,style:{textAlign:"right"}},l.a.createElement("span",null,"操作"))),r.map(function(t,n){return l.a.createElement(be.a,{gutter:4,key:"childfunc_"+n},l.a.createElement(ge.a,{span:6},l.a.createElement(Ge,{style:{marginBottom:"0"}},o("functionDetailName_"+n,{initialValue:t.functionDetailName||"",rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{placeholder:"参数名称",maxLength:50,size:"small"})))),l.a.createElement(ge.a,{span:6},l.a.createElement(Ge,{style:{marginBottom:"0"}},o("functionMark_"+n,{initialValue:t.functionMark||"",rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{placeholder:"数据标识",maxLength:50,size:"small"})))),l.a.createElement(ge.a,{span:5},l.a.createElement(Ge,{style:{marginBottom:"0"}},o("functionDataType_"+n,{initialValue:t.functionDataType||1,rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(g.a,{placeholder:"选择数据类型",size:"small"},l.a.createElement(He,{value:1},"字符型"),l.a.createElement(He,{value:2},"数值型"),l.a.createElement(He,{value:3},"枚举型"),l.a.createElement(He,{value:4},"布尔型"))))),l.a.createElement(ge.a,{span:4},l.a.createElement(Ge,{style:{marginBottom:"0"}},o("functionLength_"+n,{initialValue:t.functionLength||"",rules:[{required:!0,message:"字段不能为空"}]})(l.a.createElement(d.a,{placeholder:"字节长度",maxLength:4,size:"small"})))),l.a.createElement(ge.a,{span:3,style:{textAlign:"right"}},n>0?l.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):l.a.createElement("p",null," ")))}),l.a.createElement(be.a,null,l.a.createElement(ge.a,{span:24,style:{textAlign:"right"}},l.a.createElement("a",{onClick:this.handleAdd},"添加")))):l.a.createElement(Ne,{protocolType:n,form:this.props.form}),l.a.createElement(Ge,Ve({},i,{label:"协议类型"}),o("functionDataType",{initialValue:1,rules:[{required:!0,message:"请选择协议类型"}]})(l.a.createElement(g.a,{placeholder:"选择协议类型",onChange:this.handleChange},Qe.map(function(e){return l.a.createElement(He,{value:e.id,key:e.id},e.name)}))),u)}}])&&Ue(n.prototype,a),r&&Ue(n,r),t}();function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(){return(Xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ot,it=[{functionType:20,functionTypeName:"历史控制数据"},{functionType:8,functionTypeName:"历史运行数据"},{functionType:27,functionTypeName:"状态数据"},{functionType:9,functionTypeName:"红外数据"},{functionType:2,functionTypeName:"控制数据"},{functionType:3,functionTypeName:"运行数据"},{functionType:4,functionTypeName:"故障数据"},{functionType:5,functionTypeName:"配置数据"}],lt=v.a.Item,ct=(E.a.SHOW_PARENT,v.a.create()(We=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=nt(t).call(this,e),(n=!r||"object"!==$e(r)&&"function"!=typeof r?at(a):r).columns=[{title:"ID",dataIndex:"functionId",width:"100px"},{title:"功能名（中文）",dataIndex:"functionNameCN"},{title:"功能名（英文）",dataIndex:"functionNameEN"},{title:"类型",dataIndex:"dataTypeNameList",width:"30%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionId",key:"0",width:"100px",render:function(e){return l.a.createElement("div",null,l.a.createElement(h.a,{title:"编辑",placement:"top"},l.a.createElement(b.a,{onClick:n.handleEdit.bind(at(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",l.a.createElement(y.a,{title:"确认要删除吗",onConfirm:n.handleDelete.bind(at(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},l.a.createElement(h.a,{title:"删除",placement:"top"},l.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.state={functionDataType:1,functionDetailList:null,commonData:{}},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,l.a.Component),n=t,(a=[{key:"handleEdit",value:function(e){var t=this,n=this;Object(D.l)({functionId:e}).then(function(e){if(console.log("get detail---",e.data.data),e.data.code===I.a){var a=e.data.data;t.setState({functionDataType:a.functionDataType,functionDetailList:a.functionDetailList,commonData:a,visibleModal:!0,isEdit:!0},function(){var e=a.functionDetailList,t={},r=a.functionDataType;r<10?e.map(function(e,n){t["id_"+n]=e.functionDetailId,t["field_"+n]=e.functionMark,t["len_"+n]=e.functionLength,t["unit_"+n]=e.functionUnit}):10==r?(t.functionMark=e[0].functionMark,t.functionDataTypeChild=e[0].functionDataType,t.functionLength=e[0].functionLength):11==r&&(t.functionMark=e[0].functionMark,(e[0].subFunctionDetailList||[]).map(function(e,n){t["functionMark_"+n]=e.functionMark,t["functionDetailName_"+n]=e.functionDetailName,t["functionDataType_"+n]=e.functionDataType,t["functionLength_"+n]=e.functionLength})),setTimeout(function(){n.props.form.setFieldsValue(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(n,!0).forEach(function(t){et(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({functionNameCN:a.functionNameCN,functionNameEN:a.functionNameEN,dataTypeList:Array.isArray(a.dataTypeList)?a.dataTypeList:[a.dataTypeList],functionDataType:r},t))},100)})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(D.k)({functionId:e}).then(function(n){n.data.code===I.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(D.n)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1,functionDataType:1},function(){this.props.form.resetFields()})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("....values...",n);var a=n.functionDataType,r={};r.functionNameCN=n.functionNameCN,r.functionNameEN=n.functionNameEN,r.dataTypeList=n.dataTypeList,r.functionDataType=a,t.state.isEdit&&(r.functionId=t.state.commonData.functionId);var o=[];if(10==a)o[0]={functionMark:n.functionMark,functionDataType:n.functionDataTypeChild,functionLength:n.functionLength};else if(11==a){o[0]={functionMark:n.functionMark,functionDataType:a,subFunctionDetailList:[]};var i=[];Object.keys(n).map(function(e){var t=e.split("_");if(t.length>1){var a=t[1],r=t[0],o=n[e];console.log("---",a,r,o,"---"),i[a]||(i[a]={}),i[a][r]=o}}),o[0].subFunctionDetailList=i}else if(a<10){var l={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(n).map(function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");o[t[1]]||(o[t[1]]={}),o[t[1]][l[t[0]]]=n[e]}})}r.functionDetailList=o,Object(D.m)(r).then(function(e){e.data.code===I.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{},functionDetailList:null})}})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{},functionDetailList:null})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.commonData.functionNameCN||"",n=this.state.commonData.functionNameEN||"",a=this.state.commonData.dataTypeList||[],r=this.state,o=r.functionDataType,i=r.functionDetailList;return l.a.createElement("div",null,l.a.createElement(N,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能名（中文）",paramskey:"functionNameCN",placeholder:"请输入功能名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/function/importExcel",download:"/v1/web/manage-open/protocol/dictionary/function/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),l.a.createElement(f.a,{title:this.state.isEdit?"编辑功能":"新建功能",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),width:700},l.a.createElement(v.a,Xe({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},{onSubmit:this.handleSubmitSave.bind(this)}),l.a.createElement(lt,{label:"功能-中文"},e("functionNameCN",{rules:[{required:!0,message:"请输入功能中文"}],initialValue:t})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(lt,{label:"功能-英文"},e("functionNameEN",{rules:[{required:!0,message:"请输入功能英文"}],initialValue:n})(l.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),l.a.createElement(lt,{label:"功能分类"},e("dataTypeList",{rules:[{required:!0,message:"请输入功能分类"}],initialValue:a})(l.a.createElement(X,{showArrow:!0,showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},it.map(function(e){return l.a.createElement(g.a.Option,{value:e.functionType,key:e.functionType},e.functionTypeName)})))),l.a.createElement(Ye,{visibleModal:this.state.visibleModal,functionDataType:o,functionDetailList:i,form:this.props.form}),l.a.createElement(lt,{labelCol:{span:24},wrapperCol:{span:24}},l.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},l.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),l.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&tt(n.prototype,a),r&&tt(n,r),t}())||We);function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function pt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yt=E.a.SHOW_PARENT,ht=v.a.Item,bt=(g.a.Option,Object(p.b)(function(e){return{deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}},function(e){return{getFunctionAllList:function(){e(M.a())}}})(ot=v.a.create()(ot=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=ft(t).call(this,e),(n=!r||"object"!==ut(r)&&"function"!=typeof r?dt(a):r).columns=[{title:"ID",dataIndex:"functionExtendId",key:"functionExtendId",width:"80px"},{title:"功能扩展名（中文）",dataIndex:"functionExtendNameCN",key:"functionExtendNameCN",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"功能扩展名（英文）",dataIndex:"functionExtendNameEN",key:"functionExtendNameEN",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"功能扩展名标识",dataIndex:"functionExtendMark",key:"functionExtendMark",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"20%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"20%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionExtendId",key:"1",width:"100px",render:function(e){return l.a.createElement("div",null,l.a.createElement(h.a,{title:"编辑",placement:"top"},l.a.createElement(b.a,{onClick:n.handleEdit.bind(dt(n),e),shape:"circle",icon:"edit",size:"small"})),"  ",l.a.createElement(y.a,{title:"确认要删除吗",onConfirm:n.handleDelete.bind(dt(n),e),okText:"确认",cancelText:"取消",placement:"topRight"},l.a.createElement(h.a,{title:"删除",placement:"top"},l.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],n.state={},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,l.a.Component),n=t,(a=[{key:"handleEdit",value:function(e){var t=this;console.log("get detail"),Object(D.f)({functionExtendId:e}).then(function(e){if(console.log("get detail"),e.data.code===I.a){var n=e.data.data,a=n.functionList,r=[];a.map(function(e){var t=e.functionId;r.push(t)}),n.functionList=r,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(D.e)({functionExtendId:e}).then(function(n){n.data.code===I.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return this.setState({isLoading:!0}),Object(D.h)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a=n.selectDeviceType,r={},o=[];if(_.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.functionExtendNameCN=n.functionExtendNameCN,r.functionExtendNameEN=n.functionExtendNameEN,r.functionExtendMark=n.functionExtendMark,t.state.isEdit&&(r.functionExtendId=t.state.commonData.functionExtendId),n.functionList){var i=n.functionList,l=[];i.map(function(e){var t={functionId:e};l.push(t)}),r.functionList=l}Object(D.g)(r).then(function(e){e.data.code===I.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:yt,searchPlaceholder:"请选择管理设备类型",style:{width:300}},n=this.props.functionAllList||[],a=this.state.isEdit,r=a?this.state.commonData.functionExtendNameCN:void 0,o=a?this.state.commonData.functionExtendNameEN:void 0,i=a?this.state.commonData.functionExtendMark:void 0,c=a?this.state.commonData.functionList:void 0,u=void 0;if(a){var s=this.state.commonData.deviceTypeList,p=[];s instanceof Array&&(s.map(function(e){var t=e.deviceTypeId;p.push(t)}),p.length>0&&(u=p))}return l.a.createElement("div",null,l.a.createElement(N,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能扩展名（中文）",paramskey:"functionExtendNameCN",placeholder:"请输入功能扩展名"}],upload:"/v1/web/manage-open/protocol/dictionary/functionExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/functionExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),l.a.createElement(f.a,{title:this.state.isEdit?"编辑功能扩展名":"新建功能扩展名",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},l.a.createElement(v.a,st({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),l.a.createElement(ht,{label:"功能扩展名-中文"},e("functionExtendNameCN",{rules:[{required:!0,message:"请输入功能扩展名中文"}],initialValue:r})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(ht,{label:"功能扩展名-英文"},e("functionExtendNameEN",{rules:[{required:!0,message:"请输入功能扩展名英文"}],initialValue:o})(l.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),l.a.createElement(ht,{label:"功能扩展名标识符"},e("functionExtendMark",{rules:[{required:!0,message:"请输入功能扩展名标识符"}],initialValue:i})(l.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),l.a.createElement(ht,{label:"关联功能"},e("functionList",{rules:[{required:!0,message:"请输入关联功能"}],initialValue:c})(l.a.createElement(X,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e,t){return l.a.createElement(g.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)})))),l.a.createElement(ht,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:u})(l.a.createElement(E.a,t))),l.a.createElement(ht,{labelCol:{span:24},wrapperCol:{span:24}},l.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},l.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),l.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&pt(n.prototype,a),r&&pt(n,r),t}())||ot)||ot);function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Et(e,t){return!t||"object"!==gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var It=o.a.Item,St=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Et(this,Ot(t).call(this,e))).state={menuIndex:"common"},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,l.a.Component),n=t,(a=[{key:"menuClick",value:function(e){this.setState({menuIndex:e.key})}},{key:"componentDidMount",value:function(){var e=window.location.hash.replace(/#|\?.*$/g,"").split("/").pop();this.setState({menuIndex:e}),this.props.getFunctionAllList()}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(r.a,{style:{marginBottom:"10px"}},l.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"协议字典"),l.a.createElement(o.a,{onClick:this.menuClick.bind(this),selectedKeys:[this.state.menuIndex],mode:"horizontal"},l.a.createElement(It,{key:"common"},l.a.createElement(u.b,{to:"/config/protocoldic/common"},"常用")),l.a.createElement(It,{key:"main"},l.a.createElement(u.b,{to:"/config/protocoldic/main"},"主体")),l.a.createElement(It,{key:"mainextends"},l.a.createElement(u.b,{to:"/config/protocoldic/mainextends"},"主体扩展名")),l.a.createElement(It,{key:"function"},l.a.createElement(u.b,{to:"/config/protocoldic/function"},"功能")),l.a.createElement(It,{key:"functionextends"},l.a.createElement(u.b,{to:"/config/protocoldic/functionextends"},"功能扩展名")))),l.a.createElement(r.a,null,l.a.createElement(s.d,null,l.a.createElement(c.a,{path:"/config/protocoldic/common",component:K}),l.a.createElement(c.a,{path:"/config/protocoldic/main",component:le}),l.a.createElement(c.a,{path:"/config/protocoldic/mainextends",component:he}),l.a.createElement(c.a,{path:"/config/protocoldic/function",component:ct}),l.a.createElement(c.a,{path:"/config/protocoldic/functionextends",component:bt}),l.a.createElement(s.a,{to:"/config/protocoldic/common",from:"/config/protocoldic"}))))}}])&&vt(n.prototype,a),i&&vt(n,i),t}();t.default=Object(p.b)(null,function(e){return{getFunctionAllList:function(){e(M.a())}}})(St)},1403:function(e,t,n){"use strict";n.r(t);n(242);var a=n(0),r=n.n(a),o=n(104),i=(n(20),n(35),n(36),n(117),n(29),n(28),n(435),n(40),n(41),n(45),n(37),n(46),n(22),n(31),n(30),n(32),n(92),n(33)),l=(n(138),n(79)),c=(n(206),n(80)),u=(n(71),n(21)),s=(n(241),n(118)),p=n(39),f=n(96),d=n(1339),m=n(438);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=d.a.Option,S=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=E(this,(e=O(t)).call.apply(e,[this].concat(r)))).state={projectName:"",robotId:"",queryStatus:null,loading:!1},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(g({},a,r))},n.handleSearch=function(){var e=n.state,t=e.projectName,a=e.robotId;n.setState({queryStatus:{projectName:t,robotId:a}},function(){n.pageChange()})},n.handleReset=function(){n.setState({projectName:"",robotId:"",queryStatus:null},function(){n.refInpt1.setState({value:""}),n.refInpt2.setState({value:""})})},n.handleNew=function(){n.props.history.push("./0")},n.handleEdit=function(e){n.props.history.push("./".concat(e))},n.handleDel=function(e){s.a.confirm({title:"确定删除项目",centered:!0,onOk:function(){n.props.delProject(e)}})},n.pageChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=b({},n.state.queryStatus,{pageIndex:e});console.log(t),n.setState({loading:!0},function(){n.props.getList(t).then(function(e){n.setState({loading:!1})})})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){console.log(this.props),this.pageChange()}},{key:"render",value:function(){var e=this,t=this.state.loading,n=this.props,a=n.pager,o=n.list,s=[{title:"项目ID",dataIndex:"projectId",width:"10%"},{title:"名称",dataIndex:"projectName",width:"20%"},{title:"机器人ID",dataIndex:"robotId",width:"150px"},{title:"关联产品",dataIndex:"productNameList",width:"30%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(c.a,{placement:"top",title:"管理"},r.a.createElement(u.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.handleEdit.bind(e,t.projectId)})),"  |  ",r.a.createElement(c.a,{placement:"top",title:"删除"},r.a.createElement(u.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.projectId)})))}}];return r.a.createElement("div",{className:"projectmanage"},r.a.createElement(d.a,{title:"项目管理"},r.a.createElement(I,null,r.a.createElement(l.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入项目名称查询",name:"projectName",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt1=t}})),r.a.createElement(I,null,r.a.createElement(l.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入机器人ID查询",name:"robotId",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt2=t}})),r.a.createElement(I,null,r.a.createElement(u.a,{type:"primary",onClick:this.handleSearch},"查询")),r.a.createElement(I,null,r.a.createElement(u.a,{type:"primary",onClick:this.handleReset},"重置")),r.a.createElement(I,{align:"right"},r.a.createElement(u.a,{type:"primary",onClick:this.handleNew},"新建"))),r.a.createElement(i.a,null,r.a.createElement(f.a,{rowKey:"projectId",pagination:!1,columns:s,dataSource:o,pager:a,onPageChange:this.pageChange,loading:t})))}}])&&v(n.prototype,a),o&&v(n,o),t}(),C=Object(p.b)(function(e){return{list:e.getIn(["projectManage","list"]).toJS(),pager:e.getIn(["projectManage","pager"]).toJS()}},function(e){return{getList:function(t){return e(m.a.getList(t))},delProject:function(t){return e(m.a.delProject(t))}}})(S),j=(n(166),n(139),n(44)),k=n(73),P=n(12),L=(n(281),n(449),n(207),n(337),n(187));function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=N(this,(e=D(t)).call.apply(e,[this].concat(r)))).state={macAddress:"",loading:!1},n.handleOk=function(){var e=n.props.deviceList;e&&0!==e.length?(n.props.addDevice(e),n.props.onCancel()):n.props.onCancel()},n.handleChange=function(e){n.setState({macAddress:e.target.value})},n.handleQuery=function(){n.setState({loading:!0},function(){var e=n.props.projectId;n.props.getDevice({macAddress:n.state.macAddress,projectId:e}).then(function(e){n.setState({loading:!1})})})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&(this.setState({macAddress:""}),this.props.clearDevice())}},{key:"render",value:function(){var e=this.state,t=e.macAddress,n=e.loading,a=this.props,o=a.deviceList,i=a.visible,c=a.onCancel;return r.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:1200,visible:i,onCancel:c,footer:r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:c},"取消"))},r.a.createElement("h2",null,"添加产品设备"),r.a.createElement("div",{className:"header"},r.a.createElement(l.a,{placeholder:"请输入MAC地址查询",maxLength:20,onChange:this.handleChange,value:t,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),r.a.createElement("div",{className:"projectmanage-modal-table product"},r.a.createElement(L.a,{bordered:!0,loading:n,rowKey:"productId",pagination:!1,columns:[{title:"MAC",dataIndex:"macAddress",width:"15%"},{title:"IMEI",dataIndex:"imei",width:"15%"},{title:"产品ID",dataIndex:"productId",width:"10%"},{title:"产品型号",dataIndex:"productCode",width:"20%"},{title:"产品名称",dataIndex:"productName",width:"20%"},{title:"所属分类",dataIndex:"allCategoryName",width:"20%"}],dataSource:o})))}}])&&T(n.prototype,a),o&&T(n,o),t}(),R=Object(p.b)(function(e){return{deviceList:e.getIn(["projectManage","deviceList"]).toJS()}},function(e){return{getDevice:function(t){return e(m.a.getDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))},clearDevice:function(){return e(m.a.setDevice([]))}}})(M);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=q(this,(e=B(t)).call.apply(e,[this].concat(r)))).state={visible:!1,macAddress:"",productId:"",query:{macAddress:"",productId:""}},n.fileInput=null,n.fileChange=function(e){n.props.uploadDevice(e.target.files[0]).then(function(e){e&&j.a.success({message:"导入成功",duration:3})}),n.fileInput.value=""},n.handleAdd=function(){n.setState({visible:!0})},n.handleCancel=function(){n.setState({visible:!1})},n.handleDel=function(e){n.props.delDevice(e)},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r))},n.handleQuery=function(){var e=n.state,t=e.macAddress,a=e.productId;n.setState({query:{macAddress:t,productId:a}})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.projectId,n=this.state,a=n.visible,o=n.query,i=this.props,c=i.projectDeviceProductList,s=i.positionList,p=[{title:"MAC",dataIndex:"macAddress",width:"150px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"IMEI",dataIndex:"imei",width:"10%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"产品ID",dataIndex:"productId",width:"100px"},{title:"产品型号",dataIndex:"productCode",width:"15%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"产品名称",dataIndex:"productName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"100px",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement("span",{onClick:e.handleDel.bind(e,t)},"删除"))}}],f=o.macAddress,d=o.productId,m=c&&c.length>0?c.filter(function(e){return e.macAddress.toLowerCase().indexOf(f.toLowerCase())>=0}).filter(function(e){return new RegExp("^".concat(d.toLowerCase())).test((e.productId+"").toLowerCase())}):[];return r.a.createElement("div",{className:"edit-detail production"},r.a.createElement("div",{className:"tab-query"},r.a.createElement(l.a,{placeholder:"MAC地址",maxLength:20,className:"left",name:"macAddress",onChange:this.handleChange,onPressEnter:this.handleQuery}),r.a.createElement(l.a,{placeholder:"产品ID",maxLength:20,className:"left",name:"productId",onChange:this.handleChange,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",className:"left",onClick:this.handleQuery},"查询"),r.a.createElement(u.a,{type:"primary",className:"right",onClick:this.handleAdd},"添加产品"),r.a.createElement("div",{className:"btn-upload"},r.a.createElement(u.a,{type:"primary"},"批量导入",r.a.createElement("input",{type:"file",className:"upload",accept:".xls, .xlsx",onChange:this.fileChange,ref:function(t){return e.fileInput=t}}))),r.a.createElement("a",{className:"right",href:"/v1/web/manage-open/project/management/deviceProduct/download"},"下载模板")),r.a.createElement(L.a,{rowKey:"macAddress",bordered:!0,pagination:!1,columns:p,dataSource:m,scroll:{x:"max-content",y:500}}),r.a.createElement(R,{visible:a,onOk:this.handleOk,onCancel:this.handleCancel,projectDeviceProductList:c,projectId:t,positionList:s}))}}])&&F(n.prototype,a),o&&F(n,o),t}(),z=Object(p.b)(function(e){return{projectDeviceProductList:e.getIn(["projectManage","project","projectDeviceProductList"]).toJS()}},function(e){return{getProductList:function(t){return e(m.a.getProductList(t))},uploadDevice:function(t){return e(m.a.uploadDevice(t))},delDevice:function(t){return e(m.a.delDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))}}})(U);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=W(this,(e=G(t)).call.apply(e,[this].concat(r)))).state={active:null,modelName:"",query:""},n.handleOk=function(){var e=n.state.active;null!=K(e)?(n.props.setPosition(e),n.props.getSummaryList(e.modelId),n.props.onCancel()):n.props.onCancel()},n.handleClick=function(e){n.setState({active:e})},n.handleChange=function(e){n.setState({modelName:e.target.value})},n.handleQuery=function(){var e=n.state.modelName;n.setState({query:e})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&this.setState({active:null,modelName:"",query:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.active,a=t.modelName,o=t.query,i=(n||this.props.projectPositionDataModel).modelId,c=this.props,p=c.visible,f=c.onCancel,d=c.positionList,m=d?d.filter(function(e){return e.modelName.toLowerCase().indexOf(o.toLowerCase())>=0}):[];return r.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:800,visible:p,onOk:this.handleOk,onCancel:f,footer:r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:f},"取消"))},r.a.createElement("h2",null,"选择位置数据模型"),r.a.createElement("div",{className:"header"},r.a.createElement(l.a,{placeholder:"请选择位置数据模型",maxLength:20,onChange:this.handleChange,value:a,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),r.a.createElement("div",{className:"projectmanage-modal-table"},r.a.createElement(L.a,{rowKey:"modelId",pagination:!1,columns:[{title:"模型名称",dataIndex:"modelName",width:"40%"},{title:"描述",dataIndex:"modelDesc",width:"60%"}],dataSource:m,onRow:function(t){return{onClick:e.handleClick.bind(e,t)}},scroll:{x:"max-content",y:400},rowSelection:{type:"radio",selectedRowKeys:[i],onSelect:this.handleClick}})))}}])&&J(n.prototype,a),o&&J(n,o),t}(),Y=Object(p.b)(function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}},function(e){return{setPosition:function(t){return e(m.a.setPosition(t))},getSummaryList:function(t){return e(m.a.getSummaryList(t))}}})(Q);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Z(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Z(this,(e=ee(t)).call.apply(e,[this].concat(r)))).state={visible:!1},n.handleAdd=function(){n.setState({visible:!0})},n.handleCancel=function(){n.setState({visible:!1})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props.positionList;e&&0!==e.length||this.props.getPositionList()}},{key:"render",value:function(){var e=this.state.visible,t=this.props.projectPositionDataModel,n=t.modelId,a=t.modelName;return r.a.createElement("div",{className:"edit-detail position"},r.a.createElement("p",null,n?"已关联位置数据模型":"尚未关联位置数据模型"),n?r.a.createElement("p",{className:"model-name"},a):"",r.a.createElement(u.a,{type:"primary",className:"btn-choose",onClick:this.handleAdd},"选择位置数据模型"),r.a.createElement(Y,{visible:e,onOk:this.handleOk,onCancel:this.handleCancel}))}}])&&X(n.prototype,a),o&&X(n,o),t}(),ae=Object(p.b)(function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}},function(e){return{getPositionList:function(){return e(m.a.getPositionList())}}})(ne),re=(n(65),n(186),n(72));function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function le(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var se=re.a.Option,pe=["找不到设备","设备不在线","能力超出范围","指令超出范围","场景无法执行"],fe=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=le(this,ce(t).call(this,e))).handleClick=function(e){n.setState({tabIndex:e})},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r),function(){n.props.setRobotDetail(a,r)})},n.handleSelect=function(e){n.props.setRobotDetail("summaryId",e)},n.delVoice=function(e){var t=n.state,a=t.tabIndex,r=t.replyList;r[a]=r[a].filter(function(t,n){return n!==e}),console.log("----",r),n.setState({replyList:r},function(){n.props.setReplyList(r)})},n.editVoice=function(e,t){var a=n.state,r=a.tabIndex,o=a.replyList;o[r][t].replyInfo=e,n.setState({replyList:o},function(){n.props.setReplyList(o)})},n.addVoice=function(){var e=n.state,t=e.tabIndex,a=e.replyList,r={sceneId:t,replyIndex:1e3*Math.random()|0,replyInfo:""};a[t].push(r),n.setState({replyList:a},function(){n.props.setReplyList(a)})};var a=e.replyList;return n.state={tabIndex:0,robotId:"",robotDesc:"",replyList:a||null},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=e.replyList,n=e.projectVoiceRobot,a=n.robotId,r=n.robotDesc;a===this.state.robotId&&r===this.state.robotDesc||this.setState({robotId:a,robotDesc:r}),JSON.stringify(t)!==JSON.stringify(this.state.replyList)&&this.setState({replyList:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.tabIndex,a=t.robotId,o=t.robotDesc,i=this.props,c=i.projectVoiceRobot,u=i.summaryList,s=c.summaryId,p=c.summaryName,f=this.state.replyList||c.replyList;return console.log(u,s,p),r.a.createElement("div",{className:"edit-detail robot"},r.a.createElement("div",{className:"robot-choose"},r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"机器人ID：")),r.a.createElement(l.a,{placeholder:"请输入机器人ID",maxLength:6,value:a||c.robotId,name:"robotId",onChange:this.handleChange})),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"描述：")),r.a.createElement(l.a,{placeholder:"请输入描述",maxLength:150,value:o||c.robotDesc,name:"robotDesc",onChange:this.handleChange})),r.a.createElement("div",{className:"robot-tab-voice"},r.a.createElement("div",{className:"robot-position"},r.a.createElement("p",null,"语音机器人覆盖的最大空间区域"),r.a.createElement(re.a,{className:"robot-position-select",value:s,defaultActiveFirstOption:!!s,onChange:this.handleSelect},u&&u.length?u.map(function(e){return r.a.createElement(se,{value:e.summaryId,key:e.summaryId},e.summary)}):r.a.createElement(se,{value:s,key:s},p))),r.a.createElement("p",null,"异常场景回复语配置"),r.a.createElement("div",{className:"robot-voice-tabs"},r.a.createElement("ul",null,pe.map(function(t,a){return r.a.createElement("li",{key:t,className:a===n?"active":"",onClick:e.handleClick.bind(e,a)},r.a.createElement("span",null,t))})),r.a.createElement("div",{className:"robot-voice-list"},r.a.createElement("p",null,"回复语料（配置多条语料时随机下发）"),f&&f[n]&&f[n].map(function(t,n){return r.a.createElement("div",{className:"voice",key:"".concat(t.sceneId,"-").concat(t.replyIndex)},r.a.createElement(l.a,{placeholder:"最多输入50个字符",maxLength:50,value:t.replyInfo,onChange:function(t){return e.editVoice(t.target.value,n)}}),n>0?r.a.createElement("div",{className:"decrease",onClick:e.delVoice.bind(e,n)},r.a.createElement("p",null,"-")):null)}),r.a.createElement("div",{className:"voice-add"},r.a.createElement("span",{onClick:this.addVoice},"添加")))))))}}])&&ie(n.prototype,a),o&&ie(n,o),t}(),de=Object(p.b)(function(e){return{projectVoiceRobot:e.getIn(["projectManage","project","projectVoiceRobot"]).toJS(),summaryList:e.getIn(["projectManage","summaryList"]).toJS(),replyList:e.getIn(["projectManage","replyList"]).toJS()}},function(e){return{setRobotDetail:function(t,n){return e(m.a.setRobotDetail(t,n))},getSummaryList:function(t){return e(m.a.getSummaryList(t))},setReplyList:function(t){return e(m.a.setReplyList(t))}}})(fe);function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ve=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=he(this,(e=be(t)).call.apply(e,[this].concat(r)))).state={projectName:""},n.handleBack=function(){n.props.history.push("../list")},n.handleChange=function(e){var t=e.target.value;n.setState({projectName:t},function(){n.props.setProjectName(t)})},n.handleSave=function(){n.state.projectName?n.props.saveProject().then(function(e){e&&(j.a.success({message:"保存成功",duration:3}),n.props.history.push("../list"))}):j.a.error({message:"请输入项目名称",duration:3})},n}var n,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match,n=t.params.projectId;+n&&this.props.getProject(n).then(function(t){var n=t.data.code,a=t.data.data;n===P.a&&e.setState({projectName:a.projectName})}),this.props.history.replace("".concat(t.url,"/product"))}},{key:"componentWillUnmount",value:function(){this.props.clearData()}},{key:"render",value:function(){var e=this.props.match,t=this.state.projectName;return r.a.createElement("div",{className:"projectmanage"},r.a.createElement(d.a,{title:"项目管理"}),r.a.createElement(i.a,{className:"het-list"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"< 返回"),r.a.createElement("h2",null,"基本信息"),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,r.a.createElement("i",{className:"dot"},"*"),"名称：")),r.a.createElement(l.a,{placeholder:"请输入名称",maxLength:20,name:"projectName",value:t,onChange:this.handleChange})),r.a.createElement("h2",{style:{marginTop:20}},"关联信息"),r.a.createElement("div",{className:"nav-list"},r.a.createElement(k.c,{to:"".concat(e.url,"/product")},"产品设备"),r.a.createElement(k.c,{to:"".concat(e.url,"/position")},"位置数据模型"),r.a.createElement(k.c,{to:"".concat(e.url,"/robot")},"语音机器人")),r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(e.path,"/product"),component:z}),r.a.createElement(o.b,{path:"".concat(e.path,"/position"),component:ae}),r.a.createElement(o.b,{path:"".concat(e.path,"/robot"),component:de}),r.a.createElement(o.a,{from:"".concat(e.path,"/"),to:"".concat(e.path,"/product")})),r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:this.handleBack},"取消"))))}}])&&ye(n.prototype,a),c&&ye(n,c),t}(),Ee=Object(p.b)(function(e){return{project:e.getIn(["projectManage","project"]).toJS()}},function(e){return{getProject:function(t){return e(m.a.getProject(t))},setProjectName:function(t){return e(m.a.setProjectName(t))},clearData:function(){return e(m.a.clearData())},saveProject:function(){return e(m.a.saveProject())}}})(ve);n(1364),t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(t.url,"/list"),component:C}),r.a.createElement(o.b,{path:"".concat(t.url,"/:projectId"),component:Ee}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1407:function(e,t,n){"use strict";n.r(t);n(242);var a=n(0),r=n.n(a),o=n(104),i=(n(1363),n(20),n(35),n(36),n(29),n(28),n(40),n(41),n(45),n(37),n(46),n(22),n(31),n(30),n(32),n(92),n(33)),l=(n(138),n(79)),c=(n(791),n(441)),u=(n(206),n(80)),s=(n(71),n(21)),p=(n(241),n(118)),f=n(39),d=n(96),m=n(462),y=n(1339);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=y.a.Option,S=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=E(this,O(t).call(this,e))).changeModelName=function(e){console.log(e.target.value),n.setState({modelName:e.target.value})},n.handleFilter=function(){var e=n.state.modelName;n.setState({query:{modelName:e}},n.onChange)},n.handleReset=function(){n.setState({modelName:"",query:{}},function(){n.refInpt.setState({value:""})})},n.onChange=function(e){n.setState({loading:!0}),n.props.getLocationList(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({pageIndex:e},n.state.query)).then(function(){n.setState({loading:!1})})},n.onEdit=function(e){n.props.history.push("/config/positionmodel/".concat(e))},n.handleDel=function(e){p.a.confirm({title:"确定删除数据",centered:!0,onOk:function(){n.props.deleteModel(e)}})},n.state={loading:!1,modelName:"",query:{}},n}var n,o,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,a["Component"]),n=t,(o=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this,t=this.props,n=t.locationModelList,a=t.pager,o=this.state.loading,p=[{title:"模型ID",dataIndex:"modelId",key:"modelId",width:"100px"},{title:"名称",dataIndex:"modelName",width:"30%",key:"modelName",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"modelDesc",width:"40%",key:"modelDesc",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",key:"操作",render:function(t){return r.a.createElement("span",null,r.a.createElement(u.a,{placement:"top",title:"管理模型"},r.a.createElement(s.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.onEdit.bind(e,t.modelId)})),r.a.createElement(c.a,{type:"vertical"}),r.a.createElement(u.a,{placement:"top",title:"删除模型"},r.a.createElement(s.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.modelId)})))}}];return r.a.createElement("div",{className:"LocationDataModel_Content"},r.a.createElement(y.a,{title:"数据位置模型"},r.a.createElement(I,null,r.a.createElement(l.a,{style:{width:240},placeholder:"请输入模型名称查询",onChange:this.changeModelName.bind(this),onPressEnter:this.handleFilter.bind(this),ref:function(t){return e.refInpt=t}})),r.a.createElement(I,null,r.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleFilter.bind(this)},"查询")),r.a.createElement(I,null,r.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleReset.bind(this)},"重置")),r.a.createElement(I,{align:"right"},r.a.createElement(s.a,{className:"modelCreate",type:"primary",onClick:this.onEdit.bind(this,0)},"新建"))),r.a.createElement(i.a,{className:"LocationDataModel_bottomCard"},r.a.createElement(d.a,{rowKey:"modelId",columns:p,dataSource:n,pager:a,loading:o,onPageChange:this.onChange})))}}])&&v(n.prototype,o),f&&v(n,f),t}(),C=Object(f.b)(function(e){return{locationModelList:e.getIn(["positionModel","locationModelList"]).toJS(),pager:e.getIn(["positionModel","pager"]).toJS()}},function(e){return{getLocationList:function(t){return e(m.getLocationList(t))},deleteModel:function(t){return e(m.deleteLocation(t))}}})(S),j=(n(117),n(65),n(435),n(340),n(166),n(1323),n(1337)),k=(n(139),n(44)),P=n(343),L=(n(437),n(1319),n(165),n(10)),x=(n(164),n(337),n(187)),T=(n(163),n(50));function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function M(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=T.a.Item,q=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=M(this,(e=R(t)).call.apply(e,[this].concat(r)))).state={selectedRowKeys:[]},n.onSelectChange=function(e){console.log("..selectedRowKeys..",e),n.setState({selectedRowKeys:e})},n.handleSave=function(){var e=n.props.form,t=n.state.selectedRowKeys;e.validateFields(function(e,a){e||n.props.onOk({elementName:a.elementName,parentIds:t})})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.elementsItem;t&&t!==this.props.visible&&n&&(this.setState({selectedRowKeys:"string"==typeof n.parentIds?JSON.parse(n.parentIds):n.parentIds||[]}),this.props.form.setFieldsValue({elementName:n.elementName}))}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onOk,a=e.onCancel,o=e.form,i=e.list,c=o.getFieldDecorator,u={labelCol:{span:5},wrapperCol:{span:17}},f={selectedRowKeys:this.state.selectedRowKeys.filter(function(e){return i.findIndex(function(t){return t.elementId==e})>=0}),onChange:this.onSelectChange};return r.a.createElement(p.a,{width:600,visible:t,onCancel:a,onOk:n,title:"添加数据",className:"data-model",footer:null},r.a.createElement(T.a,null,r.a.createElement(F,D({},u,{label:"名称"}),c("elementName",{rules:[{required:!0,message:"请输入名称"}]})(r.a.createElement(l.a,{placeholder:"20个以内的字符",maxLength:20}))),this.props.id>0?r.a.createElement(F,D({},u,{label:"关联父层级"}),r.a.createElement(x.a,{rowKey:"elementId",size:"small",rowSelection:f,columns:[{title:"父层级数据",dataIndex:"elementName",width:1e3,textWrap:"word-break"}],pagination:!1,dataSource:i,scroll:{y:194},bordered:!1})):null,r.a.createElement(F,{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:a},"取消"))))}}])&&_(n.prototype,a),o&&_(n,o),t}(),B=T.a.create()(q);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function J(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=J(this,(e=W(t)).call.apply(e,[this].concat(r)))).state={index:0,visible:!1,selected:[],elementsItem:null},n.onChange=function(e){n.setState({index:e})},n.onEdit=function(e){n.setState({visible:!0,elementsItem:e||null})},n.onCloseItem=function(){n.setState({visible:!1})},n.onAddItem=function(e){var t=n.state.elementsItem,a=n.props,r=a.model,o=a.modelId,i=r.summary.summaryId;r.elements&&r.elements.length>99?k.a.error({message:"单层数据不能超过100",duration:3}):t.elementId&&e.elementName==t.elementName&&e.parentIds==t.parentIds?n.setState({visible:!1}):n.props.addElement(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{elementId:t.elementId||null,summaryId:i})).then(function(e){e&&(n.props.getModelList(o),n.setState({visible:!1}))})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,r.a.Component),n=t,(a=[{key:"render",value:function(){var e,t,n=this,a=this.props,o=a.model,i=a.nextItem,l=a.prevItem,c=a.id,u=o.summary,s=o.elements,p=this.state,f=p.index,d=p.visible,m=p.elementsItem,y=[];if(i.map(function(e,t){e.parentIds="string"==typeof e.parentIds?JSON.parse(e.parentIds):e.parentIds||[],e.parentIds.findIndex(function(e){return e==s[f].elementId})>=0&&y.push(t)}),y.length>0){var h=y.sort(function(e,t){return e.id-t.id});e=f<h[0]?f:h[0],t=f>h[h.length-1]?f:h[h.length-1]}return r.a.createElement("div",null,r.a.createElement("div",{className:"title"},r.a.createElement("p",{title:u.summary},u.summary)),r.a.createElement("ul",null,s.map(function(e,t){return r.a.createElement("li",{className:t==f?"active":"",key:t,onClick:n.onChange.bind(n,t)},e.elementName,r.a.createElement(L.a,{type:"edit",className:"edit",onClick:n.onEdit.bind(n,e)}))}),r.a.createElement("li",{className:"add"},r.a.createElement("p",{onClick:this.onEdit},"添加数据"))),y.length>0?r.a.createElement("svg",{className:"svg",height:50*t+100},r.a.createElement("polyline",{points:"0,".concat(50*f||1," ").concat(40,",").concat(50*f||1)}),y.map(function(e,t){return r.a.createElement("polyline",{points:"".concat(40,",").concat(50*e||1," ").concat(80,",").concat(50*e||1),key:t})}),r.a.createElement("polyline",{points:"".concat(40,",").concat(50*e," ").concat(40,",").concat(50*t)})):null,r.a.createElement(B,{visible:d,onOk:this.onAddItem,onCancel:this.onCloseItem,list:l,wrappedComponentRef:function(e){return n.form=e},elementsItem:m,id:c}))}}])&&K(n.prototype,a),o&&K(n,o),t}(),Q=Object(f.b)(null,function(e){return{addElement:function(t){return e(P.a.addElement(t))},getModelList:function(t){return e(P.a.getLocationDetailList(t))}}})(H);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function X(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Z(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=T.a.Item,ae=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Z(this,(e=ee(t)).call.apply(e,[this].concat(r)))).handleSave=function(){n.props.form.validateFields(function(e,t){e||n.props.onOk(t)})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.summary;t&&t!==this.props.visible&&n&&this.props.form.setFieldsValue({summary:n.summary})}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=e.onCancel,o=e.onOk,i=t.getFieldDecorator;return r.a.createElement(p.a,{width:600,visible:n,onCancel:a,onOk:o,title:"编辑数据",className:"data-model",footer:null},r.a.createElement(T.a,null,r.a.createElement(ne,$({},{labelCol:{span:5},wrapperCol:{span:15}},{label:"名称"}),i("summary",{rules:[{required:!0,message:"请输入名称"}]})(r.a.createElement(l.a,{placeholder:"20个以内的字符",maxLength:20}))),r.a.createElement(ne,{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:a},"取消"))))}}])&&X(n.prototype,a),o&&X(n,o),t}(),re=T.a.create()(ae);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function le(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var se=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=le(this,(e=ce(t)).call.apply(e,[this].concat(r)))).state={visible:!1,summaryItem:null},n.onAddGroup=function(e){var t,a=n.props,r=a.modelId,o=a.model,i=n.state.summaryItem,l=o.length,c=l>0&&i?o.findIndex(function(e){return e.summary.summaryId==i.summaryId}):void 0;t=c?o[c-1].summary.summaryId:void 0;var u={summaryId:i?i.summaryId:null,summary:e.summary,modelId:r,parentId:i?t:l>0?o[l-1].summary.summaryId:void 0};n.props.saveSummary(u).then(function(e){0===e?n.onCloseGroup():k.a.error({message:"保存数据失败",duration:3})})},n.onCloseGroup=function(){n.form.props.form.resetFields(),n.setState({visible:!1,summaryItem:null})},n.onEdit=function(e){var t=n.props,a=t.modelId,r=t.model;+a?e&&e.summary||!(r.length>9)?(e&&e.summary&&n.setState({summaryItem:e.summary}),n.setState({visible:!0})):k.a.error({message:"层级数不得超过十",duration:3}):k.a.error({message:"请先保存基本信息",duration:3})},n.handleDel=function(e){var t=n.props.modelId;p.a.confirm({title:"是否删除层级？",centered:!0,onOk:function(){n.props.delSummary(e.summaryId).then(function(e){e&&n.props.getModelList(t)})}})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,r.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.model,a=t.modelId,o=this.state,i=o.visible,l=o.summaryItem;return r.a.createElement("div",{className:"data-model"},n&&n.length>0?n.map(function(t,o){return r.a.createElement("div",{className:"data-model-item",key:o},r.a.createElement("h2",null,"第".concat("一二三四五六七八九十"[o],"层级")),r.a.createElement(Q,{model:t,id:o,nextItem:n[o+1]?n[o+1].elements:[],onEdit:e.onEditItem,prevItem:o>0?n[o-1].elements:[],modelId:a}),r.a.createElement("div",{className:"footer"},r.a.createElement("a",{className:"edit",onClick:e.onEdit.bind(e,t)},"编辑"),r.a.createElement("a",{className:"delete",onClick:e.handleDel.bind(e,t.summary)},"删除")))}):r.a.createElement("div",{className:"data-model-item"},r.a.createElement("div",{className:"title"},r.a.createElement("a",{onClick:this.onEdit},"点击添加"))),n&&n.length>0?r.a.createElement("div",{className:"data-model-item add"},r.a.createElement("a",{onClick:this.onEdit.bind(this)},"添加子层级")):null,r.a.createElement(re,{visible:i,onOk:this.onAddGroup,onCancel:this.onCloseGroup,wrappedComponentRef:function(t){return e.form=t},summary:l}))}}])&&ie(n.prototype,a),o&&ie(n,o),t}(),pe=Object(f.b)(function(e){return{model:e.getIn(["positionModel","model"]).toJS()}},function(e){return{saveSummary:function(t){return e(P.a.saveSummary(t))},delSummary:function(t){return e(P.a.delSummary(t))},getModelList:function(t){return e(P.a.getLocationDetailList(t))}}})(se),fe=n(4);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ye(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ge="/manage-open",ve=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=ye(this,(e=he(t)).call.apply(e,[this].concat(r)))).state={modelName:"",modelDesc:"",editid:-1,editkey:"",editval:"",addkey:"",addval:"",delLabelId:"",deleteLoading:!1,dellabelKey:"",dellabelValue:"",keylist:[],valuesource:[]},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r))},n.handleSave=function(){var e=n.state,t=e.modelName,a=e.modelDesc,r=n.props.match.params.modelId;t?n.props.saveModelDetail({modelName:t,modelDesc:a,modelId:parseInt(r)||""}).then(function(e){0===e&&(k.a.success({message:"保存数据成功",duration:3}),0==r&&n.props.getLocationList().then(function(e){if(e){var t=(e.list?e.list[0]:{}).modelId;t&&n.props.history.replace("/config/positionmodel/".concat(t))}}))}):k.a.error({message:"位置数据模型名称不能为空",duration:3})},n.handleBack=function(){n.props.history.go(-1)},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props.match.params.modelId,t=this;this.props.resetModelList(),this.getLabelKeyList(),+e&&(this.props.getModelDetail(e).then(function(e){if(e){var n=e.modelName,a=e.modelDesc;t.setState({modelName:n,modelDesc:a})}}),this.props.getModelList(e),this.props.getModLabelList(e))}},{key:"getLabeListHtml",value:function(){var e=this,t=this.props.modList||[],n=this.state,a=n.editid,o=n.editkey,i=n.editval,l=n.valuesource;return t.map(function(t,n){var u=t.relaId,s=t.keyName,p=t.valueName;return u==a?r.a.createElement("tr",{key:"tr_"+n},r.a.createElement("td",null,r.a.createElement(j.a,{value:o,dataSource:e.getKeySource(),style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editkey"),placeholder:"Key",filterOption:!0})),r.a.createElement("td",null,r.a.createElement(j.a,{value:i,dataSource:l,style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editval"),placeholder:"Value",filterOption:!0})),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:e.editConfirm.bind(e,s,p)},"确认"),r.a.createElement(c.a,{type:"vertical"}),r.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,-1,"","")},"取消"))):r.a.createElement("tr",{key:"tr_"+n},r.a.createElement("td",null,s),r.a.createElement("td",null,p),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,u,s,p)},"编辑"),r.a.createElement(c.a,{type:"vertical"}),r.a.createElement("a",{href:"javascript:",onClick:function(){return e.openDelMod(u,s,p)}},"删除")))})}},{key:"openDelMod",value:function(e,t,n){var a=this,r=this.props.match.params.modelId;p.a.confirm({title:"是否删除该标签？",centered:!0,onOk:function(){fe.b.Get(ge+"/position/label/rela/delete",{relaId:e}).then(function(e){0==e.data.code&&a.props.getModLabelList(r)})}})}},{key:"addConfirm",value:function(){var e=this,t=this.state,n=t.addkey,a=t.addval;if(""==n||""==a)return k.a.warning({message:"请将正在添加的标签输入框补充完整",duration:3}),!1;var r=this.props.match.params.modelId;fe.b.Get(ge+"/position/label/rela/save",{modelId:r,keyName:n,valueName:a}).then(function(t){0==t.data.code&&(e.setState({addkey:"",addval:""}),e.props.getModLabelList(r),e.getLabelKeyList())})}},{key:"editLabel",value:function(e,t,n){this.setState({editid:e,editkey:t,editval:n})}},{key:"editConfirm",value:function(e,t){var n=this,a=this.state,r=a.editid,o=a.editkey,i=a.editval,l=this.props.match.params.modelId;""==o&&""==i&&k.a.warning({message:"请将标签编辑输入框补充完整",duration:3}),fe.b.Get(ge+"/position/label/rela/save",{modelId:l,relaId:r,keyName:o||e,valueName:i||t}).then(function(e){0==e.data.code&&(n.setState({editid:-1,editkey:"",editval:""}),n.props.getModLabelList(l),n.getLabelKeyList())})}},{key:"getDataSource",value:function(e){}},{key:"getKeySource",value:function(){return this.state.keylist.map(function(e,t){return e.keyName})}},{key:"getLabelKeyList",value:function(){var e=this;fe.b.Get(ge+"/position/label/key/getList",{}).then(function(t){if(0==t.data.code){var n=t.data.data||[];e.setState({keylist:n})}})}},{key:"getValueSource",value:function(e){var t=this,n="-1";this.state.keylist.forEach(function(t){t.keyName==e&&(n=t.keyId)}),console.log(n),"-1"!==n?fe.b.Get(ge+"/position/label/value/getList",{keyId:n}).then(function(e){if(0==e.data.code){var n=(e.data.data||[]).map(function(e,t){return e.valueName});t.setState({valuesource:n})}}):this.setState({valuesource:[]})}},{key:"onChangeInput",value:function(e,t){if(t&&t.length>20)return!1;var n={};n[e]=t,this.setState(n),"addkey"!=e&&"editkey"!=e||this.getValueSource(t)}},{key:"render",value:function(){var e=this.props.match.params.modelId,t=this.state,n=t.modelName,a=t.modelDesc,o=t.addkey,c=t.addval,u=t.valuesource;return r.a.createElement("div",{className:"location-data"},r.a.createElement(y.a,{title:"".concat("0"!==e?"管理":"新建","位置数据模型")}),r.a.createElement(i.a,{className:"location-detail"},r.a.createElement("div",{className:"het-list"},r.a.createElement(s.a,{type:"primary",className:"btn-back",onClick:this.handleBack.bind(this)},"返回"),r.a.createElement("h2",null,"基本信息"),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null," ",r.a.createElement("i",{className:"dot"},"*"),"名称：")),r.a.createElement(l.a,{placeholder:"请输入名称",value:n,maxLength:20,name:"modelName",onChange:this.handleChange})),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"描述：")),r.a.createElement(l.a.TextArea,{placeholder:"请输入名称",value:a,maxLength:100,name:"modelDesc",onChange:this.handleChange})),r.a.createElement("div",{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"))),r.a.createElement("div",{className:"het-list"},r.a.createElement("h2",null,"数据模型"),r.a.createElement(pe,{modelId:e})),+e>0&&r.a.createElement("div",{className:"het-list"},r.a.createElement("h2",null,"标签管理"),r.a.createElement("table",{className:"labeltable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"38%"}},"标签Key"),r.a.createElement("th",{style:{width:"38%"}},"标签Value"),r.a.createElement("th",{style:{width:"24%"}},"管理"))),r.a.createElement("tbody",null,this.getLabeListHtml(),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(j.a,{value:o,dataSource:this.getKeySource(),style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addkey"),placeholder:"Key",maxLength:"20",filterOption:!0})),r.a.createElement("td",null,r.a.createElement(j.a,{value:c,dataSource:u,style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addval"),placeholder:"Value",maxLength:"20",filterOption:!0})),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:this.addConfirm.bind(this)},"确认"))))))))}}])&&me(n.prototype,a),o&&me(n,o),t}(),Ee=Object(f.b)(function(e){return{modelDetail:e.getIn(["positionModel","modelDetail"]).toJS(),modList:e.getIn(["positionModel","modList"]).toJS()}},function(e){return{getModelDetail:function(t){return e(P.a.getLocationDetail(t))},saveModelDetail:function(t){return e(P.a.saveLocationDetail(t))},getLocationList:function(){return e(P.a.getLocationList())},getModelList:function(t){return e(P.a.getLocationDetailList(t))},resetModelList:function(){return e(P.a.resetModelList())},getModLabelList:function(t){return e(P.a.getModLabelList(t))}}})(ve),Oe=n(1341);t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/list"),component:C}),r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/:modelId"),component:Object(Oe.a)(Ee)}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1409:function(e,t,n){"use strict";n.r(t);n(242);var a=n(0),r=n.n(a),o=n(104),i=(n(20),n(35),n(36),n(117),n(28),n(65),n(45),n(46),n(22),n(31),n(32),n(92),n(33)),l=(n(163),n(50)),c=(n(206),n(80)),u=(n(71),n(21)),s=(n(139),n(44)),p=(n(186),n(72)),f=n(39),d=n(1339),m=n(96),y=n(460),h=(n(164),n(166),n(241),n(118)),b=(n(138),n(79));function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=l.a.Item,C=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=O(this,(e=w(t)).call.apply(e,[this].concat(r)))).onCancel=function(){var e=n.props,t=e.form,a=e.onCancel;t.resetFields(),a()},n.onOk=function(){n.props.form.validateFields(function(e,t){if(!e){var a=t.applyAllocated,r=t.allocationDesc,o=n.props.macItem,i=o.hetModuleTypeId,l=o.macAllocationId;n.props.onOk({applyAllocated:a,allocationDesc:r,hetModuleTypeId:i,macAllocationId:l})}})},n.handleCheck=function(e,t,a){var r=n.props.macItem.remainAllocated;t>r||"0"===t?a("只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(r)):a()},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.macItem,a=e.visible,o=t.getFieldDecorator,i=n||{},u=i.hetName,s=i.remainAllocated,p={labelCol:{span:6},wrapperCol:{span:14}};return r.a.createElement(h.a,{width:600,visible:a,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},r.a.createElement(l.a,null,r.a.createElement(S,v({label:"模组型号"},p),o("hetName",{initialValue:u})(r.a.createElement(b.a,{disabled:!0}))),r.a.createElement(S,v({label:"申请数量"},p),r.a.createElement(c.a,{placement:"right",title:"只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(s),overlayStyle:{width:300}},o("applyAllocated",{rules:[{required:!0,message:"请输入申请数量"},{validator:this.handleCheck}],getValueFromEvent:function(e){return e.target.value.replace(/[^\d]/,"")}})(r.a.createElement(b.a,{placeholder:"请输入申请数量",maxLength:5})))),r.a.createElement(S,v({label:"申请描述"},p),r.a.createElement(c.a,{placement:"right",title:"最多支持输入50个字符。",overlayStyle:{width:300}},o("allocationDesc",{rules:[{required:!0,message:"请输入申请描述"}]})(r.a.createElement(b.a.TextArea,{maxLength:50,placeholder:"请输入申请描述",style:{height:100}}))))))}}])&&E(n.prototype,a),o&&E(n,o),t}(),j=l.a.create()(C);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function L(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=l.a.Item,_=p.a.Option,M=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=x(this,(e=T(t)).call.apply(e,[this].concat(r)))).onCancel=function(){var e=n.props,t=e.form,a=e.onCancel;t.resetFields(),a()},n.onOk=function(){n.props.form.validateFields(function(e,t){e||n.props.onOk(t)})},n.handleCheck=function(e,t,n){/^[0-9A-F]{2}$/.test(t)||n("只能输入两位数的十六进制[0-9、A~F]"),n()},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=e.moduleList,o=t.getFieldDecorator,i={labelCol:{span:8},wrapperCol:{span:14}};return r.a.createElement(h.a,{width:600,visible:n,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},r.a.createElement(l.a,null,r.a.createElement(D,P({label:"模组型号"},i),o("hetModuleTypeId",{rules:[{required:!0,message:"请选择模组型号"}]})(r.a.createElement(p.a,{placeholder:"请选择"},a.map(function(e){return r.a.createElement(_,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)})))),r.a.createElement(D,P({label:"MAC地址（第四字节）"},i),r.a.createElement(c.a,{placement:"right",title:"只能输入两位数的十六进制[0-9、A~F]",overlayStyle:{width:300}},o("productCode",{rules:[{min:2,max:2,required:!0,message:"请MAC地址（第四字节）"},{validator:this.handleCheck}],getValueFromEvent:function(e){return String.prototype.toLocaleUpperCase.call(e.target.value.substr(0,2).replace(/[^0-9a-fA-F]/,""))}})(r.a.createElement(b.a,{maxLength:2,placeholder:"MAC地址（第四字节）"}))))))}}])&&L(n.prototype,a),o&&L(n,o),t}(),R=l.a.create()(M),A=n(27),F=n(1340);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var K=p.a.Option,J=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=V(this,(e=U(t)).call.apply(e,[this].concat(r)))).state={loading:!1,moduleId:"",query:{},visible:!1,macItem:null,addVisible:!1},n.handleDetail=function(e){var t=e.hetModuleTypeId,a=e.productCode;n.props.history.push("./".concat(t,"/").concat(a))},n.handleEdit=function(e){n.setState({visible:!0,macItem:e})},n.onCancel=function(){n.setState({macItem:null,visible:!1})},n.handleAdd=function(){n.setState({addVisible:!0})},n.handleAddCancel=function(){n.setState({addVisible:!1})},n.onOk=function(e){console.log("----",e),n.props.macAllocation(e).then(function(e){e&&(s.a.success({message:"分配成功",duration:3}),n.props.onChange(1),n.onCancel())})},n.handleAddMac=function(e){n.props.addMac(e).then(function(e){e&&(s.a.success({message:"新增MAC成功",duration:3}),n.props.onChange(1),n.handleAddCancel())})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.props.getModuleList()}},{key:"render",value:function(){var e=this,t=this.state,n=(t.moduleId,t.visible),a=t.macItem,o=t.addVisible,s=this.props,f=s.macList,y=s.pager,h=s.moduleList,b=s.form,g=s.loading,v=b.getFieldDecorator,E=[{title:"模组型号",dataIndex:"hetName",width:"15%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"MAC地址（第4字节）",dataIndex:"productCode",width:"10%",className:"th-break"},{title:r.a.createElement("span",{title:"起始MAC"},"起始MAC"),dataIndex:"macBegin",width:"125px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:r.a.createElement("span",{title:"结束MAC"},"结束MAC"),dataIndex:"macEnd",width:"125px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"MAC总量",dataIndex:"maxinumAvailable",width:"10%"},{title:"已分配数",dataIndex:"quantityAllocated",width:"10%"},{title:"未分配数",dataIndex:"remainAllocated",width:"10%"},{title:"修改时间",dataIndex:"updateTime",width:"15%",className:"th-break",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"创建时间",dataIndex:"createTime",width:"15%",className:"th-break",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",fixed:"right",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(c.a,{placement:"top",title:"分配"},r.a.createElement(u.a,{icon:"apartment",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",r.a.createElement(c.a,{placement:"top",title:"查看"},r.a.createElement(u.a,{icon:"info",shape:"circle",size:"small",onClick:e.handleDetail.bind(e,t)})))}}];return r.a.createElement("div",{className:"macList"},r.a.createElement(d.a,{title:"和而泰MAC分配"},r.a.createElement(l.a,{layout:"inline"},r.a.createElement(l.a.Item,{label:"模组型号"},v("hetModuleTypeId")(r.a.createElement(p.a,{style:{width:240},placeholder:"请选择模组型号"},r.a.createElement(K,{key:"",value:""},"全部"),h.map(function(e){return r.a.createElement(K,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)})))),r.a.createElement(l.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),r.a.createElement(l.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),r.a.createElement(l.a.Item,{style:{float:"right"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleAdd},"新建")))),r.a.createElement(i.a,null,r.a.createElement(m.a,{rowKey:"macAllocationId",columns:E,dataSource:f,pager:y,onPageChange:this.props.onChange,loading:g,scroll:{x:1200,y:"auto"}})),r.a.createElement(j,{visible:n,macItem:a,onCancel:this.onCancel,onOk:this.onOk}),r.a.createElement(R,{visible:o,moduleList:h,onCancel:this.handleAddCancel,onOk:this.handleAddMac}))}}])&&B(n.prototype,a),o&&B(n,o),t}(),W=Object(f.b)(function(e){return{macList:e.getIn(["macAllocation","macList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS(),moduleList:e.getIn(["macAllocation","moduleList"]).toJS(),loading:e.getIn(["macAllocation","loading"])}},function(e){return{getList:function(t){return e(y.a.getMacList(t))},getModuleList:function(){return e(y.a.getModuleList())},macAllocation:function(t){return e(y.a.macAllocation(t))},addMac:function(t){return e(y.a.addMac(t))}}})(l.a.create()(Object(F.a)(J)));function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Q(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Q(this,(e=Y(t)).call.apply(e,[this].concat(r)))).state={hetModuleTypeId:"",productCode:"",loading:!1},n.onChange=function(e){var t=n.props.match.params,a=t.hetModuleTypeId,r=t.productCode;n.setState({loading:!0}),n.props.getMacDetailList({hetModuleTypeId:a,productCode:r,pageIndex:e}).then(function(){n.setState({loading:!1})})},n.handleBack=function(){n.props.history.go(-1)},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this.state.loading,t=this.props,n=t.macDetailList,a=t.pager,o=[{title:"MAC起始地址",dataIndex:"macBegin",width:"15%"},{title:"MAC结束地址",dataIndex:"macEnd",width:"15%"},{title:"申请数量",dataIndex:"allocationCount",width:"10%"},{title:"描述",dataIndex:"allocationDesc",width:"30%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"创建时间",dataIndex:"createTime",width:"20%",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",null,t)}},{title:"操作",render:function(e){return r.a.createElement("div",{className:"action"},r.a.createElement("a",{href:"/v1/web/manage-open/mac/allocation/excelExport?macBegin=".concat(e.macBegin,"&macEnd=").concat(e.macEnd),target:"blank"},"导出"))}}];return r.a.createElement("div",{className:"macList"},r.a.createElement(d.a,{title:"MAC详情"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),r.a.createElement(i.a,null,r.a.createElement(m.a,{rowKey:"macAllocationId",pagination:!1,columns:o,dataSource:n,pager:a,onPageChange:this.onChange,loading:e})))}}])&&H(n.prototype,a),o&&H(n,o),t}(),Z=Object(f.b)(function(e){return{macDetailList:e.getIn(["macAllocation","macDetailList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS()}},function(e){return{getMacDetailList:function(t){return e(y.a.getMacDetailList(t))},exportList:function(){return e(y.a)}}})(X);n(1365),t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(t.url,"/list"),component:W}),r.a.createElement(o.b,{path:"".concat(t.url,"/:hetModuleTypeId/:productCode"),component:Z}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1412:function(e,t,n){"use strict";n.r(t);n(242);var a=n(0),r=n.n(a),o=n(104),i=(n(20),n(35),n(36),n(117),n(28),n(45),n(46),n(22),n(31),n(32),n(163),n(50)),l=(n(138),n(79)),c=(n(206),n(80)),u=(n(71),n(21)),s=(n(241),n(118)),p=n(39),f=n(1339),d=n(96),m=n(140),y=n(454),h=n(27),b=n(1340);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return a=this,r=(e=E(t)).call.apply(e,[this].concat(i)),(n=!r||"object"!==g(r)&&"function"!=typeof r?O(a):r).handleEdit=function(e){n.props.history.push("./".concat(e.roleId||0)),n.props.setRoleDetail(e)},n.handleDel=function(e){var t=O(n);s.a.confirm({title:"提示",content:"是否确认删除？",onOk:function(){console.log("确认删除"),t.props.delRole(e)}})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,r.a.Component),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props,n=t.roleList,a=t.pager,o=t.loading,s=t.form.getFieldDecorator,p=[{title:"角色名",dataIndex:"roleName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"角色备注",dataIndex:"remark",width:"35%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"最新修改时间",dataIndex:"modifyTime",width:"30%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"操作",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(c.a,{placement:"top",title:"编辑"},r.a.createElement(u.a,{icon:"edit",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",r.a.createElement(c.a,{placement:"top",title:"删除"},r.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small",onClick:e.handleDel.bind(e,t.roleId)})))}}];return r.a.createElement("div",{className:"interface-role"},r.a.createElement(f.a,{title:"接口访问用户角色"},r.a.createElement(i.a,{layout:"inline"},r.a.createElement(i.a.Item,{label:"角色名"},s("roleName")(r.a.createElement(l.a,{placeholder:"请输入角色名",maxLength:20,style:{width:240},onPressEnter:this.props.onFilter}))),r.a.createElement(i.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),r.a.createElement(i.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),r.a.createElement(i.a.Item,{style:{float:"right"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleEdit.bind(this,{})},"新建")))),r.a.createElement("div",{className:"interface-role-content"},r.a.createElement(d.a,{rowKey:"roleId",columns:p,dataSource:n,pager:a,loading:o,onPageChange:this.props.onChange})))}}])&&v(n.prototype,a),o&&v(n,o),t}(),S=Object(p.b)(function(e){return{roleList:e.getIn(["interfaceRole","roleList"]).toJS(),pager:e.getIn(["interfaceRole","pager"]).toJS(),loading:e.getIn(["interfaceRole","loading"])}},function(e){return Object(m.b)({getList:y.a.getList,setRoleDetail:y.a.setRoleDetail,delRole:y.a.delRole},e)})(i.a.create()(Object(b.a)(I))),C=(n(29),n(40),n(41),n(37),n(30),n(139),n(44)),j=(n(286),n(437),n(333),n(335),n(281),n(65),n(280),n(207),n(773),n(336),n(243),n(774),n(775),n(776),n(777),n(778),n(779),n(780),n(781),n(782),n(783),n(784),n(785),n(786),n(787),n(788),n(789),n(186),n(72)),k=n(1344),P=n(95);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var M=i.a.Item,R=j.a.Option,A=function e(t){return t&&t.map(function(t){return{id:t.boxId,name:(t.boxName||t.groupName||"").split("#")[0],children:e(t.subBoxs)}})},F=function e(t,n,a,r){return t&&t.map(function(t){(t.boxName&&t.boxName.indexOf(a)>=0||t.groupName&&t.groupName.indexOf(a)>=0)&&n.push(r+t.boxId),e(t.subBoxs,n,a,r+t.boxId+"-")})},q=function e(t,n){return t&&t.length&&t.map(function(t){t.checked=n.includes(t.boxId+""),e(t.subBoxs,n)})};var B=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=T(t).call(this,e),(n=!r||"object"!==L(r)&&"function"!=typeof r?N(a):r).refInput=void 0,n.refTree=void 0,n.changeMenu=function(e){n.setState({menuCode:e,searchStr:""},function(){n.refInput.setState({value:"",expandedKeys:[]})}),"dataDimension"===e?n.setState({searchType:P.a.Label}):"dataObject"===e&&n.setState({searchType:P.a.Product})},n.changeKey=function(e){var t=e.target.value,a=n.state.menuCode,r=n.props.authTree,o=r&&r.length?a||r[0].menuCode:"",i=r.find(function(e){return e.menuCode===o}),l=i?i.checkBoxGroupList:[];n.setState({searchStr:t},function(){if(""!==t){var e=[];F(l,e,t,"");var a=[];e.map(function(e){var t=e.split("-").slice(0,-1),n="";t.forEach(function(e){n+=e,a.push(n),n+="-"})});var r=Array.from(new Set(a));n.refTree.setState({expandedKeys:r})}else n.refTree.setState({expandedKeys:[],selectedKeys:[]})})},n.handleSearchType=function(e){n.setState({searchType:e},function(){n.refInput.setState({value:""})})},n.handleSearch=Object(h.h)(function(e){var t=n.state.searchType;n.props.searchAuth({type:t,typeName:e}).then(function(t){n.changeKey({target:{value:e}})})},800),n.handleChange=function(e,t){var a,r,o,i,l=n.props,c=l.authTree,u=l.authCheck,s=n.state.menuCode,p=c&&c.length?s||c[0].menuCode:"",f=c.findIndex(function(e){return e.menuCode===p}),d=(a=u[f],r=e,o=a.filter(function(e){return!r.includes(e)}),i=r.filter(function(e){return!a.includes(e)}),[].concat(_(o),_(i)));n.props.setAuthTreeCheck([].concat(_(u.slice(0,f)),[e],_(u.slice(f+1)))),"dataDimension"!==p&&"dataObject"!==p?n.props.setTargetTreeCheck([].concat(_(u.slice(0,f)),[e],_(u.slice(f+1)))):n.props.mergeToTargetTree(f,d,t.checked)},n.handleClear=function(){var e=n.props,t=e.targetCheck,a=e.authTree,r=e.authCheck,o=n.state.menuCode,i=a&&a.length?o||a[0].menuCode:"";a.findIndex(function(e){return e.menuCode===i});n.props.setAuthTreeCheck(r.map(function(e){return[]})),n.props.setTargetTreeCheck(t.map(function(e){return[]}))},n.handleSave=function(){var e=n.props,t=e.targetTree,a=e.targetCheck,r=Object(h.i)(t),o=a.reduce(function(e,t){return e.concat(t)},[]),i=[];return o.map(function(e){var t=e.split("-").slice(1);i=i.concat(t)}),i=Array.from(new Set(i)),r&&r.map(function(e){"hideData"!==e.menuCode&&q(e.checkBoxGroupList,i)}),r.reduce(function(e,t){return e.concat(t.checkBoxGroupList)},[])},n.state={menu:"",menuCode:"",menuIndex:0,searchStr:"",searchType:P.a.Product},n.props.onRef(N(n)),n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentWillUnmount",value:function(){this.props.clearRoleData()}},{key:"render",value:function(){var e=this,t=this.props,n=t.targetTree,a=t.targetCheck,o=t.authTree,i=t.authCheck,c=this.state,u=c.searchStr,s=c.searchType,p=c.menuCode,f={width:300},d={dataDimension:r.a.createElement(l.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t},style:f}),dataObject:r.a.createElement(l.a.Group,{compact:!0,className:"auth-key",style:f},r.a.createElement(j.a,{style:{width:110},value:s,onChange:this.handleSearchType},r.a.createElement(R,{key:"product",value:P.a.Product},"产品"),r.a.createElement(R,{key:"app",value:P.a.App},"APP应用"),r.a.createElement(R,{key:"appWeChat",value:P.a.AppWeChat},"微信小程序")),r.a.createElement(l.a,{style:{width:190},placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t}}))},m=o&&o.length?p||o[0].menuCode:"",y=o.findIndex(function(e){return e.menuCode===m}),h=[];y>=0&&(h=A(o[y].checkBoxGroupList),A(n[y].checkBoxGroupList));var b=n.map(function(e,t){return{id:e.menuCode,name:e.menuName,children:A(e.checkBoxGroupList)}}),g=a.map(function(e,t){return e.map(function(e){return n[t].menuCode+"-"+e})}).reduce(function(e,t){return e.concat(t)},[]);return r.a.createElement(M,{label:"权限配置"},r.a.createElement("div",{className:"interface-role-search"},r.a.createElement(j.a,{className:"auth-api",onChange:this.changeMenu,style:{width:180},value:m},o&&o.length?o.map(function(e){return r.a.createElement(R,{key:e.menuCode,value:e.menuCode},e.menuName)}):r.a.createElement(R,{key:"",value:""},"")),["dataDimension","dataObject"].includes(m)?d[m]:r.a.createElement(l.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:this.changeKey,ref:function(t){return e.refInput=t},style:f})),r.a.createElement("div",{className:"interface-role-auth"},r.a.createElement("div",{className:"tree-transfer"},r.a.createElement("div",{className:"tree-transfer-wraper"},r.a.createElement(k.a,{dataSource:h,target:i[y],onChange:this.handleChange,ref:function(t){return e.refTree=t},searchStr:u})),r.a.createElement("h3",{className:"tree-transfer-tab"},r.a.createElement("span",null,"已选权限"),r.a.createElement("span",{className:"btn-clear",onClick:this.handleClear},"全部清除")),r.a.createElement("div",{className:"tree-transfer-wraper"},r.a.createElement(k.a,{dataSource:b,target:g,isCheck:!1,isExpand:!0})))))}}])&&x(n.prototype,a),o&&x(n,o),t}(),V=Object(p.b)(function(e){return{authTree:e.getIn(["interfaceRole","authTree"]).toJS(),authCheck:e.getIn(["interfaceRole","authCheck"]).toJS(),targetTree:e.getIn(["interfaceRole","targetTree"]).toJS(),targetCheck:e.getIn(["interfaceRole","targetCheck"]).toJS()}},function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,setRoleAuthTarget:y.a.setRoleAuthTarget,searchAuth:y.a.searchAuth,setAuthTreeCheck:y.a.setAuthTreeCheck,setTargetTreeCheck:y.a.setTargetTreeCheck,mergeToTargetTree:y.a.mergeToTargetTree,clearRoleData:y.a.clearRoleData},e)})(B);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=i.a.Item,Y=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=W(this,(e=G(t)).call.apply(e,[this].concat(r)))).refSet=void 0,n.state={isChecked:!1},n.handleBack=function(){n.props.history.go(-1)},n.handleSave=function(){var e=n.props,t=e.form,a=e.roleDetail;t.validateFields(function(e,t){if(!e)if(t.roleName){var r=n.refSet.handleSave();n.props.saveRole(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(n,!0).forEach(function(t){K(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({roleId:a.roleId||void 0},t,{dataJson:JSON.stringify(r)})).then(function(e){e&&(C.a.success({duration:3,message:"保存成功"}),n.props.history.go(-1))})}else C.a.error({duration:3,message:"角色名不能为空"})})},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,r.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props.match.params.roleId;this.props.getRoleAuth(+e),+e&&this.props.getRoleDetail(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,a=t.roleDetail,o=n.getFieldDecorator;return r.a.createElement("div",{className:"interface-role"},r.a.createElement(f.a,{title:"用户角色"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),r.a.createElement("div",{className:"interface-role-content"},r.a.createElement(i.a,null,r.a.createElement(Q,{label:"用户角色名"},o("roleName")(r.a.createElement(l.a,{style:{width:500},placeholder:"20个字符以内",maxLength:20}))),r.a.createElement(Q,{label:"角色备注"},o("remark")(r.a.createElement(l.a,{style:{width:500},placeholder:"不超过100个字符",maxLength:100}))),r.a.createElement(V,{onRef:function(t){return e.refSet=t}}),r.a.createElement(Q,{style:{textAlign:"center"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleSave},a.roleId?"保存":"创建用户角色"),r.a.createElement(u.a,{type:"default",style:{marginLeft:20},onClick:this.handleBack},"取消")))))}}])&&J(n.prototype,a),o&&J(n,o),t}(),$=Object(p.b)(function(e){return{roleDetail:e.getIn(["interfaceRole","roleDetail"]).toJS()}},function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,getRoleDetail:y.a.getRoleDetail,modifyRoleDetail:y.a.modifyRoleDetail,saveRole:y.a.saveRole},e)})(i.a.create({mapPropsToFields:function(e){return e.roleDetail?{roleName:i.a.createFormField({value:e.roleDetail.roleName}),remark:i.a.createFormField({value:e.roleDetail.remark})}:null},onFieldsChange:function(e,t){for(var n in t)e.modifyRoleDetail(K({},n,t[n].value))}})(Y)),X=(n(1366),n(1341));t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/list"),component:S}),r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/:roleId"),component:Object(X.a)($)}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1417:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(28),n(65),n(45),n(46),n(22),n(31),n(242),n(32),n(92);var a=n(33),r=(n(794),n(342)),o=n(0),i=n.n(o),l=(n(117),n(29),n(164),n(40),n(41),n(37),n(1309),n(30),n(71),n(21)),c=(n(1318),n(1320)),u=(n(138),n(79)),s=(n(163),n(50)),p=(n(241),n(118)),f=(n(186),n(72)),d=n(39),m=n(447),y=n(197);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=f.a.Option,C=p.a.confirm,j=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=O(this,(e=w(t)).call.apply(e,[this].concat(r)))).generateOptions=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(S,{value:e.moduleBrandId,key:e.moduleBrandId},e.brandName)})},n.saveModuleInfo=function(){var e=n.props,t=e.moduleInfo,a=e.form.validateFields;t&&t.moduleId?a(function(e,t){e||n.props.changeCurrent()}):a(function(e,t){if(!e){console.log("第一步提交了====",t);var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{stepIndex:1});Object(y.j)(a).then(function(e){var t=e.data;if(0===t.code){var a=t.data.moduleId;n.props.getModuleInfo(a),n.props.changeCurrent()}})}})},n.canleClick=function(){C({title:"当前编辑信息未保存，是否继续退出",content:"",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){n.props.goBack()},onCancel:function(){}})},n.checkNumber=function(e,t,n){t<0?n("仅允许输入正整数"):n()},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,o["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,n=t.moduleInfo,a=t.brandItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,b({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"模组生产厂家"},e("moduleBrandId",{rules:[{required:!0,message:"请选择模组生产厂家"}]})(i.a.createElement(f.a,{placeholder:"请选择模组生产厂家"},this.generateOptions(a)))),i.a.createElement(s.a.Item,{label:"模组型号"},e("hetModuleTypeName",{rules:[{required:!0,message:"请输入模组型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"模组IC型号"},e("originalModuleTypeName",{rules:[{required:!0,message:"请输入模组IC型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组IC型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"适用范围"},e("applyScope",{rules:[{required:!0,message:"请输入模组适用范围"},{type:"string",max:50,message:"上限20个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组适用范围，如：家电产品",maxLength:50}))),i.a.createElement(s.a.Item,{className:"moduleSize",label:"模组尺寸"},i.a.createElement(s.a.Item,{label:"",style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeWidth",{initialValue:n.sizeWidth,rules:[{required:!0,message:"请输入宽"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(c.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeHeight",{initialValue:n.sizeHeight,rules:[{required:!0,message:"请输入高"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(c.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeThickness",{initialValue:n.sizeThickness,rules:[{required:!0,message:"请输入厚"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(c.a,{maxLength:3,max:999}))),i.a.createElement("br",null),i.a.createElement("span",null,"（长*宽*高 mm）")),i.a.createElement(s.a.Item,b({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(l.a,{type:"primary",onClick:this.saveModuleInfo,style:{marginRight:10}},"下一步"),i.a.createElement(l.a,{type:"default",onClick:this.canleClick},"取 消"))))}}])&&E(n.prototype,a),r&&E(n,r),t}(),k=Object(d.b)(function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{saveModuleInfo:function(t){var n=m.a.saveModuleInfo(t);e(n)},getModuleInfo:function(t,n){var a=m.a.getModuleInfo(t,n);e(a)},changeCurApi:function(t,n){var a=m.a.changeCurApi(t,n);e(a)}}})(s.a.create({name:"BasicParamsFrom",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0],a=Object.values(t)[0];e.changeCurApi(n,a.value)}},mapPropsToFields:function(e){for(var t=e.moduleInfo,n={},a=0,r=Object.keys(t);a<r.length;a++){var o=r[a];n[o]=s.a.createFormField({value:t[o]})}return n}})(j)),P=(n(1322),n(435),n(74),n(1308),n(1307)),L=(n(436),n(168)),x=(n(338),n(146)),T=(n(165),n(10)),N=(n(279),n(152)),D=(n(443),n(1358),n(27));function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function R(e,t,n,a,r,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(a,r)}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function F(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=f.a.Option,U=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=F(this,q(t).call(this,e))).moduleTypeOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(V,{value:e.moduleId,key:e.moduleId},e.moduleId+" "+e.hetModuleTypeName)})},n.potocolOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(V,{value:e.supportProtocol,key:e.supportProtocol},e.supportProtocolName)})},n.sceneOptions=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(V,{value:e.sceneTypeId,key:e.sceneTypeId},e.sceneTypeName)})},n.dataLengthLimitOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(V,{value:e.dataLengthLimit,key:e.dataLengthLimit},e.dataLengthLimitName)})},n.preClick=function(){n.props.changeCurrent()},n.handlePreview=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,n.getBase64(t.originFileObj);case 3:t.preview=e.sent;case 4:n.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){R(o,a,r,i,l,"next",e)}function l(e){R(o,a,r,i,l,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),n.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},n.handleCancelPreview=function(){n.setState({previewVisible:!1})},n.handleSubmit=function(){var e=n.props.moduleInfo;n.props.form.validateFields(function(t,a){if(!t){var r={moduleTypeList:a.moduleTypeList,appModuleId:a.appModuleId,networkTypeList:a.networkTypeList,supportProtocolType:a.supportProtocolType,communicateSpeed:a.communicateSpeed,bindSceneType:a.bindSceneType,supportFileTransfer:a.supportFileTransfer,supportSocProject:a.supportSocProject,burnFileVersion:a.burnFileVersion,libraryFileVersion:a.libraryFileVersion,sourceCodeVersion:a.sourceCodeVersion,moduleId:e.moduleId,dataLengthLimit:a.dataLengthLimit,stepIndex:2,sizeWidth:e.sizeWidth,sizeHeight:e.sizeHeight,sizeThickness:e.sizeThickness,applyScope:e.applyScope,originalModuleTypeName:e.originalModuleTypeName,hetModuleTypeName:e.hetModuleTypeName,moduleBrandId:e.moduleBrandId};Object(y.j)(r).then(function(e){0===e.data.code&&N.a.success("提交成功",2,function(){return n.props.goBack()})})}})},n.checkboxOnChange=function(e){n.props.getAllModuleTypeList(e),n.props.form.resetFields("appModuleId")},n.handleChange=function(e,t){console.log(e,t.file,t.file.status,t.fileList);var a=t.file,r=t.fileList;if("done"===a.status){var o=r[0];o.url=o.response.data.url;var i=[];i.push(o),n.props.changeCurApi(e,i),n.saveFileUrl(e,t.file)}else"error"===a.status?(N.a.error("".concat(t.file.name," 上传失败")),t.fileList.length=0,n.props.changeCurApi(e,t.fileList)):"removed"===a.status?n.props.changeCurApi(e,t.fileList):void 0===t.file.status&&(t.fileList.length=0,n.props.changeCurApi(e,t.fileList))},n.saveFileUrl=function(e,t){var a=n.props.moduleInfo,r=a.historyObj,o={moduleId:a.moduleId,columnName:e,historyFileUrl:r[e],fileUrl:t.response.data.url,fileName:t.name};Object(y.k)(o).then(function(e){0===e.data.code&&console.log("文件保存成功")})},n.getFile=function(e,t){var n=[],a=t[e];if(void 0!==a){var r=e+"Name",o={url:a,status:"done",name:t[r],uid:0+r};n.push(o),console.log("render file :",o)}return n},n.state={previewVisible:!1,previewImage:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,o["Component"]),n=t,(a=[{key:"sourceCodeBeforeUpload",value:function(e){var t="application/zip"===e.type||"application/x-zip-compressed"===e.type;t||N.a.error("只能上传zip文件");var n=e.size/1024/1024<=512;n||N.a.error("zip文件必须小于512M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"libraryFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t=".a"===e.name.substr(e.name.lastIndexOf(".")).toLowerCase();t||N.a.error("只能上传.a库文件");var n=e.size/1024/1024<=512;n||N.a.error(".a库文件必须小于512M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"burnFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/macbinary"===e.type||"application/octet-stream"===e.type;t||N.a.error("只能上传烧录文件!");var n=e.size/1024/1024<=32;n||N.a.error(".bin文件必须小于32M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"modulePictureBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="image/jpeg"===e.type||"image/png"===e.type;t||N.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;n||N.a.error("图片必须小于500KB!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"referenceCircuitDiagramBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/pdf"===e.type;t||N.a.error("只能上传PDF文件");var n=e.size/1024/1024<=2;n||N.a.error("PDF must smaller than 2M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"render",value:function(){var e={action:D.j,className:"upload-list-inline",data:function(e){return{appId:31438,domainType:4}}},t=this.props.form.getFieldDecorator,n=i.a.createElement(l.a,null,i.a.createElement(T.a,{type:"upload"})," 上传文档"),a=this.props,r=a.moduleInfo,o=a.communicationMethodList,d=a.dataLengthLimitList,m=a.networkMethodList,y=a.protocolList,h=a.bindSceneList,b=a.moduleTypeItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,M({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"通信方式"},t("moduleTypeList",{rules:[{required:!0,message:"请选择通信方式"}]})(i.a.createElement(x.a.Group,{onChange:this.checkboxOnChange},o&&o.length?o.map(function(e){return i.a.createElement(x.a,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)}):null))),i.a.createElement(s.a.Item,{label:"模组所属库"},t("appModuleId",{rules:[{required:!0,message:"请您选择模组所属库"}]})(i.a.createElement(f.a,{placeholder:"请选择模组所属库"},this.moduleTypeOption(b)))),i.a.createElement(s.a.Item,{label:"配网方式"},t("networkTypeList",{rules:[{required:!0,message:"请选择配网方式"}]})(i.a.createElement(x.a.Group,null,m&&m.length?m.map(function(e){return i.a.createElement(x.a,{value:e.networkType,key:e.networkType},e.networkTypeName)}):null))),i.a.createElement(s.a.Item,{label:"支持协议"},t("supportProtocolType",{rules:[{required:!0,message:"请选择支持协议"}]})(i.a.createElement(f.a,{placeholder:"请选择支持协议"},this.potocolOption(y)))),i.a.createElement(s.a.Item,{label:"通信速率"},t("communicateSpeed",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(c.a,{placeholder:"请输入通信速率",style:{width:"100%"},maxLength:6}))),i.a.createElement(s.a.Item,{label:"数据长度上限"},t("dataLengthLimit",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(f.a,{placeholder:"请选择数据长度上限"},this.dataLengthLimitOption(d)))),i.a.createElement(s.a.Item,{label:"绑定场景"},t("bindSceneType",{rules:[{required:!0,message:"请选择绑定场景"}]})(i.a.createElement(f.a,{placeholder:"请选择绑定场景"},this.sceneOptions(h)))),i.a.createElement(s.a.Item,{label:"支持文件传输"},t("supportFileTransfer",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(L.a.Group,null,i.a.createElement(L.a,{value:1},"是"),i.a.createElement(L.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"支持SOC方案"},t("supportSocProject",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(L.a.Group,null,i.a.createElement(L.a,{value:1},"是"),i.a.createElement(L.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"模组文件",style:{marginBottom:0}}),1===r.supportSocProject?i.a.createElement(s.a.Item,{label:"源码",extra:"（请上传格式为.zip源文件压缩包）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("sourceCode",{rules:[{required:!1,message:"请上传源码"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{beforeUpload:this.sourceCodeBeforeUpload,onChange:this.handleChange.bind(this,"sourceCode"),defaultFileList:r.sourceCode||[],accept:".zip "}),r.sourceCode&&r.sourceCode.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("sourceCodeVersion",{rules:[{required:!1,message:"请输入源码版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,1===r.supportSocProject?i.a.createElement(s.a.Item,{label:"库文件",extra:"（请上传格式为.a的库文件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("libraryFile",{rules:[{required:!1,message:"请上传库文件"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{beforeUpload:this.libraryFileBeforeUpload,onChange:this.handleChange.bind(this,"libraryFile"),defaultFileList:r.libraryFile||[],accept:".a"}),r.libraryFile&&r.libraryFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("libraryFileVersion",{initialValue:r.libraryFileVersion,rules:[{required:!1,message:"请输入库文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,i.a.createElement(s.a.Item,{label:"烧录文件",extra:"（请上传格式为.bin的烧录件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("burnFile",{rules:[{required:!1,message:"请上传烧录文件"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{beforeUpload:this.burnFileBeforeUpload,onChange:this.handleChange.bind(this,"burnFile"),defaultFileList:r.burnFile||[],accept:".bin"}),r.burnFile&&r.burnFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("burnFileVersion",{initialValue:r.burnFileVersion,rules:[{required:!1,message:"请输入烧录文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))),i.a.createElement(s.a.Item,{label:"模组图片",extra:"（请上传格式为.png，小于500k图片）"},t("modulePicture",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{listType:"picture",defaultFileList:r.modulePicture||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"modulePicture")}),r.modulePicture&&r.modulePicture.length>=1?null:i.a.createElement(l.a,null,i.a.createElement(T.a,{type:"upload"})," 上传图片")),i.a.createElement(p.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"参考电路",extra:"（请上传格式为.png，小于500k图片）"},t("referenceCircuitDiagram",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{listType:"picture",defaultFileList:r.referenceCircuitDiagram||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"referenceCircuitDiagram")}),r.referenceCircuitDiagram&&r.referenceCircuitDiagram.length>=1?null:i.a.createElement(l.a,null,i.a.createElement(T.a,{type:"upload"})," 上传图片")),i.a.createElement(p.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"说明文档",extra:"（请上传格式为.pdf，大小2M说明文件)"},t("readmePdf",{rules:[{required:!1,message:"请上传文档"}]})(i.a.createElement("div",null,i.a.createElement(P.a,M({},e,{defaultFileList:r.readmePdf||[],beforeUpload:this.referenceCircuitDiagramBeforeUpload,accept:".pdf",onChange:this.handleChange.bind(this,"readmePdf")}),r.readmePdf&&r.readmePdf.length>=1?null:n)))),i.a.createElement(s.a.Item,M({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(l.a,{className:"functionParmsForms_Next",onClick:this.preClick},"上一步"),i.a.createElement(l.a,{type:"primary",onClick:this.handleSubmit},"提  交"))))}}])&&A(n.prototype,a),r&&A(n,r),t}(),z=Object(d.b)(function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),networkMethodList:e.getIn(["moduleManager","networkMethodList"]).toJS(),protocolList:e.getIn(["moduleManager","protocolList"]).toJS(),moduleTypeItems:e.getIn(["moduleManager","moduleTypeItems"]).toJS(),bindSceneList:e.getIn(["moduleManager","bindSceneList"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS(),dataLengthLimitList:e.getIn(["moduleManager","dataLengthLimitList"]).toJS()}},function(e){return{getAllModuleTypeList:function(t){var n=m.a.getAllModuleTypeList(t);e(n)},socRadioChangeAction:function(t){var n=m.a.socRadioChangeAction(t);e(n)},changeCurApi:function(t,n){var a=m.a.changeCurApi(t,n);e(a)}}})(s.a.create({name:"FunctionParamsForm",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0];if("sourceCode"!==n&&"libraryFile"!==n&&"burnFile"!==n&&"modulePicture"!==n&&"referenceCircuitDiagram"!==n&&"readmePdf"!==n){var a=Object.values(t)[0];e.changeCurApi(n,a.value)}}},mapPropsToFields:function(e){var t=e.moduleInfo,n={};return Object.keys(t).map(function(e){n[e]=s.a.createFormField({value:void 0!==t[e]&&null!==t[e]?t[e]:void 0})}),console.log("props--",n),n}})(U));n(1359);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=r.a.Step,Y=a.a.Meta,$=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=W(this,G(t).call(this,e))).next=function(){var e=n.state.current+1;n.setState({current:e})},n.prev=function(){var e=n.state.current-1;n.setState({current:e})},n.goBack=function(){n.props.history.goBack()},n.state={current:0},n}var n,l,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,o["Component"]),n=t,(l=[{key:"componentWillUnmount",value:function(){this.props.clearModuleInfo({})}},{key:"componentDidMount",value:function(){var e=this.props.brandItems,t=this.props.match.params;if(t&&t.moduleId&&(this.props.getModuleInfo(t.moduleId,"edit"),e&&0===e.length)){var n=this.props,a=n.getBindSceneList,r=n.getAllModuleBrandList,o=n.getModuleTypeMenuAction;r(),a(),o()}}},{key:"getCurStepContent",value:function(){return[{title:"基本参数",content:i.a.createElement(k,{changeCurrent:this.next,goBack:this.goBack})},{title:"功能参数",content:i.a.createElement(z,{changeCurrent:this.prev,goBack:this.goBack})}]}},{key:"render",value:function(){var e=this.getCurStepContent(),t=this.state.current;return i.a.createElement(o.Fragment,null,i.a.createElement(a.a,null,i.a.createElement(Y,{title:"添加模组",description:""})),i.a.createElement(a.a,{style:{marginTop:10}},i.a.createElement("div",null,i.a.createElement(r.a,{className:"antd-pro-pages-form-step-form-style-steps",current:t},e.map(function(e){return i.a.createElement(Q,{key:e.title,title:e.title})})),i.a.createElement("div",{className:"steps-content"},e[t].content))))}}])&&J(n.prototype,l),c&&J(n,c),t}();t.default=Object(d.b)(function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},clearModuleInfo:function(t){var n=m.a.moduleInfoChangeAcion(t);e(n)},getModuleInfo:function(t,n){var a=m.a.getModuleInfo(t,n);e(a)}}})($)},1418:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(29),n(437),n(28),n(65),n(40),n(41),n(45),n(37),n(46),n(22),n(74),n(790),n(31),n(30),n(32),n(206);var a=n(80),r=(n(71),n(21)),o=(n(165),n(10)),i=(n(241),n(118)),l=(n(279),n(152)),c=(n(92),n(33)),u=n(0),s=n.n(u),p=n(1347),f=n(287),d=(n(117),n(333),n(435),n(207),n(338),n(146)),m=(n(138),n(79)),y=(n(1317),n(1315)),h=(n(186),n(72)),b=(n(163),n(50));function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S,C=b.a.Item,j=h.a.Option,k=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=O(this,(e=w(t)).call.apply(e,[this].concat(o)))).handleFilterSubmit=function(){var e=n.props.form.getFieldsValue();n.props.filterSubmit(e)},n.reset=function(){n.props.form.resetFields()},n.getOptionList=function(e){if(!e)return[];var t=[];return e.map(function(e){t.push(s.a.createElement(j,{value:e.id,key:e.id},e.name))}),t},n.initFormList=function(){var e=n.props.form.getFieldDecorator,t=n.props.formList,a=[];return t&&t.length>0&&t.forEach(function(t,o){var i=t.label,l=t.field||"",c=t.initialValue||void 0,u=t.placeholder,p=t.width||120,f=t.onSelect,b=t.resetFields;if("DatePicker"===t.type){var g=s.a.createElement(C,{label:i,key:l},e(l)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));a.push(g);var E=s.a.createElement(C,{label:"~",colon:!1,key:l},e(l)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));a.push(E)}else if("Input"===t.type){var O=s.a.createElement(C,{label:i,key:l},e(l,{initialValue:c})(s.a.createElement(m.a,{style:{width:p},type:"text",placeholder:u,maxLength:20})));a.push(O)}else if("Select"===t.type){var w=s.a.createElement(C,{label:i,key:l},e(l,{initialValue:c})(s.a.createElement(h.a,{className:l,style:{width:p,marginBottom:0},placeholder:u,onChange:function(e){t.resetFields&&n.props.form.resetFields(v(b)),f&&f(e)}},n.getOptionList(t.list))));a.push(w)}else if("Checkbox"===t.type){var I=s.a.createElement(C,{label:i,key:l},e(l,{valuePropName:"checked",initialValue:c})(s.a.createElement(d.a,null,i)));a.push(I)}else if("Button"===t.type){var S=s.a.createElement(C,{key:l},s.a.createElement(r.a,{type:"primary",onClick:f},i));a.push(S)}}),a},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,s.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.node;return s.a.createElement(b.a,{layout:"inline"},this.initFormList(),s.a.createElement(C,null,s.a.createElement(r.a,{type:"primary",onClick:this.handleFilterSubmit},"查询")),s.a.createElement(C,null,s.a.createElement(r.a,{onClick:this.reset},"重置")),s.a.createElement(C,null,e))}}])&&E(n.prototype,a),o&&E(n,o),t}(),P=b.a.create({})(k),L=(n(164),n(1308),n(1307)),x=(n(443),n(104)),T=(n(1352),n(27));function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _(e,t,n,a,r,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(a,r)}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(n,!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=b.a.Item,z=h.a.Option,K=Object(x.g)(S=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=q(this,B(t).call(this,e))).categorySelect=function(e){n.setState({categoryId:e,subCategoryList:[]});n.props.form.resetFields([].concat(["subCategoryId","deviceTypeId"]));var t=n.props.allCategoryList,a=t.findIndex(function(t){return e===t.id});if(a>-1){var r=t[a];n.setState({subCategoryList:n.makeFormData(r.subCategoryList,"subCategoryName","subCategoryId")})}},n.subCategorySelect=function(e){n.setState({subCategoryId:e,deviceTypeList:[]}),n.props.form.resetFields("deviceTypeId");var t=n.state.subCategoryList,a=t.findIndex(function(t){return e===t.id});if(a>-1){var r=t[a];n.setState({deviceTypeList:n.makeFormData(r.deviceTypeList,"deviceTypeName","deviceTypeId")})}},n.threeCategorySelect=function(e){var t=n.state.deviceTypeList,a=t.findIndex(function(t){return e===t.id});if(a>-1){var r=t[a];console.log("三级菜单选择后：",r);var o=e,i=r.defaultDeviceSubtype.deviceSubtypeId;n.setState({deviceTypeId:o,deviceSubtypeId:i}),console.log("三级菜单选择后：deviceSubtypeId ===",i)}n.getProtocol(e)},n.makeFormData=function(e,t,n){var a=[];return console.log("data ===",e),e.map(function(e){var r=R({},e,{id:e[n],name:e[t]});a.push(r)}),a},n.getProtocol=function(e){var t={deviceTypeId:e};Object(f.f)(t).then(function(e){var t=e.data;0===t.code&&n.setState({protocoloList:n.makeFormData(t.data,"templateName","templateNumber")})})},n.handleChange=function(e){console.log("----info.file---",e.file),"error"===e.file.status?(l.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),n.setState({fileList:e.fileList})},n.showModal=function(){n.setState({visible:!0,iconLoading:!1})},n.handleOk=function(e){var t=n.state,a=t.fileList,r=t.deviceTypeId,o=t.deviceSubtypeId,i={};a.length<=0?l.a.warning("请上传模板图片!"):(a.map(function(e,t){"done"===e.status&&(i["page".concat(t+1)]=e.response.data.url)}),n.props.form.validateFields(function(e,t){if(!e){t.status=0,delete t.templatePicList,delete t.categoryId,delete t.subCategoryId,Object.assign(t,i);var a=R({},t,{},i,{deviceTypeId:r,deviceSubtypeId:o});n.setState({iconLoading:!0}),Object(p.e)(a).then(function(e){var t=e.data;if(0===t.code){n.setState({visible:!1,iconLoading:!1});var a=t.data.templateId;l.a.success("恭喜您，模板已创建成功！我们将进入自助接入系统",3,n.handleMessageClose(a))}}).finally(function(){n.setState(function(){return{iconLoading:!1}})})}}))},n.handlePreview=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,n.getBase64(t.originFileObj);case 3:t.preview=e.sent;case 4:n.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){_(o,a,r,i,l,"next",e)}function l(e){_(o,a,r,i,l,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),n.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},n.handleMessageClose=function(e){var t=window.location.host,n="",a="";"cms.clife.cn"===t?(n="open.clife.cn",a=""):"pre.cms.clife.cn"===t?(n="pre.cms.clife.cn",a="/pre-wCloud-v2"):(n="dp.clife.net",a="/wCloud_v2");var r="https://"+n+a+"/app-developer/page/playground.html#/develop/edit/"+e+"?platform=1&operate=edit";window.open(r,"_self")},n.handleCancel=function(e){n.setState({visible:!1,fileList:[]}),n.props.form.resetFields("templatePicList"),n.props.form.resetFields()},n.handleCancelPreview=function(){n.setState({previewVisible:!1})},n.textareaChange=function(e){e.target.value.length>=500&&l.a.warning("最大支持输入500个字符",1)},n.getOptionList=function(e){if(!e)return[];var t=[];return e.map(function(e){t.push(s.a.createElement(z,{value:e.id,key:e.id},e.name))}),t},n.state={fileList:[],visible:!1,previewVisible:!1,previewImage:"",subCategoryList:[],deviceTypeList:[],protocoloList:[],categoryId:"",subCategoryId:"",deviceTypeId:"",deviceSubtypeId:""},n}var n,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,u["Component"]),n=t,(a=[{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||l.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||l.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:T.j,data:function(e){return{appId:31438,domainType:4}}},t=this.props,n=t.form,a=t.allCategoryList,l=n.getFieldDecorator,c=s.a.createElement("div",null,s.a.createElement(o.a,{type:"plus"}),s.a.createElement("div",{className:"ant-upload-text"},"Upload")),u=this.state,p=u.subCategoryList,f=u.deviceTypeList,d=u.protocoloList;return u.fileList,s.a.createElement("div",null,s.a.createElement(r.a,{type:"primary",onClick:this.showModal},"新建H5模板"),s.a.createElement(i.a,{width:800,title:"新建H5模板",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,cancelText:"取消",okText:"创建",confirmLoading:this.state.iconLoading,destroyOnClose:!0},s.a.createElement(b.a,D({},{labelCol:{span:6},wrapperCol:{span:15}},{className:"CreataH5Template_from"}),s.a.createElement(U,{label:"模板名称"},l("templateName",{rules:[{required:!0,message:"模板名称不能为空"}]})(s.a.createElement(m.a,{allowClear:!0,type:"text",placeholder:"请输入您喜欢的模板名称",maxLength:20}))),s.a.createElement(b.a.Item,{className:"chooseProduct",label:"所属分类"},s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",l("categoryId",{rules:[{required:!0,message:"请您选择一级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"一级类目",onChange:this.categorySelect},this.getOptionList(a)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",l("subCategoryId",{rules:[{required:!0,message:"请您选择二级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"二级类目",onChange:this.subCategorySelect},this.getOptionList(p)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",l("deviceTypeId",{rules:[{required:!0,message:"请您选择三级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"三级类目",onChange:this.threeCategorySelect},this.getOptionList(f))))),s.a.createElement(U,{label:"调取协议"}," ",l("templateNumber",{rules:[{required:!0,message:"请您选择协议"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择协议"},this.getOptionList(d)))),s.a.createElement(U,{label:"性质"},l("isFree",{rules:[{required:!0,message:"请您选择性质"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择"},s.a.createElement(z,{value:"1"},"免费")))),s.a.createElement(U,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"},l("templatePicList",{rules:[{required:!0,message:"请上传一张图片"}]})(s.a.createElement("div",{className:"product-div"},s.a.createElement(L.a,D({},e,{accept:"image/png,image/jpeg",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),this.state.fileList.length>=5?null:c),s.a.createElement(i.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},s.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),s.a.createElement(U,{label:"描述"},l("remark",{})(s.a.createElement(m.a.TextArea,{onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))))))}}])&&F(n.prototype,a),c&&F(n,c),t}())||S,J=b.a.create()(K),W=(n(1360),n(96));function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var te=c.a.Meta,ne=[{title:"模板信息",icon:"info",status:0,key:0},{title:"编辑",icon:"edit",status:0,key:1},{title:"发布",icon:"cloud-upload",status:0,key:2},{title:"删除",icon:"delete",status:0,key:3}],ae=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=X(this,Z(t).call(this,e))).getH5TemplateList=function(e){n.setState({loading:!0,oldParams:e}),Object(p.d)(e).then(function(e){var t=e.data;0===t.code&&n.setState(function(){return{h5TemplateList:n.makeAntTableData(t.data),pager:t.data.pager}})}).finally(function(){n.setState(function(){return{loading:!1}})})},n.getAllCategoryList=function(){Object(f.a)().then(function(e){var t=e.data;0===t.code&&n.setState({allCategoryList:n.makeFormData(t.data,"categoryName","categoryId")})})},n.h5Publish=function(e){Object(p.b)({templateId:e.templateId,status:e.status?0:1}).then(function(t){if(0===t.data.code){var a=e.status?"撤销成功！":"发布模板成功！";l.a.success(a,2).then(n.getH5TemplateList(n.state.oldParams))}})},n.h5Del=function(e){Object(p.a)({templateId:e.templateId}).then(function(e){if(0===e.data.code){l.a.success("删除模板成功！",2).then(n.getH5TemplateList(n.state.oldParams))}})},n.editTemplate=function(e){if(1!==e.status){var t=window.location.host;console.log(n.props);var a="",r="";"cms.clife.cn"===t?(a="open.clife.cn",r=""):"pre.cms.clife.cn"===t?(a="pre.cms.clife.cn",r="/pre-wCloud-v2"):(a="dp.clife.net",r="/wCloud_v2");var o="https://"+a+r+"/app-developer/page/playground.html#/develop/edit/"+e.templateId+"?platform=1&operate=edit";window.open(o,"_self")}else l.a.warning('对不起！模板"'+e.templateName+'" 是发布状态，禁止编辑',3)},n.makeFormData=function(e,t,n){var a=[];return e.map(function(e){var r=Q({},e,{id:e[n],name:e[t]});a.push(r)}),a},n.categorySelect=function(e){n.setState({categoryId:e,subCategoryList:[]});var t=n.state.allCategoryList,a=t.findIndex(function(t){return e===t.id});if(a>-1){var r=t[a];console.log("一级菜单选择后：",r),n.setState({subCategoryList:n.makeFormData(r.subCategoryList,"subCategoryName","subCategoryId")})}},n.subCategorySelect=function(e){n.setState({subCategoryId:e,deviceTypeList:[]});var t=n.state.subCategoryList,a=t.findIndex(function(t){return e===t.id});if(a>-1){var r=t[a];console.log("二级菜单选择后：",r),n.setState({deviceTypeList:n.makeFormData(r.deviceTypeList,"deviceTypeName","deviceTypeId")})}},n.handleDelete=function(e,t){switch(t.key){case 0:n.props.history.push({pathname:"/config/h5template/info/".concat(e.templateId)});break;case 1:n.editTemplate(e);break;case 2:i.a.confirm({title:"确认",okText:"确定",cancelText:"取消",content:e.status?"点击确定将模板从模板市场撤销发布并保存为草稿":"点击确定后将同步到模板市场并对用户可见，点击取消可取消发布。",onOk:function(){n.h5Publish(e)}});break;case 3:i.a.confirm({title:"确认",okText:"确定",okType:"danger",cancelText:"取消",content:e.status?"点击确定将从模板管理页面删除模板，点击取消返回。":"点击确定将模板从模板管理页面和模板市场同时删除，点击取消返回",onOk:function(){n.h5Del(e)}})}},n.filterSubmit=function(e){var t=Q({},n.state.oldParams,{deviceTypeId:e.deviceTypeId,status:e.status,nature:e.nature,templateName:e.templateName});for(var a in t){if(t.hasOwnProperty(a))t[a]||delete t[a]}n.getH5TemplateList(t)},n.paginationChange=function(e){console.log("分页选择了：",e);var t=Q({},n.state.oldParams,{pageIndex:e});console.log(t),n.getH5TemplateList(t),document.querySelector(".ant-table-body").scrollTop=0},n.makeAntTableData=function(e){var t=[];return e.list.map(function(e,n){t.push(Q({},e,{key:e.templateId}))}),t},n.state={h5TemplateList:[],loading:!1,oldParams:{},allCategoryList:[],subCategoryList:[],deviceTypeList:[],categoryId:"",subCategoryId:"",pager:{}},n}var n,d,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(t,u["Component"]),n=t,(d=[{key:"componentWillMount",value:function(){this.getH5TemplateList({pageRows:10,sort:"modifyTime",order:"desc"}),this.getAllCategoryList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.allCategoryList,i=t.subCategoryList,l=t.deviceTypeList,u=(t.pagination,t.loading),p=t.h5TemplateList,f=t.pager,d=[{type:"Input",label:"关键字",field:"templateName",placeholder:"请输入模板名称",width:260},{type:"Select",label:"所属分类",field:"categoryId",placeholder:"一级类目",list:n,onSelect:this.categorySelect,resetFields:["subCategoryId","deviceTypeId"],width:140},{type:"Select",label:"",field:"subCategoryId",placeholder:"二级类目",list:i,onSelect:this.subCategorySelect,resetFields:["deviceTypeId"],width:140},{type:"Select",label:"",field:"deviceTypeId",placeholder:"三级类目",list:l,width:140},{type:"Select",label:"状态",field:"status",placeholder:"请选择",list:[{id:"0",name:"未发布"},{id:"1",name:"已发布"}],width:140},{type:"Select",label:"性质",field:"nature",placeholder:"请选择",list:[{id:"1",name:"免费"}],width:140}],m=[{title:"模板名称-CN",width:"15%",key:"templateName",dataIndex:"templateName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"所属分类",width:"15%",key:"allCategoryName",dataIndex:"allCategoryName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"二维码",width:"8%",key:"qrcode",dataIndex:"qrcode",render:function(e){var t=e?s.a.createElement("img",{className:"codeimg",src:e}):"二维码生成中";return s.a.createElement("div",{className:"td-qrcode"},s.a.createElement(o.a,{type:"barcode",className:"s-qrcode"}),s.a.createElement("div",{className:"hovershow"},s.a.createElement("span",{className:"leftarrow"}),t))}},{title:"性质",width:"80px",key:"isFree",dataIndex:"isFree",render:function(e){return 1===e?"免费":""}},{title:"状态",width:"80px",key:"status",dataIndex:"status",render:function(e){var t=1===e?"已发布":"未发布";return s.a.createElement("span",{title:t,style:{color:"".concat(["red","gray"][e])}},t)}},{title:"更新时间",width:"12%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=T.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return s.a.createElement("span",{title:t},t)}},{title:"操作",width:"13%",key:"operation",dataIndex:"operation",render:function(t,n){return s.a.createElement("div",null,ne.map(function(t,o){return s.a.createElement(a.a,{key:o,placement:"top",title:2===t.key&&1===n.status?"下线":t.title},s.a.createElement(r.a,{style:{marginLeft:"5px"},shape:"circle",size:"small",icon:2===t.key&&1===n.status?"cloud-download":t.icon,key:n.templateId,onClick:function(){return e.handleDelete(n,t)}}))}))}}];return s.a.createElement("div",{className:"H5TemplateContent"},s.a.createElement(c.a,null,s.a.createElement(te,{title:"H5模板",description:"",style:{marginBottom:10}}),s.a.createElement(P,{formList:d,filterSubmit:this.filterSubmit,node:s.a.createElement(J,{allCategoryList:n})})),s.a.createElement(c.a,{className:"H5TemplateTable"},s.a.createElement(W.a,{rowKey:"id",bordered:!0,columns:m,dataSource:p,pager:f,onPageChange:this.paginationChange,loading:u})))}}])&&$(n.prototype,d),m&&$(n,m),t}();t.default=ae},1420:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(28),n(164),n(45),n(46),n(22),n(31),n(32),n(92);var a,r=n(33),o=(n(206),n(80)),i=(n(71),n(21)),l=n(0),c=n.n(l),u=n(39),s=(n(138),n(79)),p=(n(792),n(446)),f=(n(163),n(50)),d=(n(186),n(72)),m=n(1),y=n.n(m),h=n(287),b=n(12);n(1350);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}d.a.Option;var I=Object(u.b)(function(e){var t=e.getIn(["globalDeviceInfo","deviceType"]);return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceType:t,deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}})(a=f.a.create({name:"horizontal_pannel"})(a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=E(this,O(t).call(this,e))).state={deviceSubType:[]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,l["Component"]),n=t,(a=[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){if(!e){console.log(n);var a=n.deviceTypeSelect,r=n.templateName;if(a&&3==a.length){var o=a[2];t.props.filterPannelOperation({deviceTypeId:o,templateName:r})}else t.props.filterPannelOperation({templateName:r})}})}},{key:"deviceTypeSelect",value:function(e){var t=this;Object(h.c)({deviceTypeId:e}).then(function(e){if(e.data.code===b.a){var n=e.data.data;t.props.form.resetFields(["deviceSubType"]),t.setState({deviceSubType:n})}})}},{key:"deviceSubTypeSelect",value:function(e){console.log("deviceSubTypeSelect: "+e)}},{key:"resetContent",value:function(){this.props.form.resetFields(),this.props.filterPannelOperation({deviceTypeId:void 0})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=(this.props.deviceCategoryList,this.props.deviceCascaderList);return c.a.createElement("div",null,c.a.createElement(f.a,{layout:"inline",onSubmit:this.handleSubmit.bind(this)},c.a.createElement(f.a.Item,{label:"所属分类"},e("deviceTypeSelect")(c.a.createElement(p.a,{options:t,placeholder:"请选择所属分类",style:{width:260}}))),c.a.createElement(f.a.Item,{label:"模板名称"},e("templateName")(c.a.createElement(s.a,{type:"text",onChange:this.handleNumberChange,style:{width:200},placeholder:"输入模板名称"}))),c.a.createElement(f.a.Item,null,c.a.createElement(i.a,{type:"primary",htmlType:"submit"},"查询"),c.a.createElement("span",null," "),c.a.createElement(i.a,{type:"primary",onClick:this.resetContent.bind(this)},"重置"))))}}])&&v(n.prototype,a),r&&v(n,r),t}())||a)||a;I.prototype={filterPannelOperation:y.a.func};var S,C=I,j=n(1353),k=n(27),P=n(104),L=n(96);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=Object(P.g)(S=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=N(t).call(this,e),(n=!r||"object"!==x(r)&&"function"!=typeof r?D(a):r).tableColumn=[{title:"模板ID",dataIndex:"protocolTemplateId",key:"protocolTemplateId",width:"75px"},{title:"模板名称",dataIndex:"templateName",key:"templateName",width:"20%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"语言版本",dataIndex:"language",key:"language",width:"9%",render:function(e){return c.a.createElement("span",null,0===e?"中文":"英文")}},{title:"所属分类",dataIndex:"allCategoryName",key:"allCategoryName",width:"28%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"templateStatus",key:"templateStatus",width:"10%",render:function(e){return c.a.createElement("span",null,1===e?"正式":"草稿")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=k.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return c.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"修改时间",dataIndex:"updateTime",key:"updateTime",width:"15%",render:function(e){var t=k.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return c.a.createElement("span",{className:"td-break",title:t},t)}},{title:"操作",dataIndex:"templateNumber",key:"operation",width:"100px",fixed:"right",render:function(e){return c.a.createElement(o.a,{placement:"top",title:"编辑"},c.a.createElement(i.a,{onClick:n.editProtocolTemp.bind(D(n),e),icon:"edit",shape:"circle",size:"small"}))}}],n.state={tableDataSources:[],pageRows:10,currentPage:0,totalRows:0,isLoading:!1,searchParams:{},pager:{}},n}var n,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,l["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:this.state.currentPage})}},{key:"getProtocolTemplateList",value:function(e){var t=this;this.setState({isLoading:!0}),e=Object.assign({},this.state.searchParams,e),e=k.d.filterParam(e),Object(j.c)(e).then(function(e){if(t.setState({isLoading:!1}),e.data.code===b.a){var n=e.data.data.list,a=e.data.data.pager;t.setState({tableDataSources:n,totalRows:a.totalRows,currentPage:a.pageIndex,pager:a})}}).catch(function(){t.setState({isLoading:!1})})}},{key:"handleFilter",value:function(e){console.log("Receve values of form:",e),this.setState({searchParams:e});var t={pageRows:this.state.pageRows,sort:"modifyTime",order:"desc",deviceTypeId:e.deviceTypeId,templateName:e.templateName,pageIndex:0};this.getProtocolTemplateList(t)}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({currentPage:e}),this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:e})}},{key:"addTemplate",value:function(){this.props.history.push("/config/protocoltemplate/add")}},{key:"editProtocolTemp",value:function(e){this.props.history.push({pathname:"/config/protocoltemplate/edit/".concat(e)})}},{key:"render",value:function(){var e=this.tableColumn,t=this.state.tableDataSources;return this.state.totalRows,c.a.createElement("div",null,c.a.createElement(r.a,null,c.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold"}},"协议模板"),c.a.createElement(C,{filterPannelOperation:this.handleFilter.bind(this)}),c.a.createElement("div",{style:{marginTop:"20px"}},c.a.createElement(i.a,{type:"primary",onClick:this.addTemplate.bind(this)},"新增协议模板"))),c.a.createElement(r.a,{style:{marginTop:"10px"}},c.a.createElement(L.a,{bordered:!0,columns:e,dataSource:t,rowKey:"protocolTemplateId",loading:this.state.isLoading,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,scroll:{x:1200,y:"auto"}})))}}])&&T(n.prototype,a),u&&T(n,u),t}())||S,R=Object(u.b)(function(e){return{deviceType:e.getIn(["globalDeviceInfo","deviceType"])}})(M);t.default=R},1421:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(117),n(29),n(28),n(334),n(65),n(435),n(164),n(40),n(41),n(45),n(37),n(46),n(22),n(31),n(242),n(243),n(30),n(32),n(92);var a=n(33),r=(n(1308),n(1307)),o=(n(71),n(21)),i=(n(436),n(168)),l=(n(338),n(146)),c=(n(138),n(79)),u=(n(165),n(10)),s=(n(279),n(152)),p=(n(139),n(44)),f=(n(186),n(72)),d=(n(163),n(50)),m=n(0),y=n.n(m),h=n(39),b=n(104),g=n(73),v=n(287),E=n(1353),O=n(12),w=(n(337),n(187)),I=(n(282),n(105));n(1361);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function j(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L,x,T,N=I.a.TabPane,D=[{id:1,name:"字符"},{id:2,name:"数值"},{id:3,name:"枚举"},{id:4,name:"布尔"},{id:5,name:"绝对时间"},{id:6,name:"相对时间"},{id:7,name:"循环时间"},{id:8,name:"RGB颜色"},{id:9,name:"二进制"},{id:10,name:"数组"},{id:11,name:"结构体"}],_=[{title:"协议属性(key)",dataIndex:"mark"},{title:"协议属性名",dataIndex:"describe"},{title:"数据单位",dataIndex:"propertyValueType",width:"90px"},{title:"数据类型",dataIndex:"functionDataType",width:"100px",render:function(e){return e?D[e-1].name:y.a.createElement("span",null,"LONG")}},{title:"字节数",dataIndex:"length",width:"90px"},{title:"数据属性",ellipsis:!0,dataIndex:"dataProperty",render:function(e,t,n){var a="";if(10==t.functionDataType){var r=t.extend||[],o=D[r[0].functionDataType-1].name;a="".concat(r.length,"个").concat(o,"型元素")}else if(11==t.functionDataType){(t.extend||[]).map(function(e,t){var n=e.gap,r=e.mulriple,o=e.unit,i=e.range;a+="数值范围：".concat(i||"--",", 间距：").concat(n||"--",", 倍数：").concat(r||"--",", 单位：").concat(o||"--")})}else{var i=t.gap,l=t.mulriple,c=t.unit,u=t.range;a="数值范围：".concat(u||"--",", 间距：").concat(i||"--",", 倍数：").concat(l||"--",", 单位：").concat(c||"--")}return y.a.createElement("span",{key:"dataProperty"+n},a)}},{title:"是否保留字",dataIndex:"ignore",width:"110px",render:function(e){return y.a.createElement("span",null,e?"是":"否")}}],M=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=j(this,k(t).call(this,e))).state={controlList:[],runList:[],errList:[],configList:[]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,m["Component"]),n=t,(a=[{key:"filterPannel",value:function(){var e=this.props.protocolList||{},t=e.control||[],n=e.run||[],a=e.fault||[],r=e.config||[];return{dataSource:t.concat(n,a,r),controlList:t,runList:n,errList:a,configList:r}}},{key:"render",value:function(){var e=this.filterPannel(),t=e.dataSource,n=e.controlList,a=e.runList,r=e.errList,o=e.configList;return y.a.createElement(I.a,{animated:!1,className:"protocoltable"},y.a.createElement(N,{tab:"全部",key:"0"},y.a.createElement(w.a,{tableLayout:"fixed",bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:_,dataSource:t,pagination:!1})),y.a.createElement(N,{tab:"控制数据",key:"1"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:_,dataSource:n,pagination:!1})),y.a.createElement(N,{tab:"运行数据",key:"2"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:_,dataSource:a,pagination:!1})),y.a.createElement(N,{tab:"故障数据",key:"3"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:_,dataSource:r,pagination:!1})),y.a.createElement(N,{tab:"配置数据",key:"4"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:_,dataSource:o,pagination:!1})))}}])&&C(n.prototype,a),r&&C(n,r),t}(),R=n(1350),A=n(27);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function z(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var W=d.a.Item,G=(f.a.Option,L=Object(h.b)(function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}}),x=d.a.create({name:"template"}),L(T=Object(b.g)(T=x(T=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=z(this,K(t).call(this,e))).handeleUpdate=function(e){e.protocolTemplateId=n.state.protocolTemplateId,Object(E.d)(e).then(function(e){n.props.history.push("/config/protocoltemplate/list")})},n.handleAdd=function(e){Object(E.b)(e).then(function(e){n.props.history.push("/config/protocoltemplate/list")})},n.handleSubmit=function(e){e.preventDefault(),n.props.form.validateFieldsAndScroll(function(e,t){if(!e){if(!t.deviceTypeSelect||!t.deviceTypeSelect.deviceTypeId)return void p.a.warn({message:"提示",description:"请选择设备类型"});var a=t.deviceTypeSelect.deviceTypeId||"",r=t.deviceTypeSelect.deviceSubTypeId||"",o={templateName:t.templateName||"",deviceTypeId:a,deviceSubtypeId:r,templateStatus:t.templateStatus,remark:t.remark||"",language:t.language,bindTypeIds:t.bindTypeIds.join(",")};n.state.templateId&&(o.tempId=n.state.templateId),o=A.d.filterParam(o),n.state.isEdit?n.handeleUpdate(o):n.handleAdd(o)}})},n.state={isEdit:!1,templateNumber:"0",bindTypeList:[],protocolTempList:[],protocolTemplateId:"",templateId:null,bindTypeIds:[],templateName:"",deviceTypeId:void 0,deviceSubtypeId:void 0,templateStatus:"",remark:"",language:""},n}var n,f,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,m["Component"]),n=t,(f=[{key:"checkDeviceTypeSelect",value:function(e,t,n){t.deviceTypeId&&t.deviceSubTypeId?n():n("请选择设备分类")}},{key:"componentDidMount",value:function(){var e=this;Object(v.b)().then(function(t){if(t.data.code===O.a){var n=t.data.data;n?e.setState({bindTypeList:n}):p.a.warn({message:"提示",description:"获取数据字段为空"})}});var t=this.props.match.params;if(t&&t.templateNumber){this.setState({isEdit:!0,templateNumber:t.templateNumber});var n=t.templateNumber;Object(E.a)(n).then(function(t){if(t.data.code===O.a){var n=t.data.data,a=(n.bindTypeIds||"").split(",");a=a.map(function(e){return+e}),e.setState({templateName:n.templateName||"",deviceTypeId:n.deviceTypeId||"",deviceSubtypeId:n.deviceSubtypeId||"",catagoryId:n.categoryId||"",subCategoryId:n.subCategoryId||"",templateStatus:n.templateStatus+"",templateNumber:n.templateNumber,remark:n.remark||"",language:n.language+"",protocolTempList:n.map||[],protocolTemplateId:n.protocolTemplateId||"",bindTypeIds:a||[]})}})}}},{key:"handelUploadFile",value:function(e){if(console.log("info.file---",e.file),e.file.status,"done"===e.file.status){var t=e.file.response;if(t.code===O.a){var n=t.data;this.setState({protocolTempList:n.map,templateId:n.tempId}),s.a.success("".concat(e.file.name," 文件上传成功， 文件ID： ").concat(t.data.tempId))}else{var a=t.data;s.a.error("".concat(e.file.name," 文件上传失败， 原因： ").concat(a),10)}}else"error"===e.file.status&&s.a.error("".concat(e.file.name," 文件上传失败"))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.isEdit||!1,n=this.state.bindTypeList,s=this.props.deviceCategoryList||[],p=this.state,f=p.bindTypeIds,m=p.templateName,h=p.deviceTypeId,b=p.deviceSubtypeId,v=p.catagoryId,E=p.subCategoryId,O=p.templateStatus,w=p.remark,I=p.language,S={initialValue:{categoryId:v,subCategoryId:E,deviceTypeId:h,deviceSubTypeId:b}};return y.a.createElement("div",null,y.a.createElement(a.a,null,y.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},y.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},t?"编辑协议模板":"新增协议模板"),y.a.createElement("div",null,y.a.createElement(g.b,{to:"/config/protocoltemplate/list",style:{padding:"10px"}},y.a.createElement(u.a,{type:"left"})," 返回"))),y.a.createElement(d.a,q({},{labelCol:{span:2},wrapperCol:{span:22}},{onSubmit:this.handleSubmit}),y.a.createElement(W,{label:"模板名称"},e("templateName",{initialValue:m,rules:[{required:!0,message:"模板名称不能为空"}]})(y.a.createElement(c.a,{maxLength:30,type:"text",style:{width:"300px"},placeholder:"请输入您喜欢的模板名称"}))),y.a.createElement(W,{label:"所属分类"},e("deviceTypeSelect",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){V(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},S,{rules:[{required:!0,message:"请选择所属分类",validator:this.checkDeviceTypeSelect.bind(this)}]}))(y.a.createElement(R.a,{deviceCategoryList:s}))),y.a.createElement(W,{label:"技术方案"},e("bindTypeIds",{initialValue:f,rules:[{required:!0,message:"请您选择技术方案"}]})(y.a.createElement(l.a.Group,null,n.map(function(e){return y.a.createElement(l.a,{value:e.bindTypeId,key:e.bindTypeName},e.bindTypeName)})))),y.a.createElement(d.a.Item,{label:"语言版本"},e("language",{rules:[{required:!0,message:"请选择语言版本"}],initialValue:I})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"0",key:"0"},"中文"),y.a.createElement(i.a,{value:"1",key:"1"},"英文")))),y.a.createElement(d.a.Item,{label:"状态"},e("templateStatus",{rules:[{required:!0,message:"请选择发布状态"}],initialValue:O})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"1",key:"1"},"正式"),y.a.createElement(i.a,{value:"0",key:"0"},"草稿")))),y.a.createElement(W,{label:"模板设置"},e("tempId",{rules:[{required:!t,message:"选择模板"}]})(y.a.createElement("div",null,y.a.createElement(r.a,{name:"uploadJson",showUploadList:!1,action:"/v1/web/manage-open/protocol/template/importJson",onChange:this.handelUploadFile.bind(this),accept:".json"},y.a.createElement(o.a,null,y.a.createElement(u.a,{type:"upload"})," 选择模板")),y.a.createElement("div",null,"（仅支持导入json文件类型，文件扩展名：.json，",y.a.createElement("a",{href:"/v1/web/manage-open/protocol/template/download",style:{color:"#27a9e3"}},"下载模板范本"),"）")))),y.a.createElement(W,{label:"备注"},e("remark",{initialValue:w})(y.a.createElement(c.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容",maxLength:100}))),y.a.createElement(W,{label:"数据分类"},y.a.createElement(M,{protocolList:this.state.protocolTempList})),y.a.createElement(o.a,{htmlType:"submit",style:{float:"right"}},"提交"))))}}])&&U(n.prototype,f),h&&U(n,h),t}())||T)||T)||T);t.default=G},1423:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(117),n(333),n(28),n(45),n(46),n(22),n(31),n(32),n(92);var a=n(33),r=n(0),o=n.n(r),i=n(39),l=(n(1355),n(65),n(435),n(1321),function(e){var t=e.list,n=e.type,a=e.active,r=e.name,i=e.id,l=e.onChange,c=e.sub;if(0==t.length)return null;var u=t.reduce(function(e,t){return e[r].length>t[r].length?e:t},t[0]);return o.a.createElement("div",{style:{display:"block",position:"relative",minWidth:"1200px"}},o.a.createElement("div",{className:"list-category",style:{height:"".concat("top"==n?36*u[r].length:36*u[r].length+40,"px")}},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,"top"!==n?o.a.createElement("span",{className:"line-horizontal"}):null,t.map(function(e,t){return o.a.createElement("div",{className:"list-item ".concat(t==a&&c&&c.length>0?"active":""),onClick:function(){return"function"==typeof l?l(t):null},key:t},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,o.a.createElement("div",{className:"list-name"},o.a.createElement("span",null,"".concat(e[r]),o.a.createElement("br",null),o.a.createElement("b",{className:"list-num"},"(",e[i],")"))))}),void 0!==a&&c&&c.length>0?o.a.createElement("span",{className:"line-horizontal bottom ".concat(a>=t.length/2?"left":"right"),style:{width:56*Math.abs((t.length+1)/2-a-1)}}):null))});function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return a=this,r=(e=s(t)).call.apply(e,[this].concat(i)),(n=!r||"object"!==c(r)&&"function"!=typeof r?p(a):r).state={first:0,second:0},n.changeState=function(e){var t=p(n);return function(n){var a,r,o;console.log(n),"first"==e&&t.setState({second:0}),t.setState((o=n,(r=e)in(a={})?Object.defineProperty(a,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[r]=o,a))}},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.state,t=e.first,n=e.second,r=this.props.allCategoryList,i=Array.from(r)||[],c=i[t]&&i[t].subCategoryList||[],u=c[n]&&c[n].deviceTypeList||[];return o.a.createElement("div",null,o.a.createElement(a.a,null,o.a.createElement(a.a.Meta,{title:"产品类目",description:"硬件产品的形态分类，开放平台接入产品，终端APP绑定设备时可获取类目数据。"})),o.a.createElement("div",{className:"product-categroy"},o.a.createElement("div",{style:{display:"inline-block"}},o.a.createElement(l,{type:"top",list:i,sub:c,active:t,name:"categoryName",id:"categoryId",onChange:this.changeState("first")}),o.a.createElement(l,{list:c,sub:u,active:n,name:"subCategoryName",id:"subCategoryId",onChange:this.changeState("second")}),o.a.createElement(l,{list:u,name:"deviceTypeName",id:"deviceTypeId"}))))}}])&&u(n.prototype,r),i&&u(n,i),t}();t.default=Object(i.b)(function(e){return{allCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"])}})(d)},1424:function(e,t,n){"use strict";n.r(t);n(20),n(35),n(36),n(29),n(28),n(65),n(40),n(41),n(45),n(37),n(46),n(22),n(74),n(790),n(31),n(30),n(32),n(163);var a=n(50),r=(n(138),n(79)),o=(n(206),n(80)),i=(n(71),n(21)),l=(n(241),n(118)),c=(n(92),n(33)),u=(n(186),n(72)),s=n(0),p=n.n(s),f=n(104),d=n(39),m=n(447),y=n(27),h=n(197),b=(n(337),n(187)),g=(n(285),n(61));n(1356);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S,C=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=O(this,w(t).call(this,e))).handleCancel=function(){n.props.viewModuleInfoCancle(!1)},n.handlePreview=function(){var e=n.props.moduleInfo;n.setState({previewImage:e.historyObj.referenceCircuitDiagram,previewVisible:!0})},n.handleCancelPreview=function(){n.setState({previewVisible:!1})},n.getDataSource=function(e){return 0===e.supportSocProject?[{key:"1",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]:[{key:"1",fileType:"源码",fileName:e.sourceCodeName,version:""+e.sourceCodeVersion,fileUrl:e.historyObj.sourceCode},{key:"2",fileType:"库文件",fileName:e.libraryFileName,version:""+e.libraryFileVersion,fileUrl:e.historyObj.libraryFile},{key:"3",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]},n.state={previewVisible:!1,previewImage:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,s["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.moduleInfo,a=[{title:"模板文件",key:"fileType",dataIndex:"fileType"},{title:"文件名",key:"fileName",dataIndex:"fileName",render:function(e,t){return console.log("=====",t),p.a.createElement("a",{href:t.fileUrl,target:"_blank"},e)}},{title:"版本号",key:"version",dataIndex:"version"}],r=this.getDataSource(n);return p.a.createElement("div",null,p.a.createElement(l.a,{style:{top:20},width:800,title:"查看模组",visible:t,onCancel:this.handleCancel,footer:this.state.status?[p.a.createElement(i.a,{key:"back",onClick:this.handleCancel},"取消"),p.a.createElement(i.a,{key:"submit",type:"primary",onClick:this.handleOk},"确定")]:null},p.a.createElement(g.a,{title:"基础信息",size:"small"},p.a.createElement(g.a.Item,{label:"生产厂家",span:2},n.brandName),p.a.createElement(g.a.Item,{label:"模组所属库",span:2},n.moduleAffiliation),p.a.createElement(g.a.Item,{label:"模组型号",span:2},n.hetModuleTypeName),p.a.createElement(g.a.Item,{label:"模组IC型号",span:2},n.originalModuleTypeName),p.a.createElement(g.a.Item,{label:"使用范围",span:2},n.applyScope)),p.a.createElement(g.a,{title:"审核内容",size:"small"},p.a.createElement(g.a.Item,{label:"通信方式",span:2},n.moduleTypeNameList),p.a.createElement(g.a.Item,{label:"配网方式",span:2},n.networkTypeNameList),p.a.createElement(g.a.Item,{label:"支持协议",span:2},n.supportProtocolTypeName),p.a.createElement(g.a.Item,{label:"支持文件传输",span:2},0===n.supportFileTransfer?"否":"是"),p.a.createElement(g.a.Item,{label:"通信速率",span:2},n.communicateSpeed),p.a.createElement(g.a.Item,{label:"支持SOC方案",span:2},0===n.supportSocProject?"否":"是"),p.a.createElement(g.a.Item,{label:"数据上限",span:4},n.dataLengthLimitName)),p.a.createElement(g.a.Item,null,p.a.createElement(b.a,{bordered:!0,columns:a,dataSource:r,size:"small",pagination:!1})),p.a.createElement(g.a,{title:"说明文档",size:"small",style:{marginTop:10}},p.a.createElement(g.a.Item,{label:"参考电路",span:4},p.a.createElement("div",{className:"ReferenceCircuitPic",style:{background:"url("+n.historyObj.referenceCircuitDiagram+") no-repeat center / contain",border:"1px solid #1890ff"},onClick:this.handlePreview}," "),p.a.createElement(l.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},p.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))),p.a.createElement(g.a.Item,{label:"说明文档",span:4},p.a.createElement("a",{href:n.historyObj.readmePdf,target:"_blank"},n.readmePdfName)))))}}])&&E(n.prototype,a),r&&E(n,r),t}(),j=(n(1357),n(96));function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach(function(t){x(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=u.a.Option,R=c.a.Meta,A=l.a.confirm,F=Object(f.g)(S=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=N(this,D(t).call(this,e))).getModuleList=function(e){n.setState({loading:!0,oldparams:e}),Object(h.h)(e).then(function(e){if(0===e.data.code){var t=e.data.data.list;t.map(function(e,t){e.key=e.moduleId});var a=y.e.pagination(e.data.data.pager,n.paginationChange);n.setState(function(){return{moduleList:t,pagination:a,pager:e.data.data.pager}})}}).finally(function(){n.setState(function(){return{loading:!1}})})},n.generateOptions=function(e){if(e)return e.map(function(e,t){return p.a.createElement(M,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)})},n.searchClick=function(){var e=n.state.oldparams;n.props.form.validateFields(function(t,a){var r=L({},e,{},a,{pageIndex:1});n.getModuleList(r)})},n.addModule=function(){n.props.history.push({pathname:"/config/ModuleManager/add/"})},n.reset=function(){n.props.form.resetFields()},n.releaseOperation=function(e,t){Object(h.i)(e,t).then(function(e){if(0===e.data.code){var t=n.state.oldparams;n.getModuleList(t)}})},n.deleteOperation=function(e){Object(h.e)(e).then(function(e){if(0===e.data.code){var t=n.state.oldparams;n.getModuleList(t)}})},n.OfflineOperataion=function(e,t){Object(h.i)(e,t).then(function(e){if(0===e.data.code){var t=n.state.oldparams;n.getModuleList(t)}})},n.generateOperationBtn=function(e){return 1===e.releaseStatus?n.releaseBtnArr().map(function(t,a){return n.createOperationBtn(t,e)}):n.unReleaseBtnArr().map(function(t,a){return n.createOperationBtn(t,e)})},n.createOperationBtn=function(e,t){return p.a.createElement(o.a,{key:e.key,placement:"top",title:e.title},p.a.createElement(i.a,{style:{marginLeft:"10px"},shape:"circle",size:"small",icon:e.icon,key:e.templateId,onClick:function(){return n.handleOperation(e,t)}}))},n.releaseBtnArr=function(){return[{title:"查看",icon:"info",key:"View"},{title:"下线",icon:"cloud-download",key:"Offline"}]},n.unReleaseBtnArr=function(){return[{title:"发布",icon:"cloud-upload",key:"release"},{title:"编辑",icon:"edit",key:"edit"},{title:"删除",icon:"delete",key:"delete"}]},n.paginationChange=function(e){n.setState({pageIndex:e}),console.log("分页选择了：",e);var t=L({},n.state.oldparams,{pageIndex:e});n.getModuleList(t)},n.handleOperation=function(e,t){switch(e.key){case"View":n.props.getModuleInfoPreview(t.moduleId,"view");break;case"Offline":A({title:"下线模组?",content:"确认下线后，模组将同步从开放平台下线，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){n.OfflineOperataion(t.moduleId,0)},onCancel:function(){}});break;case"release":console.log(t.completeStatus),0===t.completeStatus?A({title:"发布模组",content:"当前模组信息不完整，请完善后提交发布",okText:"确定",cancelText:"取消",onOk:function(){},onCancel:function(){}}):A({title:"发布模组",content:"确认发布后，模组信息将会同步到开放平台,确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){n.releaseOperation(t.moduleId,1)},onCancel:function(){}});break;case"edit":var a=t.moduleId;n.props.history.push({pathname:"/config/ModuleManager/edit/".concat(a)});break;case"delete":A({title:"删除模组",content:"删除后，模组信息将同步删除，无法撤销，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){n.deleteOperation(t.moduleId)},onCancel:function(){}})}},n.state={moduleList:[],loading:!1,pagination:{},oldparams:{},pager:{}},n}var n,l,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,s["Component"]),n=t,(l=[{key:"componentDidMount",value:function(){var e=this.props,t=e.getBindSceneList,n=e.getAllModuleBrandList,a=e.getModuleTypeMenuAction;this.getModuleList({pageIndex:1,moduleType:"",hetModuleTypeName:"",pageRows:10}),n(),t(),a()}},{key:"render",value:function(){var e=this,t=[{title:"模组型号",width:"15%",key:"hetModuleTypeName",dataIndex:"hetModuleTypeName",render:function(e){return p.a.createElement("span",{title:e},e)}},{title:"支持通信",width:"15%",key:"moduleTypeList",dataIndex:"moduleTypeList",render:function(e){return p.a.createElement("span",{title:e},e)}},{title:"生产厂商",width:"15%",key:"brandName",dataIndex:"brandName"},{title:"状态",width:"65px",key:"releaseStatus",dataIndex:"releaseStatus",render:function(e){return p.a.createElement("span",{style:{color:"".concat(["green","gray"][e])}},1===e?"已发布":"草稿")}},{title:"更新时间",width:"15%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=y.b.formateDate(e,"yyyy-MM-dd hh:mm:ss");return p.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",key:"operation",dataIndex:"operation",render:function(t,n){return p.a.createElement("div",null,e.generateOperationBtn(n))}}],n=this.state,o=n.moduleList,l=n.loading,f=(n.pagination,n.pager),d=this.props,m=d.moduleInfo,h=d.visible,b=d.communicationMethodList,g=d.visibleChangeAcion,v=this.props.form.getFieldDecorator;return p.a.createElement(s.Fragment,null,p.a.createElement(c.a,null,p.a.createElement(C,{visible:h,moduleInfo:m,viewModuleInfoCancle:g}),p.a.createElement(R,{title:"模组管理",description:"",style:{marginBottom:10,fontSize:20}}),p.a.createElement(a.a,{layout:"inline",onSubmit:this.handleSubmit},p.a.createElement(a.a.Item,{label:"关键字"},v("hetModuleTypeName",{})(p.a.createElement(r.a,{placeholder:"请输入生产厂商或模组型号",style:{width:260},maxLength:20}))),p.a.createElement(a.a.Item,{label:"通信方式"},v("moduleType",{initialValue:void 0})(p.a.createElement(u.a,{style:{width:140,marginBottom:0},placeholder:"请选择通信方式"},this.generateOptions(b)))),p.a.createElement(a.a.Item,null,p.a.createElement(i.a,{type:"primary",onClick:this.searchClick},"查询")),p.a.createElement(a.a.Item,null,p.a.createElement(i.a,{type:"default",onClick:this.reset},"重置")),p.a.createElement(a.a.Item,null,p.a.createElement(i.a,{type:"primary",onClick:this.addModule},"添加模组")))),p.a.createElement(c.a,{className:"ModuleManagerListTable",style:{marginTop:10}},p.a.createElement(j.a,{rowKey:"id",bordered:!0,columns:t,dataSource:o,pager:f,onPageChange:this.paginationChange,loading:l})))}}])&&T(n.prototype,l),f&&T(n,f),t}())||S;t.default=Object(d.b)(function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),visible:e.getIn(["moduleManager","visible"]),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},visibleChangeAcion:function(t){var n=m.a.visibleChangeAcion(t);e(n);var a=m.a.moduleInfoChangeAcion({});e(a)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},getModuleInfoPreview:function(t){var n=m.a.getModuleInfoPreviewAction(t);e(n)}}})(a.a.create({})(F))}}]);