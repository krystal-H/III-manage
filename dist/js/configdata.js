(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1365:function(e,t,n){"use strict";n(109),n(98),n(168),n(338),n(443),n(244),n(246),n(64),n(37),n(340),n(341),n(44),n(45),n(23),n(19),n(34),n(39),n(32),n(40),n(166),n(35),n(36),n(26),n(27),n(28);var a=n(0);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(m,a["Component"]);var n,r,i,d=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=p(e);if(t()){var r=p(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f(this,n)}}(m);function m(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=d.call.apply(d,[this].concat(n))).state={pageIndex:1},e.onChange=function(t){var n=e.state.pageIndex;e.setState({pageIndex:t||n||1},function(){var t=e.state,n=[];for(var a in t)t[a]&&n.push("".concat(a,"=").concat(t[a]));e.props.history.replace("?"+n.join("&")),e.props.getList(c({},t))})},e.onFilter=function(t){var n=e.props.form;n&&(t=n.getFieldsValue()),e.setState(c({},t),function(){e.onChange(1)})},e.onReset=function(){var t=e.props.form;t&&t.resetFields()},e}return n=m,(r=[{key:"componentDidMount",value:function(){var e=this,t={pageIndex:1},n=this.props.history.location.search;n&&n.length&&n.slice(1).split("&").map(function(e){if(/^(.+)=(.+)$/.test(e)){var n=e.split("=");t[n[0]]=decodeURI(n[1])}});this.setState(c({},t),function(){e.props.getList(t)});var a=this.props.form;if(a){var r=a.getFieldsValue(),o=Object.keys(r);for(var i in t)o.includes(i)&&a.setFieldsValue(l({},i,+t[i]||t[i]))}}},{key:"render",value:function(){return a.createElement(e,o({},this.props,{onChange:this.onChange,onFilter:this.onFilter,onReset:this.onReset,query:this.state}))}}])&&u(n.prototype,r),i&&u(n,i),m}()}},1366:function(e,t,n){"use strict";n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28);var a=n(0),r=n(13),o=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,a["Component"]);var n,r,i,f=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=s(e);if(t()){var r=s(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u(this,n)}}(p);function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.apply(this,arguments)}return n=p,(r=[{key:"componentDidMount",value:function(){var e=o.a.findDOMNode(this);e&&e.parentElement&&e.parentElement.parentElement&&(e.parentElement.parentElement.scrollTop=0)}},{key:"render",value:function(){return a.createElement(e,this.props)}}])&&c(n.prototype,r),i&&c(n,i),p}()}},1368:function(e,t,n){"use strict";n(284);var a=n(212),r=(n(344),n(178)),o=(n(64),n(437),n(34),n(340),n(341),n(32),n(98),n(244),n(109),n(339),n(27),n(26),n(23),n(790),n(791),n(792),n(793),n(794),n(795),n(796),n(797),n(798),n(799),n(800),n(801),n(802),n(803),n(804),n(805),n(806),n(28),n(44),n(45),n(36),n(19),n(35),n(37),n(166),n(0)),i=["children"],c=["children"];function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var h=r.a.TreeNode;var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(v,o["Component"]);var t,n,l,b=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=d(e);if(t()){var r=d(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return p(this,n)}}(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=b.call(this,e)).handleCheck=function(e,n){"function"==typeof t.props.onChange&&t.props.onChange(e,n)},t.handleSelect=function(e,n){var a=t.state.expandedKeys,r=n.node.props.eventKey;a.includes(r)?t.setState({expandedKeys:a.filter(function(e){return e!==r})}):t.setState({expandedKeys:[].concat(u(a),[r])})},t.handleExpand=function(e){t.setState({expandedKeys:e})},t.state={expandedKeys:[],selectedKeys:[]},t}return t=v,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isExpand,n=e.dataSource,a=[];t&&function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;t&&t.forEach(function(t){t.children&&t.children.length&&a.push(n+t.id),e(t.children,n+t.id+"-",a)})}(n,"",a),this.setState({expandedKeys:a})}},{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.target,l=e.isCheck,u=void 0===l||l,s=e.checkStrictly,f=void 0!==s&&s,p=e.searchStr,d=void 0===p?"":p,b=this.state,v=b.expandedKeys,g=b.selectedKeys,E=u&&!f?n:Array.from(new Set(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.map(function(e){var n=e.split("-"),a="";n.map(function(e){e&&(a+=e,t.push(a),a+="-")})}),t}(n)));return u||E.length?o.createElement(r.a,{blockNode:!0,checkable:u,defaultExpandParent:!0,multiple:!0,showLine:!u,checkStrictly:f,selectedKeys:g,checkedKeys:E,expandedKeys:v,onCheck:this.handleCheck,onSelect:this.handleSelect,onExpand:this.handleExpand},u?function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map(function(t){var r=t.children,c=y(t,i),l=c.name.toLowerCase(),u=a.toLowerCase(),s=l.indexOf(u),f=c.name.substr(0,s),p=c.name.substring(s,s+a.length),d=c.name.substr(s+a.length),b=s>-1?o.createElement("span",null,f,o.createElement("span",{style:{color:"#f50"}},p),d):o.createElement("span",null,c.name);return o.createElement(h,m({},c,{key:n+c.id,title:b}),e(r,n+c.id+"-",a))})}(t,"",d):function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map(function(t){var r=t.children,i=y(t,c);return n.includes(a+i.id)?o.createElement(h,m({},i,{disableCheckbox:!0,key:a+i.id,title:i.name}),e(r,n,a+i.id+"-")):null}).filter(function(e){return e})}(t,E)):o.createElement(a.a,null)}}])&&s(t.prototype,n),l&&s(t,l),v}();t.a=b},1371:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l});var a=n(4),r=function(e){return a.c.request({url:"/manage-open/panel/template/list",params:e,method:"get"})},o=function(e){return a.c.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},i=function(e){return a.c.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},c=function(e){return a.c.request({url:"/manage-open/panel/template/delTemplate",data:e,method:"post"})},l=function(e){return a.c.request({url:"/manage-open/panel/template/get",params:e,method:"get"})}},1376:function(e,t,n){"use strict";n(44),n(188);var a=n(75),r=(n(64),n(45),n(23),n(37),n(19),n(34),n(39),n(32),n(40),n(166),n(35),n(36),n(26),n(27),n(28),n(0)),o=n.n(r);n(287),n(12),n(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=a.a.Option,h={},b={},v={},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(s,r["Component"]);var t,n,i,l=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=m(e);if(t()){var r=m(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return d(this,n)}}(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=l.call(this,e)).triggerChange=function(e){var n=t.props.onChange;n&&(t.props.value?n(u({categoryId:t.props.value.categoryId,subCategoryId:t.props.value.subCategoryId,deviceTypeId:t.props.value.deviceTypeId,deviceSubTypeId:t.props.value.deviceSubTypeId},e)):n(u({},e)))};t.props.value;return t.state={deviceSubCategoryList:[],deviceTypeList:[],isCalculate:!1},t}return t=s,(n=[{key:"deviceCategorySelect",value:function(e){if(h[e]){var t=h[e];this.setState({deviceSubCategoryList:t})}this.triggerChange({categoryId:e,subCategoryId:void 0,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceSubCategorySelect",value:function(e){if(b[e]){var t=b[e];this.setState({deviceTypeList:t})}this.triggerChange({subCategoryId:e,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceTypeListSelect",value:function(e){if(v[e]){var t=v[e].defaultDeviceSubtype.deviceSubtypeId;this.triggerChange({deviceTypeId:v[e].deviceTypeId,deviceSubTypeId:t})}}},{key:"componentDidMount",value:function(){this.props.deviceCategoryList}},{key:"componentWillUpdate",value:function(e,t){var n=this;if(!this.state.isCalculate&&e.value&&e.deviceCategoryList&&e.deviceCategoryList.length>0){var a=e.value.categoryId,r=e.value.subCategoryId;if(!a||!r)return;e.deviceCategoryList.map(function(e,t){if(h[e.categoryId]=e.subCategoryList,e.categoryId==a){var o=e.subCategoryList;n.setState({deviceSubCategoryList:o}),o.map(function(e,t){if(b[e.subCategoryId]=e.deviceTypeList,e.subCategoryId==r){var a=e.deviceTypeList;n.setState({deviceTypeList:a}),a.map(function(e,t){v[e.deviceTypeId]=e})}})}}),this.setState({isCalculate:!0})}}},{key:"render",value:function(){var e=this.props.deviceCategoryList||[],t=this.state.deviceSubCategoryList,n=this.state.deviceTypeList,r={},i={},l={};if(void 0!==this.props.value){var u=this.props.value.subCategoryId,s=this.props.value.categoryId;this.props.value.deviceSubTypeId;r={value:s},i={value:u},l={value:this.props.value.deviceTypeId}}return o.a.createElement("div",null,o.a.createElement(a.a,c({onSelect:this.deviceCategorySelect.bind(this),placeholder:"选择一级类目",style:{width:150}},r),e.map(function(e,t){return h[e.categoryId]=e.subCategoryList,o.a.createElement(y,{value:e.categoryId,key:t},e.categoryName)})),o.a.createElement(a.a,c({onSelect:this.deviceSubCategorySelect.bind(this),placeholder:"选择二级类目",style:{width:150}},i),t.map(function(e,t){return b[e.subCategoryId]=e.deviceTypeList,o.a.createElement(y,{value:e.subCategoryId,key:t},e.subCategoryName)})),o.a.createElement(a.a,c({onSelect:this.deviceTypeListSelect.bind(this),placeholder:"选择三级类目",style:{width:150}},l),n.map(function(e,t){return v[e.deviceTypeId]=e,o.a.createElement(y,{value:e.deviceTypeId,key:t},e.deviceTypeName)})))}}])&&f(t.prototype,n),i&&f(t,i),s}();t.a=g},1377:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return u});var a=n(4),r="manage-open",o=function(e){return a.c.request({url:"/".concat(r,"/param/dictionary/list"),params:e,method:"get"})},i=function(e){return a.c.request({url:"/".concat(r,"/param/dictionary/get"),params:{paramId:e},method:"get"})},c=function(e){return a.c.request({url:"/".concat(r,"/param/dictionary/add"),data:e,method:"post"})},l=function(e){return a.c.request({url:"/".concat(r,"/param/dictionary/update"),data:e,method:"post"})},u=function(e){return a.c.request({url:"/".concat(r,"/param/dictionary/delete"),params:{paramId:e},method:"get"})}},1384:function(e,t,n){},1385:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return l});var a=n(4),r="manage-open",o=function(e){return a.c.request({url:"/".concat(r,"/protocol/template/getList"),params:e,method:"get"})},i=function(e){return a.c.request({url:"/".concat(r,"/protocol/template/getByTemplateNumber"),params:{templateNumber:e},method:"get"})},c=function(e){return a.c.request({url:"/".concat(r,"/protocol/template/update"),data:e,method:"post"})},l=function(e){return a.c.request({url:"/".concat(r,"/protocol/template/insert"),data:e,method:"post"})}},1404:function(e,t,n){},1405:function(e,t,n){},1406:function(e,t,n){},1407:function(e,t,n){},1408:function(e,t,n){},1409:function(e,t,n){},1410:function(e,t,n){},1411:function(e,t,n){},1412:function(e,t,n){},1413:function(e,t,n){},1414:function(e,t,n){},1415:function(e,t,n){},1464:function(e,t,n){"use strict";n.r(t),n.d(t,"H5TemplateInfo",function(){return P});n(94);var a=n(38),r=(n(72),n(21)),o=(n(210),n(90)),i=(n(1332),n(1331)),c=(n(121),n(58)),l=(n(167),n(10)),u=(n(243),n(134)),s=(n(188),n(75)),f=(n(142),n(33)),p=(n(446),n(23),n(62),n(438),n(437),n(64),n(98),n(244),n(245),n(44),n(45),n(37),n(19),n(34),n(39),n(32),n(40),n(166),n(35),n(36),n(26),n(27),n(28),n(0)),d=n.n(p),m=n(1371),y=(n(1384),n(31));function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(a,r)}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=f.a.Item,j=s.a.Option,P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(E,p["Component"]);var t,n,h,v=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=C(e);if(t()){var r=C(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return I(this,n)}}(E);function E(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),(t=v.call(this,e)).getH5TemplateInfo=function(e){t.setState({loading:!0}),Object(m.c)({templateId:e}).then(function(e){var n=e.data;if(0===n.code){var a=t.doWithPages(n.data);t.setState({templateInfo:n.data,fileList:a})}}).finally(function(){t.setState(function(){return{loading:!1}})})},t.doWithPages=function(e){for(var t=[],n=0;n<=5;n++){var a="page".concat(n),r=e[a];e[a]&&t.push({url:r,status:"done",type:"image/png",name:"page".concat(n),uid:n})}return t},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){O(o,a,r,i,c,"next",e)}function c(e){O(o,a,r,i,c,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}(),t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.handleChange=function(e){"error"===e.file.status?(u.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),t.setState({fileList:e.fileList})},t.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},t.handleSubmit=function(){var e=t.state,n=e.templateInfo,a=e.fileList,r={};a.length<=0?u.a.warning("请上传模板图片!"):(a.map(function(e,t){"done"===e.status&&(e.hasOwnProperty("url")?r["page".concat(t+1)]=e.url:r["page".concat(t+1)]=e.response.data.url)}),t.props.form.validateFields(function(e,a){if(!e){console.log("values =====",a);var o=g(g({},a),{},{templateNumber:n.templateNumber,templateId:n.templateId,deviceTypeId:n.deviceTypeId,deviceSubtypeId:n.deviceSubtypeId},r);delete o.templatePicList,t.setState({loading:!0}),Object(m.e)(o).then(function(e){0===e.data.code&&u.a.success("模板信息更新成功",3,t.props.history.goBack())}).finally(function(){t.setState(function(){return{loading:!1}})})}}))},t.getCategoryList=function(e){return"string"==typeof e?e.split("-"):["","",""]},t.usercodeValidator=function(e,t,n){t||n("内容不能为空")},t.state={templateInfo:{},fileList:[],productNameList:[]},t}return t=E,(n=[{key:"componentWillMount",value:function(){var e=this.props.match.params;e&&e.templateId&&this.getH5TemplateInfo(e.templateId)}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||u.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||u.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:y.j,data:function(e){return{appId:31438,domainType:4}}},t=this.state,n=t.templateInfo,u=t.fileList,p=this.props.form.getFieldDecorator,m={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:15}}},h=d.a.createElement("div",null,d.a.createElement(l.a,{type:"plus"}),d.a.createElement("div",{className:"ant-upload-text"},"Upload")),v=this.getCategoryList(n.allCategoryName);return d.a.createElement("div",null,d.a.createElement(a.a,{title:"模板基本信息",loading:this.state.loading},d.a.createElement(f.a,{layout:"horizontal",className:"CreataH5Template_from"},d.a.createElement(k,b({label:"模板名称"},m),p("templateName",{initialValue:n.templateName,rules:[{required:!0,message:"模板名称不能为空"}]})(d.a.createElement(c.a,{style:{width:"460px"},type:"text",placeholder:"请输入您喜欢的模板名称",disabled:Boolean(n.status),allowClear:Boolean(!n.templateId),maxLength:20}))),d.a.createElement(f.a.Item,b({className:"chooseProduct",label:"所属分类"},m),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceTypeId",{initialValue:v[0],rules:[{required:!0,message:"请您选择一级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"一级类目"}))),d.a.createElement("span",null," "),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceSubtypeId",{initialValue:v[1],rules:[{required:!0,message:"请您选择二级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"二级类目"}))),d.a.createElement("span",null," "),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceSubtypeId",{initialValue:v[2],rules:[{required:!0,message:"请您选择三级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),initialValue:n.deviceSubtypeId,placeholder:"三级类目"})))),d.a.createElement(k,b({},m,{label:"产品协议"}),p("templateNumber",{initialValue:n.protocolTemplateName,rules:[{required:!0,message:"请您选择协议"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择协议"}))),d.a.createElement(k,b({},m,{label:"性质"}),p("isFree",{initialValue:1,rules:[{required:!0,message:"请您选择性质"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择"},d.a.createElement(j,{value:1},"免费")))),d.a.createElement(k,b({},m,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"}),p("templatePicList",{initialValue:u,rules:[{required:!0,message:"请上传一张图片"}]})(d.a.createElement("div",{className:"product-div"},d.a.createElement(i.a,b({},e,{accept:"image/png",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),u.length>=5?null:h),d.a.createElement(o.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},d.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),d.a.createElement(k,b({},m,{label:"描述"}),p("remark",{initialValue:n.remark})(d.a.createElement(c.a.TextArea,{disabled:Boolean(this.state.status),style:{width:460},onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))),Boolean(this.state.status)?d.a.createElement("div",null):d.a.createElement(k,{style:{textAlign:"center"}},d.a.createElement(r.a,{type:"primary",onClick:this.handleSubmit},"保存")))))}}])&&w(t.prototype,n),h&&w(t,h),E}();t.default=f.a.create()(P)},1465:function(e,t,n){"use strict";n.r(t);n(94);var a,r=n(38),o=(n(121),n(58)),i=(n(243),n(134)),c=(n(1333),n(1334)),l=(n(211),n(81)),u=(n(72),n(21)),s=(n(188),n(75)),f=(n(142),n(33)),p=(n(437),n(166),n(44),n(45),n(23),n(37),n(19),n(34),n(39),n(32),n(40),n(35),n(36),n(26),n(27),n(28),n(0)),d=n.n(p),m=(n(42),n(1377)),y=n(12),h=n(31),b=n(91);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?I(e):t}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=f.a.Item,j=(s.a.Option,f.a.create()(a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(v,p["Component"]);var t,n,a,s=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=C(e);if(t()){var r=C(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return S(this,n)}}(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=s.call(this,e)).column=[{title:"参数ID",dataIndex:"paramId",key:"paramId",width:"80px"},{title:"名称",dataIndex:"name",key:"name",width:"15%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"参数值",dataIndex:"value",key:"value",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"desc",key:"desc",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"status",key:"status",width:"100px",render:function(e){return d.a.createElement("span",null,e?"有效":"无效")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return d.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"操作",dataIndex:"paramId",key:"operation",width:"120px",render:function(e){return d.a.createElement("div",null,d.a.createElement(l.a,{title:"编辑",placement:"top"},d.a.createElement(u.a,{onClick:t.pushToDetail.bind(I(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",d.a.createElement(c.a,{title:"确认要删除吗",onConfirm:t.deleteDataDic.bind(I(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},d.a.createElement(l.a,{title:"删除",placement:"top"},d.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={pageIndex:1,pageRows:10,dataManagerList:[],totalRows:0,searchParams:{},loading:!1,pager:{}},t}return t=v,(n=[{key:"pushToDetail",value:function(e){this.props.history.push("/config/datadic/edit/".concat(e))}},{key:"deleteDataDic",value:function(e){var t=this;Object(m.b)(e).then(function(e){e.data.code===y.a&&(i.a.success("删除成功"),t.requestListData())}).catch(function(e){i.a.error("删除失败")})}},{key:"handleReset",value:function(){this.props.form.resetFields(["name"]),this.setState({pageIndex:0,searchParams:{}}),this.requestListData({pageIndex:0,name:""})}},{key:"handleFilter",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){if(!e){console.log("Received values of form: ",n);var a=n.name;t.setState({searchParams:{name:a}}),t.requestListData({name:a,pageIndex:0})}})}},{key:"componentDidMount",value:function(){this.requestListData()}},{key:"requestListData",value:function(e){var t=this,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({pageIndex:this.state.pageIndex,pageRows:this.state.pageRows,order:"asc"},this.state.searchParams);e&&(n=Object.assign({},n,e)),this.setState({loading:!0}),Object(m.e)(n).then(function(e){if(e.data.code===y.a){var n=e.data.data;t.setState({dataManagerList:n.list,totalRows:n.pager.totalRows,pageIndex:n.pager.pageIndex,loading:!1,pager:n.pager})}}).catch(function(e){t.setState({loading:!0})})}},{key:"addDataDic",value:function(){this.props.history.push("/config/datadic/add")}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({pageIndex:e}),this.requestListData({pageRows:this.state.pageRows,pageIndex:e})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.dataManagerList;return d.a.createElement("div",{style:{minWidth:"1400"}},d.a.createElement(r.a,null,d.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"数据字典管理"),d.a.createElement(f.a,{layout:"inline",onSubmit:this.handleFilter.bind(this)},d.a.createElement(k,{label:"名称"},e("name")(d.a.createElement(o.a,{style:{width:"240px"},placeholder:"请输入名称"}))),d.a.createElement(k,null,d.a.createElement(u.a,{type:"primary",htmlType:"submit"},"查询")),d.a.createElement(k,null,d.a.createElement(u.a,{onClick:this.handleReset.bind(this)},"重置")),d.a.createElement(k,null,d.a.createElement(u.a,{type:"primary",onClick:this.addDataDic.bind(this)},"新增")))),d.a.createElement(r.a,{style:{marginTop:"10px"}},d.a.createElement(b.a,{rowKey:function(e){return e.paramId},columns:this.column,dataSource:t,bordered:!0,pager:this.state.pager,loading:this.state.loading,onPageChange:this.handlePagination.bind(this)})))}}])&&O(t.prototype,n),a&&O(t,a),v}())||a);t.default=j},1466:function(e,t,n){"use strict";n.r(t);n(72);var a,r,o,i=n(21),c=(n(439),n(169)),l=(n(121),n(58)),u=(n(94),n(38)),s=(n(167),n(10)),f=(n(188),n(75)),p=(n(142),n(33)),d=(n(98),n(245),n(437),n(44),n(45),n(23),n(166),n(19),n(35),n(36),n(26),n(27),n(28),n(0)),m=n.n(d),y=n(42),h=n(108),b=n(73),v=n(1377),g=n(12),E=n(31);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=p.a.Item,P=(f.a.Option,a=Object(y.b)(function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"])}}),r=p.a.create({name:"template"}),a(o=Object(h.g)(o=r(o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(o,d["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=k(e);if(t()){var r=k(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return C(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).handeleUpdate=function(e){e.paramId=t.state.paramId,Object(v.d)(e).then(function(e){t.props.history.push("/config/datadic/list")})},t.handleAdd=function(e){Object(v.a)(e).then(function(e){t.props.history.push("/config/datadic/list")})},t.handleSubmit=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll(function(e,n){if(!e){console.log("Received values of form: ",n);var a={name:n.dicname,status:n.dicstatus,desc:n.dicdesc,value:n.dicvalue};a=E.d.filterParam(a),t.state.isEdit?t.handeleUpdate(a):t.handleAdd(a)}})},t.state={isEdit:!1,paramId:"",dicname:"",dicstatus:"",dicdesc:"",dicvalue:""},t}return t=o,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if(t&&t.paramId){this.setState({isEdit:!0,paramId:t.paramId});var n=t.paramId;Object(v.c)(n).then(function(t){if(t.data.code===g.a){var n=t.data.data;e.setState({paramId:n.paramId,dicname:n.name,dicstatus:n.status+"",dicdesc:n.desc,dicvalue:n.value})}})}}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.isEdit||!1,n=this.state,a=n.dicname,r=n.dicstatus,o=n.dicdesc,f=n.dicvalue;return m.a.createElement("div",null,m.a.createElement(u.a,null,m.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},m.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},t?"编辑数据字典":"新增数据字典"),m.a.createElement("div",null,m.a.createElement(b.b,{to:"/config/datadic/list",style:{padding:"10px"}},m.a.createElement(s.a,{type:"left"})," 返回")))),m.a.createElement(u.a,{style:{marginTop:"20px"}},m.a.createElement(p.a,w({},{labelCol:{xs:{span:16},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),m.a.createElement(j,{label:"名称"},e("dicname",{initialValue:a,rules:[{required:!0,message:"模板名称不能为空"}]})(m.a.createElement(l.a,{type:"text",style:{width:"300px"},maxLength:30,placeholder:"请输入您喜欢的模板名称,长度不超过30"}))),m.a.createElement(j,{label:"参数值"},e("dicvalue",{initialValue:f,rules:[{required:!0,message:"参数值不能为空"}]})(m.a.createElement(l.a.TextArea,{rows:7,placeholder:"请输入参数值,限制内容长度5000",maxLength:5e3}))),m.a.createElement(p.a.Item,{label:"状态"},e("dicstatus",{rules:[{required:!0,message:"请选择状态"}],initialValue:r})(m.a.createElement(c.a.Group,{style:{width:150}},m.a.createElement(c.a,{value:"1"},"有效"),m.a.createElement(c.a,{value:"0"},"无效")))),m.a.createElement(j,{label:"描述"},e("dicdesc",{rules:[{required:!0,message:"请输入描述"}],initialValue:o})(m.a.createElement(l.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容,限制内容长度50",maxLength:50}))),m.a.createElement(j,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:4}}},m.a.createElement(i.a,{type:"primary",htmlType:"submit"},t?"保存":"添加")))))}}])&&S(t.prototype,n),a&&S(t,a),o}())||o)||o)||o);t.default=P},1475:function(e,t,n){"use strict";n.r(t);n(94);var a,r=n(38),o=(n(346),n(106)),i=(n(98),n(168),n(244),n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28),n(0)),c=n.n(i),l=n(466),u=n(73),s=n(108),f=n(42),p=(n(210),n(90)),d=(n(121),n(58)),m=(n(135),n(43)),y=(n(1333),n(1334)),h=(n(211),n(81)),b=(n(72),n(21)),v=(n(188),n(75)),g=(n(142),n(33)),E=(n(1341),n(1344)),O=(n(64),n(808),n(451)),w=(n(243),n(134)),S=(n(437),n(166),n(12)),I=(n(1376),n(91));n(1411);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L,D=g.a.Item,T=Object(f.b)(function(e){return{deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}})(a=g.a.create()(a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=x(e);if(t()){var r=x(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return P(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).state={dataSource:[],pageIndex:0,pageRows:10,isLoading:!1,pager:{},searchParams:{}},t}return t=o,(n=[{key:"handelUploadFile",value:function(e){if(e.file.status,"done"===e.file.status){var t=e.file.response;0==t.code?(w.a.success("".concat(e.file.name," 文件上传成功")),this.refreshTable()):w.a.error("".concat(t.msg))}else"error"===e.file.status&&w.a.error("".concat(e.file.name," 文件上传失败."),10)}},{key:"refreshTable",value:function(){console.log("refresh Table");var e={pageRows:this.state.pageRows,pageIndex:this.state.current};this.getChildTableRequest(e)}},{key:"handleSearch",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){console.log("value:"+JSON.stringify(n));var a={};t.props.filterPannel.map(function(e,t){if("DeviceType"==e.type){var r=n.deviceTypeSelect;if(r&&3==r.length){var o=e.paramskey,i=r[2];a[o]=i}}else{var c=e.paramskey,l=n[c];l&&(a[c]=l)}}),t.setState({searchParams:a}),t.getChildTableRequest(a)})}},{key:"handlePagination",value:function(e){this.setState({pageIndex:e});var t={pageRows:this.state.pageRows,pageIndex:e};t=Object.assign({},this.state.searchParams,t),this.getChildTableRequest(t)}},{key:"getFilterPannel",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.deviceCascaderList;return this.props.filterPannel.map(function(n,a){return"Input"===n.type?c.a.createElement(D,{label:n.title,key:a},e(n.paramskey)(c.a.createElement(d.a,{placeholder:n.placeholder,maxLength:20,style:{width:"260px"}}))):"DeviceType"===n.type?c.a.createElement(D,{label:n.title,key:a},e("deviceTypeSelect")(c.a.createElement(O.a,{options:t,placeholder:"请选择所属分类",style:{width:"260px"}}))):c.a.createElement("span",null)})}},{key:"componentDidMount",value:function(){this.getChildTableRequest(),this.props.refFunction(this.refreshTable.bind(this))}},{key:"getChildTableRequest",value:function(e){var t=this;this.setState({isLoading:!0}),this.props.getTableRequest(e).then(function(e){if(t.setState({isLoading:!1}),e.data.code===S.a){var n=e.data.data.list,a=e.data.data.pager;t.setState({dataSource:n,isLoading:!1,pager:a})}}).catch(function(e){t.setState({isLoading:!1})})}},{key:"handleNewProtocolDic",value:function(){this.props.handleNewProtocolDic()}},{key:"resetFields",value:function(){this.setState({searchParams:{}}),this.props.form.resetFields()}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("div",{style:{marginBottom:"10px"}},c.a.createElement(b.a,{style:{float:"right"},type:"primary",onClick:this.handleNewProtocolDic.bind(this)},"新建")),c.a.createElement(g.a,{layout:"inline",onSubmit:this.handleSearch.bind(this),style:{marginBottom:"10px"}},this.getFilterPannel(),c.a.createElement(D,null,c.a.createElement(b.a,{htmlType:"submit"},"查询")),c.a.createElement(D,null,c.a.createElement(b.a,{onClick:this.resetFields.bind(this)},"重置"))),c.a.createElement(I.a,{className:"proptcolDicBase",bordered:!0,columns:this.props.columns,dataSource:this.state.dataSource,rowKey:this.props.rowKey,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,loading:this.state.isLoading}))}}])&&k(t.prototype,n),a&&k(t,a),o}())||a)||a,N=n(223),R=n(31),_=n(448);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?B(e):t}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=E.a.SHOW_PARENT,z=g.a.Item,K=v.a.Option,J=Object(f.b)(function(e){return{subjectMenuList:e.getIn(["globalProtocolDicInfo","subjectMenu"]),subjectExtendsMenuLsit:e.getIn(["globalProtocolDicInfo","subjectExtendsMenu"]),functionMenuList:e.getIn(["globalProtocolDicInfo","functionMenu"]),functionExtendsMenuList:e.getIn(["globalProtocolDicInfo","functionExtendsMenu"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}},function(e){return{getSubjectMenu:function(){e(_.e())},getSubjectExtendsMenu:function(){e(_.d())},getFunctionMenu:function(){e(_.c())},getFunctionExtendsMenu:function(){e(_.b())}}})(L=g.a.create()(L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=V(e);if(t()){var r=V(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return q(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).columns=[{title:"ID",dataIndex:"commonId",width:"100px"},{title:"协议数据",dataIndex:"protocolName"},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"协议类型",dataIndex:"dataTypeNameList",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"commonId",key:"0",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(h.a,{title:"编辑",placement:"top"},c.a.createElement(b.a,{onClick:t.handleEdit.bind(B(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(y.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(B(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(h.a,{title:"删除",placement:"top"},c.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={visibleModal:!1,isEdit:!1,commonData:{}},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.b)({commonId:e}).then(function(e){if(e.data.code===S.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.a)({commonId:e}).then(function(e){e.data.code===S.a&&(m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(N.d)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getSubjectMenu(),this.props.getSubjectExtendsMenu(),this.props.getFunctionMenu(),this.props.getFunctionExtendsMenu()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a=n.selectDeviceType,r={},o=[];R.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.protocolName=n.protocolName,r.subjectId=n.subjectId,r.functionId=n.functionId,n.subjectExtendId&&(r.subjectExtendId=n.subjectExtendId),n.functionExtendId&&(r.functionExtendId=n.functionExtendId),t.state.isEdit&&(r.commonId=t.state.commonData.commonId),Object(N.c)(r).then(function(e){e.data.code===S.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.subjectMenuList||[],n=this.props.subjectExtendsMenuLsit||[],a=this.props.functionMenuList||[],r=this.props.functionExtendsMenuList||[],o={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:U,searchPlaceholder:"请选择管理设备类型",style:{width:300},showArrow:!0},i=this.state.isEdit,l=i?this.state.commonData.protocolName:void 0,u=i?this.state.commonData.subjectId:void 0,s=i?this.state.commonData.subjectExtendId:void 0,f=i?this.state.commonData.functionId:void 0,m=i?this.state.commonData.functionExtendId:void 0,y=void 0;if(i){var h=this.state.commonData.deviceTypeList,b=[];h instanceof Array&&(h.map(function(e){var t=e.deviceTypeId;b.push(t)}),b.length>0&&(y=b))}return c.a.createElement("div",null,c.a.createElement(T,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"commonId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,deviceCascaderList:this.props.deviceCascaderList,filterPannel:[{type:"Input",title:"协议数据",paramskey:"protocolName",placeholder:"请输入协议数据"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/common/importExcel",download:"/v1/web/manage-open/protocol/dictionary/common/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(p.a,{title:this.state.isEdit?"编辑常用":"新建常用",visible:this.state.visibleModal,onOk:this.handleSubmitSave.bind(this),onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(g.a,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},c.a.createElement(z,{label:"协议数据"},e("protocolName",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:l})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(z,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!0,message:"请关联所属分类"}],initialValue:y})(c.a.createElement(E.a,o))),c.a.createElement(z,{label:"主体"},e("subjectId",{rules:[{required:!0,message:"请输入主体"}],initialValue:u})(c.a.createElement(v.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map(function(e,t){return c.a.createElement(K,{key:t,value:e.menuId},e.menuName)})))),c.a.createElement(z,{label:"主体扩展名"},e("subjectExtendId",{rules:[{required:!1,message:"请输入主体数据"}],initialValue:s})(c.a.createElement(v.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e,t){return c.a.createElement(K,{key:t,value:e.menuId},e.menuName)})))),c.a.createElement(z,{label:"功能"},e("functionId",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:f})(c.a.createElement(v.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.map(function(e,t){return c.a.createElement(K,{key:t,value:e.menuId},e.menuName)})))),c.a.createElement(z,{label:"功能扩展名"},e("functionExtendId",{rules:[{required:!1,message:"请输入协议数据"}],initialValue:m})(c.a.createElement(v.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e,t){return c.a.createElement(K,{key:t,value:e.menuId},e.menuName)})))))))}}])&&A(t.prototype,n),a&&A(t,a),o}())||L)||L;n(340),n(341);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X,Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=$(e);if(t()){var r=$(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Y(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).onChange=function(e,n){if(e.includes("all"))if((t.props.value||[]).length===t.props.children.length)t.triggerChange([]);else{var a=t.props.children.map(function(e){return e.props.value});t.triggerChange(a)}else t.triggerChange(e)},t.triggerChange=function(e){var n=t.props.onChange;n&&n(e)},t}return t=o,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement(v.a,G({mode:"multiple"},this.props,{onChange:this.onChange,showArrow:!0}),c.a.createElement(v.a.Option,{key:"all",style:{backgroundColor:"#eee"}},c.a.createElement("span",{style:{fontWeight:"bold"}},"全选")),this.props.children)}}])&&H(t.prototype,n),a&&H(t,a),o}();function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ne(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ce,le=g.a.Item,ue=Object(f.b)(function(e){return{functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}},function(e){return{getFunctionAllList:function(){e(_.a())}}})(X=g.a.create()(X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ie(e);if(t()){var r=ie(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return re(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).columns=[{title:"ID",dataIndex:"subjectId",key:"subjectId",width:"100px"},{title:"主体（中文）",dataIndex:"subjectNameCN",key:"subjectNameCN"},{title:"主体（英文)",dataIndex:"subjectNameEN",key:"subjectNameEN"},{title:"主体标识",dataIndex:"subjectMark",key:"subjectMark"},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(h.a,{title:"编辑",placement:"top"},c.a.createElement(b.a,{onClick:t.handleEdit.bind(oe(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(y.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(oe(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(h.a,{title:"删除",placement:"top"},c.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.onChange=function(e){var n=t.props.functionAllList;t.setState({checkedList:e,indeterminate:!!e.length&&e.length<n.length,checkAll:e.length===n.length})},t.onCheckAllChange=function(e){var n=t.props.functionAllList;t.setState({checkedList:e.target.checked?n:[],indeterminate:!1,checkAll:e.target.checked})},t.state={commonData:{},visibleModal:!1,isEdit:!1},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.t)({subjectId:e}).then(function(e){if(e.data.code===S.a){var n=e.data.data,a=n.functionList,r=[];a.map(function(e){var t=e.functionId;r.push(t)}),n.functionList=r,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.s)({subjectId:e}).then(function(n){n.data.code===S.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"getTableRequest",value:function(e){return Object(N.v)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a={};if(a.subjectNameCN=n.subjectNameCN,a.subjectNameEN=n.subjectNameEN,a.subjectMark=n.subjectMark,t.state.isEdit&&(a.subjectId=t.state.commonData.subjectId),n.functionList){var r=n.functionList,o=[];r.map(function(e){var t={functionId:e};o.push(t)}),a.functionList=o}Object(N.u)(a).then(function(e){e.data.code===S.a&&(m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"render",value:function(){var e=this.props.functionAllList||[],t=this.state.isEdit,n=t?this.state.commonData.subjectNameCN:void 0,a=t?this.state.commonData.subjectNameEN:void 0,r=t?this.state.commonData.subjectMark:void 0,o=t?this.state.commonData.functionList:void 0,i=this.props.form.getFieldDecorator;return c.a.createElement("div",null,c.a.createElement(T,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体",paramskey:"subjectNameCN",placeholder:"请输入主体名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/subject/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subject/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(p.a,{title:this.state.isEdit?"编辑主体":"新建主体",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(g.a,te({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(le,{label:"主体-中文"},i("subjectNameCN",{rules:[{required:!0,message:"请输入主体中文"}],initialValue:n})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(le,{label:"主体-英文"},i("subjectNameEN",{rules:[{required:!0,message:"请输入主体英文"}],initialValue:a})(c.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(le,{label:"主体识符"},i("subjectMark",{rules:[{required:!0,message:"请输入主体识符"}],initialValue:r})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(le,{label:"关联功能"},i("functionList",{rules:[{required:!1,message:"请输入关联功能"}],initialValue:o})(c.a.createElement(Z,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},e.map(function(e,t){return c.a.createElement(v.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)})))),c.a.createElement(le,{labelCol:{span:24},wrapperCol:{span:24}},c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&ne(t.prototype,n),a&&ne(t,a),o}())||X)||X;function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function pe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?ye(e):t}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var be=g.a.Item,ve=E.a.SHOW_PARENT,ge=Object(f.b)(function(e){return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}})(ce=g.a.create()(ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=he(e);if(t()){var r=he(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return me(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).columns=[{title:"ID",dataIndex:"subjectExtendId",key:"subjectExtendId",width:"80px"},{title:"主体扩展名（中文）",dataIndex:"subjectExtendNameCN",key:"subjectExtendNameCN"},{title:"主体扩展名（英文）",dataIndex:"subjectExtendNameEN",key:"subjectExtendNameEN"},{title:"主体扩展名标识",dataIndex:"subjectExtendMark",key:"subjectExtendMark"},{title:"匹配所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectExtendId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(h.a,{title:"编辑",placement:"top"},c.a.createElement(b.a,{onClick:t.handleEdit.bind(ye(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(y.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(ye(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(h.a,{title:"删除",placement:"top"},c.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={visibleModal:!1},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.q)({subjectExtendId:e}).then(function(e){if(e.data.code===S.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;Object(N.p)({subjectExtendId:e}).then(function(n){n.data.code===S.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(N.w)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){var a=n.selectDeviceType,r={},o=[];R.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.subjectExtendNameCN=n.subjectExtendNameCN,r.subjectExtendNameEN=n.subjectExtendNameEN,r.subjectExtendMark=n.subjectExtendMark,t.state.isEdit&&(r.subjectExtendId=t.state.commonData.subjectExtendId),Object(N.r)(r).then(function(e){e.data.code===S.a&&(m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"render",value:function(){var e={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:ve,searchPlaceholder:"请选择管理设备类型",style:{width:300}},t=this.state.isEdit,n=t?this.state.commonData.subjectExtendNameCN:void 0,a=t?this.state.commonData.subjectExtendNameEN:void 0,r=t?this.state.commonData.subjectExtendMark:void 0,o=void 0;if(t){var i=this.state.commonData.deviceTypeList,l=[];i instanceof Array&&(i.map(function(e){var t=e.deviceTypeId;l.push(t)}),l.length>0&&(o=l))}var u=this.props.form.getFieldDecorator;return c.a.createElement("div",null,c.a.createElement(T,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体扩展名（中文）",paramskey:"subjectExtendNameCN",placeholder:"请输入主体扩展名（中文）"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/subjectExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subjectExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(p.a,{title:this.state.isEdit?"编辑主体扩展":"新建主体扩展",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(g.a,fe({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(be,{label:"主体扩展名-中文"},u("subjectExtendNameCN",{rules:[{required:!0,message:"请输入主体扩展名中文"}],initialValue:n})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(be,{label:"主体扩展名-英文"},u("subjectExtendNameEN",{rules:[{required:!0,message:"请输入主体扩展名英文"}],initialValue:a})(c.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(be,{label:"主体扩展名识符"},u("subjectExtendMark",{rules:[{required:!0,message:"请主体扩展名识符"}],initialValue:r})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(be,{label:"关联所属分类"},u("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:o})(c.a.createElement(E.a,e))),c.a.createElement(be,{labelCol:{span:24},wrapperCol:{span:24}},c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&pe(t.prototype,n),a&&pe(t,a),o}())||ce)||ce,Ee=(n(37),n(34),n(39),n(32),n(40),n(440),n(171)),Oe=(n(441),n(104));n(343),n(109);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var je=g.a.Item,Pe=v.a.Option,xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ke(e);if(t()){var r=ke(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Ce(this,n)}}(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.defaultField,a=e.defaultLen,r=e.defaultUnit,o=e.form,i=e.name,l=o.getFieldDecorator;return c.a.createElement(Ee.a,{type:"flex",justify:"space-around"},c.a.createElement(Oe.a,null,c.a.createElement(je,null,l("id_"+i,{rules:[{required:!1}]})(c.a.createElement(d.a,{style:{display:"none"},size:"small"})))),c.a.createElement(Oe.a,{span:11},c.a.createElement(je,null,l("field_"+i,{initialValue:n||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{placeholder:t,size:"small"})))),c.a.createElement(Oe.a,{span:5},l("len_"+i,{initialValue:a||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{size:"small"}))),c.a.createElement(Oe.a,{span:6},l("unit_"+i,{initialValue:r||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(v.a,{size:"small"},c.a.createElement(Pe,{value:1},"字节"),c.a.createElement(Pe,{value:2},"位")))))}}])&&Se(t.prototype,n),a&&Se(t,a),o}();function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=Re(e);if(t()){var r=Re(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Ne(this,n)}}(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).getFieldsItem=function(){var t=e.props,n=t.protocolType,a=t.form;return n?n.content.map(function(e,t){return c.a.createElement(xe,{key:n.id+"_"+t,form:a,placeholder:e.placeholder,defaultLen:e.defaultLen,defaultUnit:e.defaultUnit,name:t})}):null},e}return t=o,(n=[{key:"render",value:function(){return c.a.createElement("div",{className:"value-type"},c.a.createElement(Ee.a,null,c.a.createElement(Oe.a,{span:11},c.a.createElement("span",null,"数据标识")),c.a.createElement(Oe.a,{span:6},c.a.createElement("span",null,"长度")),c.a.createElement(Oe.a,{span:7},c.a.createElement("span",null,"单位"))),this.getFieldsItem())}}])&&De(t.prototype,n),a&&De(t,a),o}();n(339);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=g.a.Item,Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=Be(e);if(t()){var r=Be(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return qe(this,n)}}(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).state={functionDetailList:e.props.functionDetailList||[{functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}]},e.handleAdd=function(){var t=e.state.functionDetailList,n=Array.from(t);n.push({functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}),e.setState({functionDetailList:n})},e.handleDel=function(t){var n=e.props.form,a=n.getFieldsValue(),r=[],o={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(a).map(function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");r[t[1]]||(r[t[1]]={}),r[t[1]][o[t[0]]]=a[e]}}),r=r.filter(function(e,n){return n!=t});var i={};r.map(function(e,t){i["id_"+t]=e.functionDetailId,i["field_"+t]=e.functionMark,i["len_"+t]=e.functionLength,i["unit_"+t]=e.functionUnit}),n.setFieldsValue(i),e.setState({functionDetailList:r})},e}return t=o,(n=[{key:"componentWillReceiveProps",value:function(e){this.props.flag!=e.flag&&this.setState({functionDetailList:e.functionDetailList||[{functionDetailId:null,functionMark:null}]})}},{key:"render",value:function(){var e=this,t=this.props.form,n=this.state.functionDetailList,a=t.getFieldDecorator;return c.a.createElement("div",{className:"value-type"},c.a.createElement(Ee.a,null,c.a.createElement(Oe.a,{span:4},c.a.createElement("span",null," ")),c.a.createElement(Oe.a,{span:15},c.a.createElement("span",null,"数据标识")),c.a.createElement(Oe.a,{span:4},c.a.createElement("span",null," "))),n&&n.map(function(t,n){return c.a.createElement(Ee.a,{type:"flex",justify:"space-around",key:n+t.functionMark},c.a.createElement(Oe.a,{span:4},c.a.createElement(Ve,null,c.a.createElement("p",null,"BIT".concat(n)))),c.a.createElement(Oe.a,{span:0},c.a.createElement(Ve,null,a("id_"+n,{initialValue:t.functionDetailId||null,rules:[{required:!1}]})(c.a.createElement(d.a,{style:{display:"none"},size:"small"})))),c.a.createElement(Oe.a,{span:15},c.a.createElement(Ve,null,a("field_"+n,{initialValue:t.functionMark,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{size:"small"})))),c.a.createElement(Oe.a,{span:0},a("len_"+n,{initialValue:t.functionLength||1,rules:[{required:!1,message:"字段不能为空"}]})(c.a.createElement(d.a,{style:{opacity:0},size:"small"}))),c.a.createElement(Oe.a,{span:0},a("unit_"+n,{initialValue:t.Unit||2,rules:[{required:!1,message:"字段不能为空"}]})(c.a.createElement(d.a,{style:{opacity:0},size:"small"}))),c.a.createElement(Oe.a,{span:4,style:{textAlign:"center"}},n>0?c.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):c.a.createElement("p",null," ")))}),c.a.createElement(Ee.a,null,c.a.createElement(Oe.a,{span:4},c.a.createElement("a",{onClick:this.handleAdd},"添加"))))}}])&&Ae(t.prototype,n),a&&Ae(t,a),o}();function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(){return(Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Je(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe,Ye=g.a.Item,$e=v.a.Option,Xe=[{id:1,name:"字符",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:2,name:"数值",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:3,name:"枚举",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:4,name:"布尔",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:5,name:"绝对时间",content:[{placeholder:"时间戳数据位",defaultLen:13,defaultUnit:1}]},{id:6,name:"相对时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:7,name:"循环时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"周"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:8,name:"RGB颜色",content:[{placeholder:'"红色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"黄色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"蓝色"数据位',defaultLen:1,defaultUnit:1}]},{id:9,name:"二进制",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:10,name:"数组",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]},{id:11,name:"结构体",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]}],Ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=He(e);if(t()){var r=He(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Ge(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).handleChange=function(e){t.setState({protocolType:Xe[e-1]},function(){if(e<10){for(var t=Xe[e-1].content.length,n=[],a=0;a<t;a++)n.push("id_"+a),n.push("field_"+a),n.push("len_"+a),n.push("unit_"+a);this.props.form.resetFields(n)}})},t.handleAdd=function(){var e=t.state.childfunclist,n=JSON.parse(JSON.stringify(e));n.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),t.setState({childfunclist:n})},t.handleAdd=function(){var e=t.state.childfunclist,n=JSON.parse(JSON.stringify(e));n.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),t.setState({childfunclist:n})},t.handleDel=function(e){var n=t.state.childfunclist,a=JSON.parse(JSON.stringify(n));a.splice(e,1),t.setState({childfunclist:a})},t.state={functionDetailList:null,childfunclist:[{functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}],protocolType:Xe[t.props.functionDataType-1]||Xe[0]},t}return t=o,(n=[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.functionDataType,a=t.visibleModal,r=t.functionDetailList;if(console.log("....Props..functionDetailList---",r,e.functionDetailList),(n!=e.functionDataType||a!=e.visibleModal)&&(this.setState({protocolType:Xe[e.functionDataType-1],functionDetailList:e.functionDetailList}),11==e.functionDataType)){var o=e.functionDetailList&&e.functionDetailList[0]&&e.functionDetailList[0].subFunctionDetailList||[];0==o.length&&o.push({functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}),console.log(111,e.functionDetailList),this.setState({childfunclist:o})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.protocolType,a=t.functionDetailList,r=t.childfunclist;console.log("...childfunclist...",r);var o=this.props.form.getFieldDecorator,i={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},l={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:16}}},u=c.a.createElement("div",null);return u=9==n.id?c.a.createElement(Ue,{functionDetailList:a,form:this.props.form}):10==n.id?c.a.createElement("div",null,c.a.createElement(Ye,Ke({label:"数据标识"},l),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(c.a.createElement(d.a,{placeholder:"50个以内的字符",maxLength:50}))),c.a.createElement(Ye,Ke({label:"元素类型"},l),o("functionDataTypeChild",{rules:[{required:!0,message:"元素类型不能为空"}],initialValue:1})(c.a.createElement(v.a,{placeholder:"选择元素类型"},c.a.createElement($e,{value:1},"字符型"),c.a.createElement($e,{value:2},"数值型")))),c.a.createElement(Ye,Ke({label:"元素字节长度"},l),o("functionLength",{rules:[{required:!0,message:"元素字节长度"}]})(c.a.createElement(d.a,{placeholder:"最大不超过1000",maxLength:4})))):11==n.id?c.a.createElement("div",null,c.a.createElement(Ye,Ke({label:"数据标识"},i,{style:{marginBottom:"0"}}),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(c.a.createElement(d.a,{placeholder:"50个以内的字符",maxLength:50}))),c.a.createElement(Ye,Ke({label:"JSON对象"},i,{style:{marginBottom:"0"}}),o("JSONobj",{rules:[{required:!0,message:""}],initialValue:123})(c.a.createElement(d.a,{type:"hidden"}))),c.a.createElement(Ee.a,null,c.a.createElement(Oe.a,{span:6},c.a.createElement("span",null,"参数名称")),c.a.createElement(Oe.a,{span:6},c.a.createElement("span",null,"数据标识")),c.a.createElement(Oe.a,{span:5},c.a.createElement("span",null,"数据类型")),c.a.createElement(Oe.a,{span:4},c.a.createElement("span",null,"字节长度")),c.a.createElement(Oe.a,{span:3,style:{textAlign:"right"}},c.a.createElement("span",null,"操作"))),r.map(function(t,n){return c.a.createElement(Ee.a,{gutter:4,key:"childfunc_"+n},c.a.createElement(Oe.a,{span:6},c.a.createElement(Ye,{style:{marginBottom:"0"}},o("functionDetailName_"+n,{initialValue:t.functionDetailName||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{placeholder:"参数名称",maxLength:50,size:"small"})))),c.a.createElement(Oe.a,{span:6},c.a.createElement(Ye,{style:{marginBottom:"0"}},o("functionMark_"+n,{initialValue:t.functionMark||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{placeholder:"数据标识",maxLength:50,size:"small"})))),c.a.createElement(Oe.a,{span:5},c.a.createElement(Ye,{style:{marginBottom:"0"}},o("functionDataType_"+n,{initialValue:t.functionDataType||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(v.a,{placeholder:"选择数据类型",size:"small"},c.a.createElement($e,{value:1},"字符型"),c.a.createElement($e,{value:2},"数值型"),c.a.createElement($e,{value:3},"枚举型"),c.a.createElement($e,{value:4},"布尔型"))))),c.a.createElement(Oe.a,{span:4},c.a.createElement(Ye,{style:{marginBottom:"0"}},o("functionLength_"+n,{initialValue:t.functionLength||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(d.a,{placeholder:"字节长度",maxLength:4,size:"small"})))),c.a.createElement(Oe.a,{span:3,style:{textAlign:"right"}},n>0?c.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):c.a.createElement("p",null," ")))}),c.a.createElement(Ee.a,null,c.a.createElement(Oe.a,{span:24,style:{textAlign:"right"}},c.a.createElement("a",{onClick:this.handleAdd},"添加")))):c.a.createElement(_e,{protocolType:n,form:this.props.form}),c.a.createElement(Ye,Ke({},i,{label:"协议类型"}),o("functionDataType",{initialValue:1,rules:[{required:!0,message:"请选择协议类型"}]})(c.a.createElement(v.a,{placeholder:"选择协议类型",onChange:this.handleChange},Xe.map(function(e){return c.a.createElement($e,{value:e.id,key:e.id},e.name)}))),u)}}])&&Je(t.prototype,n),a&&Je(t,a),o}();function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(){return(tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function it(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?ct(e):t}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut,st=[{functionType:20,functionTypeName:"历史控制数据"},{functionType:8,functionTypeName:"历史运行数据"},{functionType:27,functionTypeName:"状态数据"},{functionType:9,functionTypeName:"红外数据"},{functionType:2,functionTypeName:"控制数据"},{functionType:3,functionTypeName:"运行数据"},{functionType:4,functionTypeName:"故障数据"},{functionType:5,functionTypeName:"配置数据"}],ft=g.a.Item,pt=(E.a.SHOW_PARENT,g.a.create()(Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=lt(e);if(t()){var r=lt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return it(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).columns=[{title:"ID",dataIndex:"functionId",width:"100px"},{title:"功能名（中文）",dataIndex:"functionNameCN"},{title:"功能名（英文）",dataIndex:"functionNameEN"},{title:"类型",dataIndex:"dataTypeNameList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionId",key:"0",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(h.a,{title:"编辑",placement:"top"},c.a.createElement(b.a,{onClick:t.handleEdit.bind(ct(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(y.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(ct(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(h.a,{title:"删除",placement:"top"},c.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={functionDataType:1,functionDetailList:null,commonData:{}},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this,n=this;Object(N.l)({functionId:e}).then(function(e){if(console.log("get detail---",e.data.data),e.data.code===S.a){var a=e.data.data;t.setState({functionDataType:a.functionDataType,functionDetailList:a.functionDetailList,commonData:a,visibleModal:!0,isEdit:!0},function(){var e=a.functionDetailList,t={},r=a.functionDataType;if(r<10)e.map(function(e,n){t["id_"+n]=e.functionDetailId,t["field_"+n]=e.functionMark,t["len_"+n]=e.functionLength,t["unit_"+n]=e.functionUnit});else if(10==r)t.functionMark=e[0].functionMark,t.functionDataTypeChild=e[0].functionDataType,t.functionLength=e[0].functionLength;else if(11==r){t.functionMark=e[0].functionMark,(e[0].subFunctionDetailList||[]).map(function(e,n){t["functionMark_"+n]=e.functionMark,t["functionDetailName_"+n]=e.functionDetailName,t["functionDataType_"+n]=e.functionDataType,t["functionLength_"+n]=e.functionLength})}setTimeout(function(){n.props.form.setFieldsValue(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(n,!0).forEach(function(t){at(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({functionNameCN:a.functionNameCN,functionNameEN:a.functionNameEN,dataTypeList:Array.isArray(a.dataTypeList)?a.dataTypeList:[a.dataTypeList],functionDataType:r},t))},100)})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.k)({functionId:e}).then(function(n){n.data.code===S.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return Object(N.n)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1,functionDataType:1},function(){this.props.form.resetFields()})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("....values...",n);var a=n.functionDataType,r={};r.functionNameCN=n.functionNameCN,r.functionNameEN=n.functionNameEN,r.dataTypeList=n.dataTypeList,r.functionDataType=a,t.state.isEdit&&(r.functionId=t.state.commonData.functionId);var o=[];if(10==a)o[0]={functionMark:n.functionMark,functionDataType:n.functionDataTypeChild,functionLength:n.functionLength};else if(11==a){o[0]={functionMark:n.functionMark,functionDataType:a,subFunctionDetailList:[]};var i=[];Object.keys(n).map(function(e){var t=e.split("_");if(t.length>1){var a=t[1],r=t[0],o=n[e];console.log("---",a,r,o,"---"),i[a]||(i[a]={}),i[a][r]=o}}),o[0].subFunctionDetailList=i}else if(a<10){var c={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(n).map(function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");o[t[1]]||(o[t[1]]={}),o[t[1]][c[t[0]]]=n[e]}})}r.functionDetailList=o,Object(N.m)(r).then(function(e){e.data.code===S.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{},functionDetailList:null})}})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{},functionDetailList:null})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.commonData.functionNameCN||"",n=this.state.commonData.functionNameEN||"",a=this.state.commonData.dataTypeList||[],r=this.state,o=r.functionDataType,i=r.functionDetailList;return c.a.createElement("div",null,c.a.createElement(T,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能名（中文）",paramskey:"functionNameCN",placeholder:"请输入功能名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/function/importExcel",download:"/v1/web/manage-open/protocol/dictionary/function/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(p.a,{title:this.state.isEdit?"编辑功能":"新建功能",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),width:700},c.a.createElement(g.a,tt({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(ft,{label:"功能-中文"},e("functionNameCN",{rules:[{required:!0,message:"请输入功能中文"}],initialValue:t})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(ft,{label:"功能-英文"},e("functionNameEN",{rules:[{required:!0,message:"请输入功能英文"}],initialValue:n})(c.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(ft,{label:"功能分类"},e("dataTypeList",{rules:[{required:!0,message:"请输入功能分类"}],initialValue:a})(c.a.createElement(Z,{showArrow:!0,showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},st.map(function(e){return c.a.createElement(v.a.Option,{value:e.functionType,key:e.functionType},e.functionTypeName)})))),c.a.createElement(Ze,{visibleModal:this.state.visibleModal,functionDataType:o,functionDetailList:i,form:this.props.form}),c.a.createElement(ft,{labelCol:{span:24},wrapperCol:{span:24}},c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&rt(t.prototype,n),a&&rt(t,a),o}())||Qe);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(){return(mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?vt(e):t}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Et=E.a.SHOW_PARENT,Ot=g.a.Item,wt=(v.a.Option,Object(f.b)(function(e){return{deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}},function(e){return{getFunctionAllList:function(){e(_.a())}}})(ut=g.a.create()(ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(o,c.a.Component);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=gt(e);if(t()){var r=gt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return bt(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).columns=[{title:"ID",dataIndex:"functionExtendId",key:"functionExtendId",width:"80px"},{title:"功能扩展名（中文）",dataIndex:"functionExtendNameCN",key:"functionExtendNameCN",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"功能扩展名（英文）",dataIndex:"functionExtendNameEN",key:"functionExtendNameEN",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"功能扩展名标识",dataIndex:"functionExtendMark",key:"functionExtendMark",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"20%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"20%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionExtendId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(h.a,{title:"编辑",placement:"top"},c.a.createElement(b.a,{onClick:t.handleEdit.bind(vt(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(y.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(vt(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(h.a,{title:"删除",placement:"top"},c.a.createElement(b.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;console.log("get detail"),Object(N.f)({functionExtendId:e}).then(function(e){if(console.log("get detail"),e.data.code===S.a){var n=e.data.data,a=n.functionList,r=[];a.map(function(e){var t=e.functionId;r.push(t)}),n.functionList=r,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}})}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.e)({functionExtendId:e}).then(function(n){n.data.code===S.a&&(console.log("删除： "+e+" 成功"),m.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})}},{key:"getTableRequest",value:function(e){return this.setState({isLoading:!0}),Object(N.h)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields(function(e,n){if(!e){console.log("validateFields: "+n);var a=n.selectDeviceType,r={},o=[];if(R.c.getDeviceTypeFromSelectList(a,t.props.deviceCategoryList).map(function(e,t){var n={deviceTypeId:e};o.push(n)}),r.deviceTypeList=o,r.functionExtendNameCN=n.functionExtendNameCN,r.functionExtendNameEN=n.functionExtendNameEN,r.functionExtendMark=n.functionExtendMark,t.state.isEdit&&(r.functionExtendId=t.state.commonData.functionExtendId),n.functionList){var i=n.functionList,c=[];i.map(function(e){var t={functionId:e};c.push(t)}),r.functionList=c}Object(N.g)(r).then(function(e){e.data.code===S.a&&(console.log("保存： 成功"),m.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}),t.setState({visibleModal:!1,commonData:{}})}})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:Et,searchPlaceholder:"请选择管理设备类型",style:{width:300}},n=this.props.functionAllList||[],a=this.state.isEdit,r=a?this.state.commonData.functionExtendNameCN:void 0,o=a?this.state.commonData.functionExtendNameEN:void 0,i=a?this.state.commonData.functionExtendMark:void 0,l=a?this.state.commonData.functionList:void 0,u=void 0;if(a){var s=this.state.commonData.deviceTypeList,f=[];s instanceof Array&&(s.map(function(e){var t=e.deviceTypeId;f.push(t)}),f.length>0&&(u=f))}return c.a.createElement("div",null,c.a.createElement(T,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能扩展名（中文）",paramskey:"functionExtendNameCN",placeholder:"请输入功能扩展名"}],upload:"/v1/web/manage-open/protocol/dictionary/functionExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/functionExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(p.a,{title:this.state.isEdit?"编辑功能扩展名":"新建功能扩展名",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(g.a,mt({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(Ot,{label:"功能扩展名-中文"},e("functionExtendNameCN",{rules:[{required:!0,message:"请输入功能扩展名中文"}],initialValue:r})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(Ot,{label:"功能扩展名-英文"},e("functionExtendNameEN",{rules:[{required:!0,message:"请输入功能扩展名英文"}],initialValue:o})(c.a.createElement(d.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(Ot,{label:"功能扩展名标识符"},e("functionExtendMark",{rules:[{required:!0,message:"请输入功能扩展名标识符"}],initialValue:i})(c.a.createElement(d.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(Ot,{label:"关联功能"},e("functionList",{rules:[{required:!0,message:"请输入关联功能"}],initialValue:l})(c.a.createElement(Z,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e,t){return c.a.createElement(v.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)})))),c.a.createElement(Ot,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:u})(c.a.createElement(E.a,t))),c.a.createElement(Ot,{labelCol:{span:24},wrapperCol:{span:24}},c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(b.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(b.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&yt(t.prototype,n),a&&yt(t,a),o}())||ut)||ut);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kt(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pt=o.a.Item,xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(f,c.a.Component);var t,n,a,i=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=jt(e);if(t()){var r=jt(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return kt(this,n)}}(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=i.call(this,e)).state={menuIndex:"common"},t}return t=f,(n=[{key:"menuClick",value:function(e){this.setState({menuIndex:e.key})}},{key:"componentDidMount",value:function(){var e=window.location.hash.replace(/#|\?.*$/g,"").split("/").pop();this.setState({menuIndex:e}),this.props.getFunctionAllList()}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement(r.a,{style:{marginBottom:"10px"}},c.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"协议字典"),c.a.createElement(o.a,{onClick:this.menuClick.bind(this),selectedKeys:[this.state.menuIndex],mode:"horizontal"},c.a.createElement(Pt,{key:"common"},c.a.createElement(u.b,{to:"/config/protocoldic/common"},"常用")),c.a.createElement(Pt,{key:"main"},c.a.createElement(u.b,{to:"/config/protocoldic/main"},"主体")),c.a.createElement(Pt,{key:"mainextends"},c.a.createElement(u.b,{to:"/config/protocoldic/mainextends"},"主体扩展名")),c.a.createElement(Pt,{key:"function"},c.a.createElement(u.b,{to:"/config/protocoldic/function"},"功能")),c.a.createElement(Pt,{key:"functionextends"},c.a.createElement(u.b,{to:"/config/protocoldic/functionextends"},"功能扩展名")))),c.a.createElement(r.a,null,c.a.createElement(s.d,null,c.a.createElement(l.a,{path:"/config/protocoldic/common",component:J}),c.a.createElement(l.a,{path:"/config/protocoldic/main",component:ue}),c.a.createElement(l.a,{path:"/config/protocoldic/mainextends",component:ge}),c.a.createElement(l.a,{path:"/config/protocoldic/function",component:pt}),c.a.createElement(l.a,{path:"/config/protocoldic/functionextends",component:wt}),c.a.createElement(s.a,{to:"/config/protocoldic/common",from:"/config/protocoldic"}))))}}])&&It(t.prototype,n),a&&It(t,a),f}();t.default=Object(f.b)(null,function(e){return{getFunctionAllList:function(){e(_.a())}}})(xt)},1479:function(e,t,n){"use strict";n.r(t);n(98),n(245);var a=n(0),r=n.n(a),o=n(108),i=(n(94),n(38)),c=(n(121),n(58)),l=(n(211),n(81)),u=(n(72),n(21)),s=(n(210),n(90)),f=(n(109),n(437),n(44),n(45),n(23),n(37),n(19),n(34),n(39),n(32),n(40),n(35),n(36),n(26),n(27),n(28),n(42)),p=n(91),d=n(436),m=n(445);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=d.a.Option,I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(f,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=w(e);if(t()){var r=w(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return O(this,n)}}(f);function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={projectName:"",robotId:"",queryStatus:null,loading:!1},e.handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(v({},a,r))},e.handleSearch=function(){var t=e.state,n=t.projectName,a=t.robotId;e.setState({queryStatus:{projectName:n,robotId:a}},function(){e.pageChange()})},e.handleReset=function(){e.setState({projectName:"",robotId:"",queryStatus:null},function(){e.refInpt1.setState({value:""}),e.refInpt2.setState({value:""})})},e.handleNew=function(){e.props.history.push("./0")},e.handleEdit=function(t){e.props.history.push("./".concat(t))},e.handleDel=function(t){s.a.confirm({title:"确定删除项目",centered:!0,onOk:function(){e.props.delProject(t)}})},e.pageChange=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=b(b({},e.state.queryStatus),{},{pageIndex:t});console.log(n),e.setState({loading:!0},function(){e.props.getList(n).then(function(t){e.setState({loading:!1})})})},e}return t=f,(n=[{key:"componentDidMount",value:function(){console.log(this.props),this.pageChange()}},{key:"render",value:function(){var e=this,t=this.state.loading,n=this.props,a=n.pager,o=n.list,s=[{title:"项目ID",dataIndex:"projectId",width:"10%"},{title:"名称",dataIndex:"projectName",width:"20%"},{title:"机器人ID",dataIndex:"robotId",width:"150px"},{title:"关联产品",dataIndex:"productNameList",width:"30%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(l.a,{placement:"top",title:"管理"},r.a.createElement(u.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.handleEdit.bind(e,t.projectId)})),"  |  ",r.a.createElement(l.a,{placement:"top",title:"删除"},r.a.createElement(u.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.projectId)})))}}];return r.a.createElement("div",{className:"projectmanage"},r.a.createElement(d.a,{title:"项目管理"},r.a.createElement(S,null,r.a.createElement(c.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入项目名称查询",name:"projectName",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt1=t}})),r.a.createElement(S,null,r.a.createElement(c.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入机器人ID查询",name:"robotId",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt2=t}})),r.a.createElement(S,null,r.a.createElement(u.a,{type:"primary",onClick:this.handleSearch},"查询")),r.a.createElement(S,null,r.a.createElement(u.a,{type:"primary",onClick:this.handleReset},"重置")),r.a.createElement(S,{align:"right"},r.a.createElement(u.a,{type:"primary",onClick:this.handleNew},"新建"))),r.a.createElement(i.a,null,r.a.createElement(p.a,{rowKey:"projectId",pagination:!1,columns:s,dataSource:o,pager:a,onPageChange:this.pageChange,loading:t})))}}])&&g(t.prototype,n),a&&g(t,a),f}(),C=Object(f.b)(function(e){return{list:e.getIn(["projectManage","list"]).toJS(),pager:e.getIn(["projectManage","pager"]).toJS()}},function(e){return{getList:function(t){return e(m.a.getList(t))},delProject:function(t){return e(m.a.delProject(t))}}})(I),k=(n(135),n(43)),j=(n(168),n(73)),P=n(12),x=(n(281),n(155));n(452),n(282);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=R(e);if(t()){var r=R(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return N(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={macAddress:"",loading:!1},e.handleOk=function(){var t=e.props.deviceList;t&&0!==t.length?(e.props.addDevice(t),e.props.onCancel()):e.props.onCancel()},e.handleChange=function(t){e.setState({macAddress:t.target.value})},e.handleQuery=function(){e.setState({loading:!0},function(){var t=e.props.projectId;e.props.getDevice({macAddress:e.state.macAddress,projectId:t}).then(function(t){e.setState({loading:!1})})})},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&(this.setState({macAddress:""}),this.props.clearDevice())}},{key:"render",value:function(){var e=this.state,t=e.macAddress,n=e.loading,a=this.props,o=a.deviceList,i=a.visible,l=a.onCancel;return r.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:1200,visible:i,onCancel:l,footer:r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:l},"取消"))},r.a.createElement("h2",null,"添加产品设备"),r.a.createElement("div",{className:"header"},r.a.createElement(c.a,{placeholder:"请输入MAC地址查询",maxLength:20,onChange:this.handleChange,value:t,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),r.a.createElement("div",{className:"projectmanage-modal-table product"},r.a.createElement(x.a,{bordered:!0,loading:n,rowKey:"productId",pagination:!1,columns:[{title:"MAC",dataIndex:"macAddress",width:"15%"},{title:"IMEI",dataIndex:"imei",width:"15%"},{title:"产品ID",dataIndex:"productId",width:"10%"},{title:"产品型号",dataIndex:"productCode",width:"20%"},{title:"产品名称",dataIndex:"productName",width:"20%"},{title:"所属分类",dataIndex:"allCategoryName",width:"20%"}],dataSource:o})))}}])&&D(t.prototype,n),a&&D(t,a),i}(),M=Object(f.b)(function(e){return{deviceList:e.getIn(["projectManage","deviceList"]).toJS()}},function(e){return{getDevice:function(t){return e(m.a.getDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))},clearDevice:function(){return e(m.a.setDevice([]))}}})(_);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=V(e);if(t()){var r=V(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return B(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1,macAddress:"",productId:"",query:{macAddress:"",productId:""}},e.fileInput=null,e.fileChange=function(t){e.props.uploadDevice(t.target.files[0]).then(function(e){e&&k.a.success({message:"导入成功",duration:3})}),e.fileInput.value=""},e.handleAdd=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e.handleDel=function(t){e.props.delDevice(t)},e.handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r))},e.handleQuery=function(){var t=e.state,n=t.macAddress,a=t.productId;e.setState({query:{macAddress:n,productId:a}})},e}return t=i,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.projectId,n=this.state,a=n.visible,o=n.query,i=this.props,l=i.projectDeviceProductList,s=i.positionList,f=[{title:"MAC",dataIndex:"macAddress",width:"150px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"IMEI",dataIndex:"imei",width:"10%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"产品ID",dataIndex:"productId",width:"100px"},{title:"产品型号",dataIndex:"productCode",width:"15%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"产品名称",dataIndex:"productName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"100px",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement("span",{onClick:e.handleDel.bind(e,t)},"删除"))}}],p=o.macAddress,d=o.productId,m=l&&l.length>0?l.filter(function(e){return e.macAddress.toLowerCase().indexOf(p.toLowerCase())>=0}).filter(function(e){return new RegExp("^".concat(d.toLowerCase())).test((e.productId+"").toLowerCase())}):[];return r.a.createElement("div",{className:"edit-detail production"},r.a.createElement("div",{className:"tab-query"},r.a.createElement(c.a,{placeholder:"MAC地址",maxLength:20,className:"left",name:"macAddress",onChange:this.handleChange,onPressEnter:this.handleQuery}),r.a.createElement(c.a,{placeholder:"产品ID",maxLength:20,className:"left",name:"productId",onChange:this.handleChange,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",className:"left",onClick:this.handleQuery},"查询"),r.a.createElement(u.a,{type:"primary",className:"right",onClick:this.handleAdd},"添加产品"),r.a.createElement("div",{className:"btn-upload"},r.a.createElement(u.a,{type:"primary"},"批量导入",r.a.createElement("input",{type:"file",className:"upload",accept:".xls, .xlsx",onChange:this.fileChange,ref:function(t){return e.fileInput=t}}))),r.a.createElement("a",{className:"right",href:"/v1/web/manage-open/project/management/deviceProduct/download"},"下载模板")),r.a.createElement(x.a,{rowKey:"macAddress",bordered:!0,pagination:!1,columns:f,dataSource:m,scroll:{x:"max-content",y:500}}),r.a.createElement(M,{visible:a,onOk:this.handleOk,onCancel:this.handleCancel,projectDeviceProductList:l,projectId:t,positionList:s}))}}])&&F(t.prototype,n),a&&F(t,a),i}(),z=Object(f.b)(function(e){return{projectDeviceProductList:e.getIn(["projectManage","project","projectDeviceProductList"]).toJS()}},function(e){return{getProductList:function(t){return e(m.a.getProductList(t))},uploadDevice:function(t){return e(m.a.uploadDevice(t))},delDevice:function(t){return e(m.a.delDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))}}})(U);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=H(e);if(t()){var r=H(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return G(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={active:null,modelName:"",query:""},e.handleOk=function(){var t=e.state.active;null!=K(t)?(e.props.setPosition(t),e.props.getSummaryList(t.modelId),e.props.onCancel()):e.props.onCancel()},e.handleClick=function(t){e.setState({active:t})},e.handleChange=function(t){e.setState({modelName:t.target.value})},e.handleQuery=function(){var t=e.state.modelName;e.setState({query:t})},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&this.setState({active:null,modelName:"",query:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.active,a=t.modelName,o=t.query,i=(n||this.props.projectPositionDataModel).modelId,l=this.props,f=l.visible,p=l.onCancel,d=l.positionList,m=d?d.filter(function(e){return e.modelName.toLowerCase().indexOf(o.toLowerCase())>=0}):[];return r.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:800,visible:f,onOk:this.handleOk,onCancel:p,footer:r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:p},"取消"))},r.a.createElement("h2",null,"选择位置数据模型"),r.a.createElement("div",{className:"header"},r.a.createElement(c.a,{placeholder:"请选择位置数据模型",maxLength:20,onChange:this.handleChange,value:a,onPressEnter:this.handleQuery}),r.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),r.a.createElement("div",{className:"projectmanage-modal-table"},r.a.createElement(x.a,{rowKey:"modelId",pagination:!1,columns:[{title:"模型名称",dataIndex:"modelName",width:"40%"},{title:"描述",dataIndex:"modelDesc",width:"60%"}],dataSource:m,onRow:function(t){return{onClick:e.handleClick.bind(e,t)}},scroll:{x:"max-content",y:400},rowSelection:{type:"radio",selectedRowKeys:[i],onSelect:this.handleClick}})))}}])&&J(t.prototype,n),a&&J(t,a),i}(),Y=Object(f.b)(function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}},function(e){return{setPosition:function(t){return e(m.a.setPosition(t))},getSummaryList:function(t){return e(m.a.getSummaryList(t))}}})(Q);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=te(e);if(t()){var r=te(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return ee(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1},e.handleAdd=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this.props.positionList;e&&0!==e.length||this.props.getPositionList()}},{key:"render",value:function(){var e=this.state.visible,t=this.props.projectPositionDataModel,n=t.modelId,a=t.modelName;return r.a.createElement("div",{className:"edit-detail position"},r.a.createElement("p",null,n?"已关联位置数据模型":"尚未关联位置数据模型"),n?r.a.createElement("p",{className:"model-name"},a):"",r.a.createElement(u.a,{type:"primary",className:"btn-choose",onClick:this.handleAdd},"选择位置数据模型"),r.a.createElement(Y,{visible:e,onOk:this.handleOk,onCancel:this.handleCancel}))}}])&&X(t.prototype,n),a&&X(t,a),i}(),ae=Object(f.b)(function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}},function(e){return{getPositionList:function(){return e(m.a.getPositionList())}}})(ne),re=(n(188),n(75));n(64);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=re.a.Option,fe=["找不到设备","设备不在线","能力超出范围","指令超出范围","场景无法执行"],pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ue(e);if(t()){var r=ue(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return le(this,n)}}(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleClick=function(e){t.setState({tabIndex:e})},t.handleChange=function(e){var n=e.target,a=n.name,r=n.value;t.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r),function(){t.props.setRobotDetail(a,r)})},t.handleSelect=function(e){t.props.setRobotDetail("summaryId",e)},t.delVoice=function(e){var n=t.state,a=n.tabIndex,r=n.replyList;r[a]=r[a].filter(function(t,n){return n!==e}),console.log("----",r),t.setState({replyList:r},function(){t.props.setReplyList(r)})},t.editVoice=function(e,n){var a=t.state,r=a.tabIndex,o=a.replyList;o[r][n].replyInfo=e,t.setState({replyList:o},function(){t.props.setReplyList(o)})},t.addVoice=function(){var e=t.state,n=e.tabIndex,a=e.replyList,r={sceneId:n,replyIndex:1e3*Math.random()|0,replyInfo:""};a[n].push(r),t.setState({replyList:a},function(){t.props.setReplyList(a)})};var n=e.replyList;return t.state={tabIndex:0,robotId:"",robotDesc:"",replyList:n||null},t}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.replyList,n=e.projectVoiceRobot,a=n.robotId,r=n.robotDesc;a===this.state.robotId&&r===this.state.robotDesc||this.setState({robotId:a,robotDesc:r}),JSON.stringify(t)!==JSON.stringify(this.state.replyList)&&this.setState({replyList:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.tabIndex,a=t.robotId,o=t.robotDesc,i=this.props,l=i.projectVoiceRobot,u=i.summaryList,s=l.summaryId,f=l.summaryName,p=this.state.replyList||l.replyList;return console.log(u,s,f),r.a.createElement("div",{className:"edit-detail robot"},r.a.createElement("div",{className:"robot-choose"},r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"机器人ID：")),r.a.createElement(c.a,{placeholder:"请输入机器人ID",maxLength:6,value:a||l.robotId,name:"robotId",onChange:this.handleChange})),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"描述：")),r.a.createElement(c.a,{placeholder:"请输入描述",maxLength:150,value:o||l.robotDesc,name:"robotDesc",onChange:this.handleChange})),r.a.createElement("div",{className:"robot-tab-voice"},r.a.createElement("div",{className:"robot-position"},r.a.createElement("p",null,"语音机器人覆盖的最大空间区域"),r.a.createElement(re.a,{className:"robot-position-select",value:s,defaultActiveFirstOption:!!s,onChange:this.handleSelect},u&&u.length?u.map(function(e){return r.a.createElement(se,{value:e.summaryId,key:e.summaryId},e.summary)}):r.a.createElement(se,{value:s,key:s},f))),r.a.createElement("p",null,"异常场景回复语配置"),r.a.createElement("div",{className:"robot-voice-tabs"},r.a.createElement("ul",null,fe.map(function(t,a){return r.a.createElement("li",{key:t,className:a===n?"active":"",onClick:e.handleClick.bind(e,a)},r.a.createElement("span",null,t))})),r.a.createElement("div",{className:"robot-voice-list"},r.a.createElement("p",null,"回复语料（配置多条语料时随机下发）"),p&&p[n]&&p[n].map(function(t,n){return r.a.createElement("div",{className:"voice",key:"".concat(t.sceneId,"-").concat(t.replyIndex)},r.a.createElement(c.a,{placeholder:"最多输入50个字符",maxLength:50,value:t.replyInfo,onChange:function(t){return e.editVoice(t.target.value,n)}}),n>0?r.a.createElement("div",{className:"decrease",onClick:e.delVoice.bind(e,n)},r.a.createElement("p",null,"-")):null)}),r.a.createElement("div",{className:"voice-add"},r.a.createElement("span",{onClick:this.addVoice},"添加")))))))}}])&&ie(t.prototype,n),a&&ie(t,a),i}(),de=Object(f.b)(function(e){return{projectVoiceRobot:e.getIn(["projectManage","project","projectVoiceRobot"]).toJS(),summaryList:e.getIn(["projectManage","summaryList"]).toJS(),replyList:e.getIn(["projectManage","replyList"]).toJS()}},function(e){return{setRobotDetail:function(t,n){return e(m.a.setRobotDetail(t,n))},getSummaryList:function(t){return e(m.a.getSummaryList(t))},setReplyList:function(t){return e(m.a.setReplyList(t))}}})(pe);function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(s,r.a.Component);var t,n,a,l=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ve(e);if(t()){var r=ve(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return be(this,n)}}(s);function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=l.call.apply(l,[this].concat(n))).state={projectName:""},e.handleBack=function(){e.props.history.push("../list")},e.handleChange=function(t){var n=t.target.value;e.setState({projectName:n},function(){e.props.setProjectName(n)})},e.handleSave=function(){e.state.projectName?e.props.saveProject().then(function(t){t&&(k.a.success({message:"保存成功",duration:3}),e.props.history.push("../list"))}):k.a.error({message:"请输入项目名称",duration:3})},e}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match,n=t.params.projectId;+n&&this.props.getProject(n).then(function(t){var n=t.data.code,a=t.data.data;n===P.a&&e.setState({projectName:a.projectName})}),this.props.history.replace("".concat(t.url,"/product"))}},{key:"componentWillUnmount",value:function(){this.props.clearData()}},{key:"render",value:function(){var e=this.props.match,t=this.state.projectName;return r.a.createElement("div",{className:"projectmanage"},r.a.createElement(d.a,{title:"项目管理"}),r.a.createElement(i.a,{className:"het-list"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"< 返回"),r.a.createElement("h2",null,"基本信息"),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,r.a.createElement("i",{className:"dot"},"*"),"名称：")),r.a.createElement(c.a,{placeholder:"请输入名称",maxLength:20,name:"projectName",value:t,onChange:this.handleChange})),r.a.createElement("h2",{style:{marginTop:20}},"关联信息"),r.a.createElement("div",{className:"nav-list"},r.a.createElement(j.c,{to:"".concat(e.url,"/product")},"产品设备"),r.a.createElement(j.c,{to:"".concat(e.url,"/position")},"位置数据模型"),r.a.createElement(j.c,{to:"".concat(e.url,"/robot")},"语音机器人")),r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(e.path,"/product"),component:z}),r.a.createElement(o.b,{path:"".concat(e.path,"/position"),component:ae}),r.a.createElement(o.b,{path:"".concat(e.path,"/robot"),component:de}),r.a.createElement(o.a,{from:"".concat(e.path,"/"),to:"".concat(e.path,"/product")})),r.a.createElement("div",{className:"footer"},r.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:this.handleBack},"取消"))))}}])&&ye(t.prototype,n),a&&ye(t,a),s}(),Ee=Object(f.b)(function(e){return{project:e.getIn(["projectManage","project"]).toJS()}},function(e){return{getProject:function(t){return e(m.a.getProject(t))},setProjectName:function(t){return e(m.a.setProjectName(t))},clearData:function(){return e(m.a.clearData())},saveProject:function(){return e(m.a.saveProject())}}})(ge);n(1413),t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(t.url,"/list"),component:C}),r.a.createElement(o.b,{path:"".concat(t.url,"/:projectId"),component:Ee}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1480:function(e,t,n){"use strict";n.r(t);n(98),n(245);var a=n(0),r=n.n(a),o=n(108),i=(n(1412),n(94),n(38)),c=(n(121),n(58)),l=(n(809),n(449)),u=(n(211),n(81)),s=(n(72),n(21)),f=(n(210),n(90)),p=(n(44),n(45),n(23),n(37),n(19),n(34),n(39),n(32),n(40),n(35),n(36),n(26),n(27),n(28),n(42)),d=n(91),m=n(470),y=n(436);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=y.a.Option,I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(m,a["Component"]);var t,n,o,p=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=w(e);if(t()){var r=w(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return O(this,n)}}(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=p.call(this,e)).changeModelName=function(e){console.log(e.target.value),t.setState({modelName:e.target.value})},t.handleFilter=function(){var e=t.state.modelName;t.setState({query:{modelName:e}},t.onChange)},t.handleReset=function(){t.setState({modelName:"",query:{}},function(){t.refInpt.setState({value:""})})},t.onChange=function(e){t.setState({loading:!0}),t.props.getLocationList(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({pageIndex:e},t.state.query)).then(function(){t.setState({loading:!1})})},t.onEdit=function(e){t.props.history.push("/config/positionmodel/".concat(e))},t.handleDel=function(e){f.a.confirm({title:"确定删除数据",centered:!0,onOk:function(){t.props.deleteModel(e)}})},t.state={loading:!1,modelName:"",query:{}},t}return t=m,(n=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this,t=this.props,n=t.locationModelList,a=t.pager,o=this.state.loading,f=[{title:"模型ID",dataIndex:"modelId",key:"modelId",width:"100px"},{title:"名称",dataIndex:"modelName",width:"30%",key:"modelName",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"modelDesc",width:"40%",key:"modelDesc",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",key:"操作",render:function(t){return r.a.createElement("span",null,r.a.createElement(u.a,{placement:"top",title:"管理模型"},r.a.createElement(s.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.onEdit.bind(e,t.modelId)})),r.a.createElement(l.a,{type:"vertical"}),r.a.createElement(u.a,{placement:"top",title:"删除模型"},r.a.createElement(s.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.modelId)})))}}];return r.a.createElement("div",{className:"LocationDataModel_Content"},r.a.createElement(y.a,{title:"数据位置模型"},r.a.createElement(S,null,r.a.createElement(c.a,{style:{width:240},placeholder:"请输入模型名称查询",onChange:this.changeModelName.bind(this),onPressEnter:this.handleFilter.bind(this),ref:function(t){return e.refInpt=t}})),r.a.createElement(S,null,r.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleFilter.bind(this)},"查询")),r.a.createElement(S,null,r.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleReset.bind(this)},"重置")),r.a.createElement(S,{align:"right"},r.a.createElement(s.a,{className:"modelCreate",type:"primary",onClick:this.onEdit.bind(this,0)},"新建"))),r.a.createElement(i.a,{className:"LocationDataModel_bottomCard"},r.a.createElement(d.a,{rowKey:"modelId",columns:f,dataSource:n,pager:a,loading:o,onPageChange:this.onChange})))}}])&&g(t.prototype,n),o&&g(t,o),m}(),C=Object(p.b)(function(e){return{locationModelList:e.getIn(["positionModel","locationModelList"]).toJS(),pager:e.getIn(["positionModel","pager"]).toJS()}},function(e){return{getLocationList:function(t){return e(m.getLocationList(t))},deleteModel:function(t){return e(m.deleteLocation(t))}}})(I),k=(n(1349),n(1363)),j=(n(135),n(43)),P=(n(109),n(437),n(168),n(64),n(348)),x=(n(442),n(167),n(10)),L=(n(1347),n(281),n(155)),D=(n(142),n(33));n(166);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function R(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=D.a.Item,q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=A(e);if(t()){var r=A(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={selectedRowKeys:[]},e.onSelectChange=function(t){console.log("..selectedRowKeys..",t),e.setState({selectedRowKeys:t})},e.handleSave=function(){var t=e.props.form,n=e.state.selectedRowKeys;t.validateFields(function(t,a){t||e.props.onOk({elementName:a.elementName,parentIds:n})})},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.elementsItem;t&&t!==this.props.visible&&n&&(this.setState({selectedRowKeys:"string"==typeof n.parentIds?JSON.parse(n.parentIds):n.parentIds||[]}),this.props.form.setFieldsValue({elementName:n.elementName}))}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onOk,a=e.onCancel,o=e.form,i=e.list,l=o.getFieldDecorator,u={labelCol:{span:5},wrapperCol:{span:17}},p={selectedRowKeys:this.state.selectedRowKeys.filter(function(e){return i.findIndex(function(t){return t.elementId==e})>=0}),onChange:this.onSelectChange};return r.a.createElement(f.a,{width:600,visible:t,onCancel:a,onOk:n,title:"添加数据",className:"data-model",footer:null},r.a.createElement(D.a,null,r.a.createElement(F,N({},u,{label:"名称"}),l("elementName",{rules:[{required:!0,message:"请输入名称"}]})(r.a.createElement(c.a,{placeholder:"20个以内的字符",maxLength:20}))),this.props.id>0?r.a.createElement(F,N({},u,{label:"关联父层级"}),r.a.createElement(L.a,{rowKey:"elementId",size:"small",rowSelection:p,columns:[{title:"父层级数据",dataIndex:"elementName",width:1e3,textWrap:"word-break"}],pagination:!1,dataSource:i,scroll:{y:194},bordered:!1})):null,r.a.createElement(F,{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:a},"取消"))))}}])&&R(t.prototype,n),a&&R(t,a),i}(),B=D.a.create()(q);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){K(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=H(e);if(t()){var r=H(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return G(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={index:0,visible:!1,selected:[],elementsItem:null},e.onChange=function(t){e.setState({index:t})},e.onEdit=function(t){e.setState({visible:!0,elementsItem:t||null})},e.onCloseItem=function(){e.setState({visible:!1})},e.onAddItem=function(t){var n=e.state.elementsItem,a=e.props,r=a.model,o=a.modelId,i=r.summary.summaryId;r.elements&&r.elements.length>99?j.a.error({message:"单层数据不能超过100",duration:3}):n.elementId&&t.elementName==n.elementName&&t.parentIds==n.parentIds?e.setState({visible:!1}):e.props.addElement(z(z({},t),{},{elementId:n.elementId||null,summaryId:i})).then(function(t){t&&(e.props.getModelList(o),e.setState({visible:!1}))})},e}return t=i,(n=[{key:"render",value:function(){var e,t,n=this,a=this.props,o=a.model,i=a.nextItem,c=a.prevItem,l=a.id,u=o.summary,s=o.elements,f=this.state,p=f.index,d=f.visible,m=f.elementsItem,y=[];if(i.map(function(e,t){e.parentIds="string"==typeof e.parentIds?JSON.parse(e.parentIds):e.parentIds||[],e.parentIds.findIndex(function(e){return e==s[p].elementId})>=0&&y.push(t)}),y.length>0){var h=y.sort(function(e,t){return e.id-t.id});e=p<h[0]?p:h[0],t=p>h[h.length-1]?p:h[h.length-1]}return r.a.createElement("div",null,r.a.createElement("div",{className:"title"},r.a.createElement("p",{title:u.summary},u.summary)),r.a.createElement("ul",null,s.map(function(e,t){return r.a.createElement("li",{className:t==p?"active":"",key:t,onClick:n.onChange.bind(n,t)},e.elementName,r.a.createElement(x.a,{type:"edit",className:"edit",onClick:n.onEdit.bind(n,e)}))}),r.a.createElement("li",{className:"add"},r.a.createElement("p",{onClick:this.onEdit},"添加数据"))),y.length>0?r.a.createElement("svg",{className:"svg",height:50*t+100},r.a.createElement("polyline",{points:"0,".concat(50*p||1," ").concat(40,",").concat(50*p||1)}),y.map(function(e,t){return r.a.createElement("polyline",{points:"".concat(40,",").concat(50*e||1," ").concat(80,",").concat(50*e||1),key:t})}),r.a.createElement("polyline",{points:"".concat(40,",").concat(50*e," ").concat(40,",").concat(50*t)})):null,r.a.createElement(B,{visible:d,onOk:this.onAddItem,onCancel:this.onCloseItem,list:c,wrappedComponentRef:function(e){return n.form=e},elementsItem:m,id:l}))}}])&&J(t.prototype,n),a&&J(t,a),i}(),Y=Object(p.b)(null,function(e){return{addElement:function(t){return e(P.a.addElement(t))},getModelList:function(t){return e(P.a.getLocationDetailList(t))}}})(Q);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Z(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function te(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ae=D.a.Item,re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ne(e);if(t()){var r=ne(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return te(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleSave=function(){e.props.form.validateFields(function(t,n){t||e.props.onOk(n)})},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.summary;t&&t!==this.props.visible&&n&&this.props.form.setFieldsValue({summary:n.summary})}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=e.onCancel,o=e.onOk,i=t.getFieldDecorator;return r.a.createElement(f.a,{width:600,visible:n,onCancel:a,onOk:o,title:"编辑数据",className:"data-model",footer:null},r.a.createElement(D.a,null,r.a.createElement(ae,X({},{labelCol:{span:5},wrapperCol:{span:15}},{label:"名称"}),i("summary",{rules:[{required:!0,message:"请输入名称"}]})(r.a.createElement(c.a,{placeholder:"20个以内的字符",maxLength:20}))),r.a.createElement(ae,{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),r.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:a},"取消"))))}}])&&Z(t.prototype,n),a&&Z(t,a),i}(),oe=D.a.create()(re);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=se(e);if(t()){var r=se(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return ue(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1,summaryItem:null},e.onAddGroup=function(t){var n,a=e.props,r=a.modelId,o=a.model,i=e.state.summaryItem,c=o.length,l=c>0&&i?o.findIndex(function(e){return e.summary.summaryId==i.summaryId}):void 0;n=l?o[l-1].summary.summaryId:void 0;var u={summaryId:i?i.summaryId:null,summary:t.summary,modelId:r,parentId:i?n:c>0?o[c-1].summary.summaryId:void 0};e.props.saveSummary(u).then(function(t){0===t?e.onCloseGroup():j.a.error({message:"保存数据失败",duration:3})})},e.onCloseGroup=function(){e.form.props.form.resetFields(),e.setState({visible:!1,summaryItem:null})},e.onEdit=function(t){var n=e.props,a=n.modelId,r=n.model;+a?t&&t.summary||!(r.length>9)?(t&&t.summary&&e.setState({summaryItem:t.summary}),e.setState({visible:!0})):j.a.error({message:"层级数不得超过十",duration:3}):j.a.error({message:"请先保存基本信息",duration:3})},e.handleDel=function(t){var n=e.props.modelId;f.a.confirm({title:"是否删除层级？",centered:!0,onOk:function(){e.props.delSummary(t.summaryId).then(function(t){t&&e.props.getModelList(n)})}})},e}return t=i,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.model,a=t.modelId,o=this.state,i=o.visible,c=o.summaryItem;return r.a.createElement("div",{className:"data-model"},n&&n.length>0?n.map(function(t,o){return r.a.createElement("div",{className:"data-model-item",key:o},r.a.createElement("h2",null,"第".concat("一二三四五六七八九十"[o],"层级")),r.a.createElement(Y,{model:t,id:o,nextItem:n[o+1]?n[o+1].elements:[],onEdit:e.onEditItem,prevItem:o>0?n[o-1].elements:[],modelId:a}),r.a.createElement("div",{className:"footer"},r.a.createElement("a",{className:"edit",onClick:e.onEdit.bind(e,t)},"编辑"),r.a.createElement("a",{className:"delete",onClick:e.handleDel.bind(e,t.summary)},"删除")))}):r.a.createElement("div",{className:"data-model-item"},r.a.createElement("div",{className:"title"},r.a.createElement("a",{onClick:this.onEdit},"点击添加"))),n&&n.length>0?r.a.createElement("div",{className:"data-model-item add"},r.a.createElement("a",{onClick:this.onEdit.bind(this)},"添加子层级")):null,r.a.createElement(oe,{visible:i,onOk:this.onAddGroup,onCancel:this.onCloseGroup,wrappedComponentRef:function(t){return e.form=t},summary:c}))}}])&&ce(t.prototype,n),a&&ce(t,a),i}(),pe=Object(p.b)(function(e){return{model:e.getIn(["positionModel","model"]).toJS()}},function(e){return{saveSummary:function(t){return e(P.a.saveSummary(t))},delSummary:function(t){return e(P.a.delSummary(t))},getModelList:function(t){return e(P.a.getLocationDetailList(t))}}})(fe),de=n(4);function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge="/manage-open",Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(u,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ve(e);if(t()){var r=ve(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return be(this,n)}}(u);function u(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={modelName:"",modelDesc:"",editid:-1,editkey:"",editval:"",addkey:"",addval:"",delLabelId:"",deleteLoading:!1,dellabelKey:"",dellabelValue:"",keylist:[],valuesource:[]},e.handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},a,r))},e.handleSave=function(){var t=e.state,n=t.modelName,a=t.modelDesc,r=e.props.match.params.modelId;n?e.props.saveModelDetail({modelName:n,modelDesc:a,modelId:parseInt(r)||""}).then(function(t){0===t&&(j.a.success({message:"保存数据成功",duration:3}),0==r&&e.props.getLocationList().then(function(t){if(t){var n=(t.list?t.list[0]:{}).modelId;n&&e.props.history.replace("/config/positionmodel/".concat(n))}}))}):j.a.error({message:"位置数据模型名称不能为空",duration:3})},e.handleBack=function(){e.props.history.go(-1)},e}return t=u,(n=[{key:"componentDidMount",value:function(){var e=this.props.match.params.modelId,t=this;this.props.resetModelList(),this.getLabelKeyList(),+e&&(this.props.getModelDetail(e).then(function(e){if(e){var n=e.modelName,a=e.modelDesc;t.setState({modelName:n,modelDesc:a})}}),this.props.getModelList(e),this.props.getModLabelList(e))}},{key:"getLabeListHtml",value:function(){var e=this,t=this.props.modList||[],n=this.state,a=n.editid,o=n.editkey,i=n.editval,c=n.valuesource;return t.map(function(t,n){var u=t.relaId,s=t.keyName,f=t.valueName;return u==a?r.a.createElement("tr",{key:"tr_"+n},r.a.createElement("td",null,r.a.createElement(k.a,{value:o,dataSource:e.getKeySource(),style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editkey"),placeholder:"Key",filterOption:!0})),r.a.createElement("td",null,r.a.createElement(k.a,{value:i,dataSource:c,style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editval"),placeholder:"Value",filterOption:!0})),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:e.editConfirm.bind(e,s,f)},"确认"),r.a.createElement(l.a,{type:"vertical"}),r.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,-1,"","")},"取消"))):r.a.createElement("tr",{key:"tr_"+n},r.a.createElement("td",null,s),r.a.createElement("td",null,f),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,u,s,f)},"编辑"),r.a.createElement(l.a,{type:"vertical"}),r.a.createElement("a",{href:"javascript:",onClick:function(){return e.openDelMod(u,s,f)}},"删除")))})}},{key:"openDelMod",value:function(e,t,n){var a=this,r=this.props.match.params.modelId;f.a.confirm({title:"是否删除该标签？",centered:!0,onOk:function(){de.c.Get(ge+"/position/label/rela/delete",{relaId:e}).then(function(e){0==e.data.code&&a.props.getModLabelList(r)})}})}},{key:"addConfirm",value:function(){var e=this,t=this.state,n=t.addkey,a=t.addval;if(""==n||""==a)return j.a.warning({message:"请将正在添加的标签输入框补充完整",duration:3}),!1;var r=this.props.match.params.modelId;de.c.Get(ge+"/position/label/rela/save",{modelId:r,keyName:n,valueName:a}).then(function(t){0==t.data.code&&(e.setState({addkey:"",addval:""}),e.props.getModLabelList(r),e.getLabelKeyList())})}},{key:"editLabel",value:function(e,t,n){this.setState({editid:e,editkey:t,editval:n})}},{key:"editConfirm",value:function(e,t){var n=this,a=this.state,r=a.editid,o=a.editkey,i=a.editval,c=this.props.match.params.modelId;""==o&&""==i&&j.a.warning({message:"请将标签编辑输入框补充完整",duration:3}),de.c.Get(ge+"/position/label/rela/save",{modelId:c,relaId:r,keyName:o||e,valueName:i||t}).then(function(e){0==e.data.code&&(n.setState({editid:-1,editkey:"",editval:""}),n.props.getModLabelList(c),n.getLabelKeyList())})}},{key:"getDataSource",value:function(e){}},{key:"getKeySource",value:function(){return this.state.keylist.map(function(e,t){return e.keyName})}},{key:"getLabelKeyList",value:function(){var e=this;de.c.Get(ge+"/position/label/key/getList",{}).then(function(t){if(0==t.data.code){var n=t.data.data||[];e.setState({keylist:n})}})}},{key:"getValueSource",value:function(e){var t=this,n="-1";this.state.keylist.forEach(function(t){t.keyName==e&&(n=t.keyId)}),console.log(n),"-1"!==n?de.c.Get(ge+"/position/label/value/getList",{keyId:n}).then(function(e){if(0==e.data.code){var n=(e.data.data||[]).map(function(e,t){return e.valueName});t.setState({valuesource:n})}}):this.setState({valuesource:[]})}},{key:"onChangeInput",value:function(e,t){if(t&&t.length>20)return!1;var n={};n[e]=t,this.setState(n),"addkey"!=e&&"editkey"!=e||this.getValueSource(t)}},{key:"render",value:function(){var e=this.props.match.params.modelId,t=this.state,n=t.modelName,a=t.modelDesc,o=t.addkey,l=t.addval,u=t.valuesource;return r.a.createElement("div",{className:"location-data"},r.a.createElement(y.a,{title:"".concat("0"!==e?"管理":"新建","位置数据模型")}),r.a.createElement(i.a,{className:"location-detail"},r.a.createElement("div",{className:"het-list"},r.a.createElement(s.a,{type:"primary",className:"btn-back",onClick:this.handleBack.bind(this)},"返回"),r.a.createElement("h2",null,"基本信息"),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null," ",r.a.createElement("i",{className:"dot"},"*"),"名称：")),r.a.createElement(c.a,{placeholder:"请输入名称",value:n,maxLength:20,name:"modelName",onChange:this.handleChange})),r.a.createElement("div",{className:"form-item"},r.a.createElement("p",{className:"label"},r.a.createElement("span",null,"描述：")),r.a.createElement(c.a.TextArea,{placeholder:"请输入名称",value:a,maxLength:100,name:"modelDesc",onChange:this.handleChange})),r.a.createElement("div",{className:"footer"},r.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"))),r.a.createElement("div",{className:"het-list"},r.a.createElement("h2",null,"数据模型"),r.a.createElement(pe,{modelId:e})),+e>0&&r.a.createElement("div",{className:"het-list"},r.a.createElement("h2",null,"标签管理"),r.a.createElement("table",{className:"labeltable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"38%"}},"标签Key"),r.a.createElement("th",{style:{width:"38%"}},"标签Value"),r.a.createElement("th",{style:{width:"24%"}},"管理"))),r.a.createElement("tbody",null,this.getLabeListHtml(),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(k.a,{value:o,dataSource:this.getKeySource(),style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addkey"),placeholder:"Key",maxLength:"20",filterOption:!0})),r.a.createElement("td",null,r.a.createElement(k.a,{value:l,dataSource:u,style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addval"),placeholder:"Value",maxLength:"20",filterOption:!0})),r.a.createElement("td",null,r.a.createElement("a",{href:"javascript:",onClick:this.addConfirm.bind(this)},"确认"))))))))}}])&&ye(t.prototype,n),a&&ye(t,a),u}(),Oe=Object(p.b)(function(e){return{modelDetail:e.getIn(["positionModel","modelDetail"]).toJS(),modList:e.getIn(["positionModel","modList"]).toJS()}},function(e){return{getModelDetail:function(t){return e(P.a.getLocationDetail(t))},saveModelDetail:function(t){return e(P.a.saveLocationDetail(t))},getLocationList:function(){return e(P.a.getLocationList())},getModelList:function(t){return e(P.a.getLocationDetailList(t))},resetModelList:function(){return e(P.a.resetModelList())},getModLabelList:function(t){return e(P.a.getModLabelList(t))}}})(Ee),we=n(1366);t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/list"),component:C}),r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/:modelId"),component:Object(we.a)(Oe)}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1488:function(e,t,n){"use strict";n.r(t);n(98),n(245);var a=n(0),r=n.n(a),o=n(108),i=(n(94),n(38)),c=(n(142),n(33)),l=(n(211),n(81)),u=(n(72),n(21)),s=(n(135),n(43)),f=(n(188),n(75)),p=(n(109),n(64),n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28),n(42)),d=n(436),m=n(91),y=n(468),h=(n(210),n(90)),b=(n(121),n(58));n(168),n(166);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=c.a.Item,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=S(e);if(t()){var r=S(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return w(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).onCancel=function(){var t=e.props,n=t.form,a=t.onCancel;n.resetFields(),a()},e.onOk=function(){e.props.form.validateFields(function(t,n){if(!t){var a=n.applyAllocated,r=n.allocationDesc,o=e.props.macItem,i=o.hetModuleTypeId,c=o.macAllocationId;e.props.onOk({applyAllocated:a,allocationDesc:r,hetModuleTypeId:i,macAllocationId:c})}})},e.handleCheck=function(t,n,a){var r=e.props.macItem.remainAllocated;n>r||"0"===n?a("只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(r)):a()},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.macItem,a=e.visible,o=t.getFieldDecorator,i=n||{},u=i.hetName,s=i.remainAllocated,f={labelCol:{span:6},wrapperCol:{span:14}};return r.a.createElement(h.a,{width:600,visible:a,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},r.a.createElement(c.a,null,r.a.createElement(I,g({label:"模组型号"},f),o("hetName",{initialValue:u})(r.a.createElement(b.a,{disabled:!0}))),r.a.createElement(I,g({label:"申请数量"},f),r.a.createElement(l.a,{placement:"right",title:"只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(s),overlayStyle:{width:300}},o("applyAllocated",{rules:[{required:!0,message:"请输入申请数量"},{validator:this.handleCheck}],getValueFromEvent:function(e){return e.target.value.replace(/[^\d]/,"")}})(r.a.createElement(b.a,{placeholder:"请输入申请数量",maxLength:5})))),r.a.createElement(I,g({label:"申请描述"},f),r.a.createElement(l.a,{placement:"right",title:"最多支持输入50个字符。",overlayStyle:{width:300}},o("allocationDesc",{rules:[{required:!0,message:"请输入申请描述"}]})(r.a.createElement(b.a.TextArea,{maxLength:50,placeholder:"请输入申请描述",style:{height:100}}))))))}}])&&E(t.prototype,n),a&&E(t,a),i}(),k=c.a.create()(C);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N=c.a.Item,R=f.a.Option,_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=T(e);if(t()){var r=T(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return D(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).onCancel=function(){var t=e.props,n=t.form,a=t.onCancel;n.resetFields(),a()},e.onOk=function(){e.props.form.validateFields(function(t,n){t||e.props.onOk(n)})},e.handleCheck=function(e,t,n){/^[0-9A-F]{2}$/.test(t)||n("只能输入两位数的十六进制[0-9、A~F]"),n()},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=e.moduleList,o=t.getFieldDecorator,i={labelCol:{span:8},wrapperCol:{span:14}};return r.a.createElement(h.a,{width:600,visible:n,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},r.a.createElement(c.a,null,r.a.createElement(N,P({label:"模组型号"},i),o("hetModuleTypeId",{rules:[{required:!0,message:"请选择模组型号"}]})(r.a.createElement(f.a,{placeholder:"请选择"},a.map(function(e){return r.a.createElement(R,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)})))),r.a.createElement(N,P({label:"MAC地址（第四字节）"},i),r.a.createElement(l.a,{placement:"right",title:"只能输入两位数的十六进制[0-9、A~F]",overlayStyle:{width:300}},o("productCode",{rules:[{min:2,max:2,required:!0,message:"请MAC地址（第四字节）"},{validator:this.handleCheck}],getValueFromEvent:function(e){return String.prototype.toLocaleUpperCase.call(e.target.value.substr(0,2).replace(/[^0-9a-fA-F]/,""))}})(r.a.createElement(b.a,{maxLength:2,placeholder:"MAC地址（第四字节）"}))))))}}])&&x(t.prototype,n),a&&x(t,a),i}(),M=c.a.create()(_),A=n(31),F=n(1365);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=f.a.Option,J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(p,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=z(e);if(t()){var r=z(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return U(this,n)}}(p);function p(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={loading:!1,moduleId:"",query:{},visible:!1,macItem:null,addVisible:!1},e.handleDetail=function(t){var n=t.hetModuleTypeId,a=t.productCode;e.props.history.push("./".concat(n,"/").concat(a))},e.handleEdit=function(t){e.setState({visible:!0,macItem:t})},e.onCancel=function(){e.setState({macItem:null,visible:!1})},e.handleAdd=function(){e.setState({addVisible:!0})},e.handleAddCancel=function(){e.setState({addVisible:!1})},e.onOk=function(t){console.log("----",t),e.props.macAllocation(t).then(function(t){t&&(s.a.success({message:"分配成功",duration:3}),e.props.onChange(1),e.onCancel())})},e.handleAddMac=function(t){e.props.addMac(t).then(function(t){t&&(s.a.success({message:"新增MAC成功",duration:3}),e.props.onChange(1),e.handleAddCancel())})},e}return t=p,(n=[{key:"componentDidMount",value:function(){this.props.getModuleList()}},{key:"render",value:function(){var e=this,t=this.state,n=(t.moduleId,t.visible),a=t.macItem,o=t.addVisible,s=this.props,p=s.macList,y=s.pager,h=s.moduleList,b=s.form,v=s.loading,g=b.getFieldDecorator,E=[{title:"模组型号",dataIndex:"hetName",width:"15%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"MAC地址（第4字节）",dataIndex:"productCode",width:"10%",className:"th-break"},{title:r.a.createElement("span",{title:"起始MAC"},"起始MAC"),dataIndex:"macBegin",width:"125px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:r.a.createElement("span",{title:"结束MAC"},"结束MAC"),dataIndex:"macEnd",width:"125px",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"MAC总量",dataIndex:"maxinumAvailable",width:"10%"},{title:"已分配数",dataIndex:"quantityAllocated",width:"10%"},{title:"未分配数",dataIndex:"remainAllocated",width:"10%"},{title:"修改时间",dataIndex:"updateTime",width:"15%",className:"th-break",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"创建时间",dataIndex:"createTime",width:"15%",className:"th-break",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",fixed:"right",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(l.a,{placement:"top",title:"分配"},r.a.createElement(u.a,{icon:"apartment",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",r.a.createElement(l.a,{placement:"top",title:"查看"},r.a.createElement(u.a,{icon:"info",shape:"circle",size:"small",onClick:e.handleDetail.bind(e,t)})))}}];return r.a.createElement("div",{className:"macList"},r.a.createElement(d.a,{title:"和而泰MAC分配"},r.a.createElement(c.a,{layout:"inline"},r.a.createElement(c.a.Item,{label:"模组型号"},g("hetModuleTypeId")(r.a.createElement(f.a,{style:{width:240},placeholder:"请选择模组型号"},r.a.createElement(K,{key:"",value:""},"全部"),h.map(function(e){return r.a.createElement(K,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)})))),r.a.createElement(c.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),r.a.createElement(c.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),r.a.createElement(c.a.Item,{style:{float:"right"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleAdd},"新建")))),r.a.createElement(i.a,null,r.a.createElement(m.a,{rowKey:"macAllocationId",columns:E,dataSource:p,pager:y,onPageChange:this.props.onChange,loading:v,scroll:{x:1200,y:"auto"}})),r.a.createElement(k,{visible:n,macItem:a,onCancel:this.onCancel,onOk:this.onOk}),r.a.createElement(M,{visible:o,moduleList:h,onCancel:this.handleAddCancel,onOk:this.handleAddMac}))}}])&&B(t.prototype,n),a&&B(t,a),p}(),W=Object(p.b)(function(e){return{macList:e.getIn(["macAllocation","macList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS(),moduleList:e.getIn(["macAllocation","moduleList"]).toJS(),loading:e.getIn(["macAllocation","loading"])}},function(e){return{getList:function(t){return e(y.a.getMacList(t))},getModuleList:function(){return e(y.a.getModuleList())},macAllocation:function(t){return e(y.a.macAllocation(t))},addMac:function(t){return e(y.a.addMac(t))}}})(c.a.create()(Object(F.a)(J)));function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(c,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=$(e);if(t()){var r=$(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Y(this,n)}}(c);function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={hetModuleTypeId:"",productCode:"",loading:!1},e.onChange=function(t){var n=e.props.match.params,a=n.hetModuleTypeId,r=n.productCode;e.setState({loading:!0}),e.props.getMacDetailList({hetModuleTypeId:a,productCode:r,pageIndex:t}).then(function(){e.setState({loading:!1})})},e.handleBack=function(){e.props.history.go(-1)},e}return t=c,(n=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this.state.loading,t=this.props,n=t.macDetailList,a=t.pager,o=[{title:"MAC起始地址",dataIndex:"macBegin",width:"15%"},{title:"MAC结束地址",dataIndex:"macEnd",width:"15%"},{title:"申请数量",dataIndex:"allocationCount",width:"10%"},{title:"描述",dataIndex:"allocationDesc",width:"30%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"创建时间",dataIndex:"createTime",width:"20%",render:function(e){var t=A.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",null,t)}},{title:"操作",render:function(e){return r.a.createElement("div",{className:"action"},r.a.createElement("a",{href:"/v1/web/manage-open/mac/allocation/excelExport?macBegin=".concat(e.macBegin,"&macEnd=").concat(e.macEnd),target:"blank"},"导出"))}}];return r.a.createElement("div",{className:"macList"},r.a.createElement(d.a,{title:"MAC详情"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),r.a.createElement(i.a,null,r.a.createElement(m.a,{rowKey:"macAllocationId",pagination:!1,columns:o,dataSource:n,pager:a,onPageChange:this.onChange,loading:e})))}}])&&H(t.prototype,n),a&&H(t,a),c}(),Z=Object(p.b)(function(e){return{macDetailList:e.getIn(["macAllocation","macDetailList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS()}},function(e){return{getMacDetailList:function(t){return e(y.a.getMacDetailList(t))},exportList:function(){return e(y.a)}}})(X);n(1414),t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"".concat(t.url,"/list"),component:W}),r.a.createElement(o.b,{path:"".concat(t.url,"/:hetModuleTypeId/:productCode"),component:Z}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1492:function(e,t,n){"use strict";n.r(t);n(98),n(245);var a=n(0),r=n.n(a),o=n(108),i=(n(142),n(33)),c=(n(121),n(58)),l=(n(211),n(81)),u=(n(72),n(21)),s=(n(210),n(90)),f=(n(109),n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28),n(42)),p=n(436),d=n(91),m=n(143),y=n(461),h=n(31),b=n(1365);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(f,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=S(e);if(t()){var r=S(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return O(this,n)}}(f);function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleEdit=function(t){e.props.history.push("./".concat(t.roleId||0)),e.props.setRoleDetail(t)},e.handleDel=function(t){var n=w(e);s.a.confirm({title:"提示",content:"是否确认删除？",onOk:function(){console.log("确认删除"),n.props.delRole(t)}})},e}return t=f,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.roleList,a=t.pager,o=t.loading,s=t.form.getFieldDecorator,f=[{title:"角色名",dataIndex:"roleName",width:"20%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"角色备注",dataIndex:"remark",width:"35%",render:function(e){return r.a.createElement("span",{title:e},e)}},{title:"最新修改时间",dataIndex:"modifyTime",width:"30%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return r.a.createElement("span",{title:t},t)}},{title:"操作",render:function(t){return r.a.createElement("div",{className:"action"},r.a.createElement(l.a,{placement:"top",title:"编辑"},r.a.createElement(u.a,{icon:"edit",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",r.a.createElement(l.a,{placement:"top",title:"删除"},r.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small",onClick:e.handleDel.bind(e,t.roleId)})))}}];return r.a.createElement("div",{className:"interface-role"},r.a.createElement(p.a,{title:"接口访问用户角色"},r.a.createElement(i.a,{layout:"inline"},r.a.createElement(i.a.Item,{label:"角色名"},s("roleName")(r.a.createElement(c.a,{placeholder:"请输入角色名",maxLength:20,style:{width:240},onPressEnter:this.props.onFilter}))),r.a.createElement(i.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),r.a.createElement(i.a.Item,null,r.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),r.a.createElement(i.a.Item,{style:{float:"right"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleEdit.bind(this,{})},"新建")))),r.a.createElement("div",{className:"interface-role-content"},r.a.createElement(d.a,{rowKey:"roleId",columns:f,dataSource:n,pager:a,loading:o,onPageChange:this.props.onChange})))}}])&&g(t.prototype,n),a&&g(t,a),f}(),C=Object(f.b)(function(e){return{roleList:e.getIn(["interfaceRole","roleList"]).toJS(),pager:e.getIn(["interfaceRole","pager"]).toJS(),loading:e.getIn(["interfaceRole","loading"])}},function(e){return Object(m.b)({getList:y.a.getList,setRoleDetail:y.a.setRoleDetail,delRole:y.a.delRole},e)})(i.a.create()(Object(b.a)(I))),k=(n(135),n(43)),j=(n(37),n(34),n(39),n(32),n(40),n(188),n(75)),P=(n(64),n(244),n(340),n(341),n(285),n(246),n(339),n(790),n(791),n(792),n(793),n(794),n(795),n(796),n(797),n(798),n(799),n(800),n(801),n(802),n(803),n(804),n(805),n(806),n(442),n(1368)),x=n(97);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?R(e):t}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var A=i.a.Item,F=j.a.Option,q=function e(t){return t&&t.map(function(t){return{id:t.boxId,name:(t.boxName||t.groupName||"").split("#")[0],children:e(t.subBoxs)}})},B=function e(t,n,a,r){return t&&t.map(function(t){(t.boxName&&t.boxName.indexOf(a)>=0||t.groupName&&t.groupName.indexOf(a)>=0)&&n.push(r+t.boxId),e(t.subBoxs,n,a,r+t.boxId+"-")})},V=function e(t,n){return t&&t.length&&t.map(function(t){t.checked=n.includes(t.boxId+""),e(t.subBoxs,n)})};var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(i,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=_(e);if(t()){var r=_(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return N(this,n)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).changeMenu=function(e){t.setState({menuCode:e,searchStr:""},function(){t.refInput.setState({value:"",expandedKeys:[]})}),"dataDimension"===e?t.setState({searchType:x.a.Label}):"dataObject"===e&&t.setState({searchType:x.a.Product})},t.changeKey=function(e){var n=e.target.value,a=t.state.menuCode,r=t.props.authTree,o=r&&r.length?a||r[0].menuCode:"",i=r.find(function(e){return e.menuCode===o}),c=i?i.checkBoxGroupList:[];t.setState({searchStr:n},function(){if(""!==n){var e=[];B(c,e,n,"");var a=[];e.map(function(e){var t=e.split("-").slice(0,-1),n="";t.forEach(function(e){n+=e,a.push(n),n+="-"})});var r=Array.from(new Set(a));t.refTree.setState({expandedKeys:r})}else t.refTree.setState({expandedKeys:[],selectedKeys:[]})})},t.handleSearchType=function(e){t.setState({searchType:e},function(){t.refInput.setState({value:""})})},t.handleSearch=Object(h.h)(function(e){var n=t.state.searchType;t.props.searchAuth({type:n,typeName:e}).then(function(n){t.changeKey({target:{value:e}})})},800),t.handleChange=function(e,n){var a,r,o,i,c=t.props,l=c.authTree,u=c.authCheck,s=t.state.menuCode,f=l&&l.length?s||l[0].menuCode:"",p=l.findIndex(function(e){return e.menuCode===f}),d=(a=u[p],r=e,o=a.filter(function(e){return!r.includes(e)}),i=r.filter(function(e){return!a.includes(e)}),[].concat(M(o),M(i)));t.props.setAuthTreeCheck([].concat(M(u.slice(0,p)),[e],M(u.slice(p+1)))),"dataDimension"!==f&&"dataObject"!==f?t.props.setTargetTreeCheck([].concat(M(u.slice(0,p)),[e],M(u.slice(p+1)))):t.props.mergeToTargetTree(p,d,n.checked)},t.handleClear=function(){var e=t.props,n=e.targetCheck,a=e.authTree,r=e.authCheck,o=t.state.menuCode,i=a&&a.length?o||a[0].menuCode:"";a.findIndex(function(e){return e.menuCode===i});t.props.setAuthTreeCheck(r.map(function(e){return[]})),t.props.setTargetTreeCheck(n.map(function(e){return[]}))},t.handleSave=function(){var e=t.props,n=e.targetTree,a=e.targetCheck,r=Object(h.i)(n),o=a.reduce(function(e,t){return e.concat(t)},[]),i=[];return o.map(function(e){var t=e.split("-").slice(1);i=i.concat(t)}),i=Array.from(new Set(i)),r&&r.map(function(e){"hideData"!==e.menuCode&&V(e.checkBoxGroupList,i)}),r.reduce(function(e,t){return e.concat(t.checkBoxGroupList)},[])},t.state={menu:"",menuCode:"",menuIndex:0,searchStr:"",searchType:x.a.Product},t.props.onRef(R(t)),t}return t=i,(n=[{key:"componentWillUnmount",value:function(){this.props.clearRoleData()}},{key:"render",value:function(){var e=this,t=this.props,n=t.targetTree,a=t.targetCheck,o=t.authTree,i=t.authCheck,l=this.state,u=l.searchStr,s=l.searchType,f=l.menuCode,p={width:300},d={dataDimension:r.a.createElement(c.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t},style:p}),dataObject:r.a.createElement(c.a.Group,{compact:!0,className:"auth-key",style:p},r.a.createElement(j.a,{style:{width:110},value:s,onChange:this.handleSearchType},r.a.createElement(F,{key:"product",value:x.a.Product},"产品"),r.a.createElement(F,{key:"app",value:x.a.App},"APP应用"),r.a.createElement(F,{key:"appWeChat",value:x.a.AppWeChat},"微信小程序")),r.a.createElement(c.a,{style:{width:190},placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t}}))},m=o&&o.length?f||o[0].menuCode:"",y=o.findIndex(function(e){return e.menuCode===m}),h=[];y>=0&&(h=q(o[y].checkBoxGroupList),q(n[y].checkBoxGroupList));var b=n.map(function(e,t){return{id:e.menuCode,name:e.menuName,children:q(e.checkBoxGroupList)}}),v=a.map(function(e,t){return e.map(function(e){return n[t].menuCode+"-"+e})}).reduce(function(e,t){return e.concat(t)},[]);return r.a.createElement(A,{label:"权限配置"},r.a.createElement("div",{className:"interface-role-search"},r.a.createElement(j.a,{className:"auth-api",onChange:this.changeMenu,style:{width:180},value:m},o&&o.length?o.map(function(e){return r.a.createElement(F,{key:e.menuCode,value:e.menuCode},e.menuName)}):r.a.createElement(F,{key:"",value:""},"")),["dataDimension","dataObject"].includes(m)?d[m]:r.a.createElement(c.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:this.changeKey,ref:function(t){return e.refInput=t},style:p})),r.a.createElement("div",{className:"interface-role-auth"},r.a.createElement("div",{className:"tree-transfer"},r.a.createElement("div",{className:"tree-transfer-wraper"},r.a.createElement(P.a,{dataSource:h,target:i[y],onChange:this.handleChange,ref:function(t){return e.refTree=t},searchStr:u})),r.a.createElement("h3",{className:"tree-transfer-tab"},r.a.createElement("span",null,"已选权限"),r.a.createElement("span",{className:"btn-clear",onClick:this.handleClear},"全部清除")),r.a.createElement("div",{className:"tree-transfer-wraper"},r.a.createElement(P.a,{dataSource:b,target:v,isCheck:!1,isExpand:!0})))))}}])&&D(t.prototype,n),a&&D(t,a),i}(),z=Object(f.b)(function(e){return{authTree:e.getIn(["interfaceRole","authTree"]).toJS(),authCheck:e.getIn(["interfaceRole","authCheck"]).toJS(),targetTree:e.getIn(["interfaceRole","targetTree"]).toJS(),targetCheck:e.getIn(["interfaceRole","targetCheck"]).toJS()}},function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,setRoleAuthTarget:y.a.setRoleAuthTarget,searchAuth:y.a.searchAuth,setAuthTreeCheck:y.a.setAuthTreeCheck,setTargetTreeCheck:y.a.setTargetTreeCheck,mergeToTargetTree:y.a.mergeToTargetTree,clearRoleData:y.a.clearRoleData},e)})(U);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach(function(t){G(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X=i.a.Item,Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(l,r.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=$(e);if(t()){var r=$(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Y(this,n)}}(l);function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).state={isChecked:!1},e.handleBack=function(){e.props.history.go(-1)},e.handleSave=function(){var t=e.props,n=t.form,a=t.roleDetail;n.validateFields(function(t,n){if(!t)if(n.roleName){var r=e.refSet.handleSave();e.props.saveRole(W(W({roleId:a.roleId||void 0},n),{},{dataJson:JSON.stringify(r)})).then(function(t){t&&(k.a.success({duration:3,message:"保存成功"}),e.props.history.go(-1))})}else k.a.error({duration:3,message:"角色名不能为空"})})},e}return t=l,(n=[{key:"componentDidMount",value:function(){var e=this.props.match.params.roleId;this.props.getRoleAuth(+e),+e&&this.props.getRoleDetail(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,a=t.roleDetail,o=n.getFieldDecorator;return r.a.createElement("div",{className:"interface-role"},r.a.createElement(p.a,{title:"用户角色"},r.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),r.a.createElement("div",{className:"interface-role-content"},r.a.createElement(i.a,null,r.a.createElement(X,{label:"用户角色名"},o("roleName")(r.a.createElement(c.a,{style:{width:500},placeholder:"20个字符以内",maxLength:20}))),r.a.createElement(X,{label:"角色备注"},o("remark")(r.a.createElement(c.a,{style:{width:500},placeholder:"不超过100个字符",maxLength:100}))),r.a.createElement(z,{onRef:function(t){return e.refSet=t}}),r.a.createElement(X,{style:{textAlign:"center"}},r.a.createElement(u.a,{type:"primary",onClick:this.handleSave},a.roleId?"保存":"创建用户角色"),r.a.createElement(u.a,{type:"default",style:{marginLeft:20},onClick:this.handleBack},"取消")))))}}])&&H(t.prototype,n),a&&H(t,a),l}(),ee=Object(f.b)(function(e){return{roleDetail:e.getIn(["interfaceRole","roleDetail"]).toJS()}},function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,getRoleDetail:y.a.getRoleDetail,modifyRoleDetail:y.a.modifyRoleDetail,saveRole:y.a.saveRole},e)})(i.a.create({mapPropsToFields:function(e){return e.roleDetail?{roleName:i.a.createFormField({value:e.roleDetail.roleName}),remark:i.a.createFormField({value:e.roleDetail.remark})}:null},onFieldsChange:function(e,t){for(var n in t)e.modifyRoleDetail(G({},n,t[n].value))}})(Z)),te=(n(1415),n(1366));t.default=function(e){var t=e.match;return r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/list"),component:C}),r.a.createElement(o.b,{exact:!0,path:"".concat(t.url,"/:roleId"),component:Object(te.a)(ee)}),r.a.createElement(o.a,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1497:function(e,t,n){"use strict";n.r(t);n(44),n(94);var a=n(38),r=(n(807),n(345)),o=(n(98),n(245),n(64),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28),n(0)),i=n.n(o),c=(n(72),n(21)),l=(n(1335),n(1339)),u=(n(121),n(58)),s=(n(142),n(33)),f=(n(210),n(90)),p=(n(188),n(75)),d=(n(109),n(37),n(1340),n(34),n(39),n(32),n(40),n(166),n(42)),m=n(456),y=n(201);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=p.a.Option,k=f.a.confirm,j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(f,o["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=I(e);if(t()){var r=I(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return S(this,n)}}(f);function f(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).generateOptions=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(C,{value:e.moduleBrandId,key:e.moduleBrandId},e.brandName)})},e.saveModuleInfo=function(){var t=e.props,n=t.moduleInfo,a=t.form.validateFields;n&&n.moduleId?a(function(t,n){t||e.props.changeCurrent()}):a(function(t,n){if(!t){console.log("第一步提交了====",n);var a=g(g({},n),{},{stepIndex:1});Object(y.j)(a).then(function(t){var n=t.data;if(0===n.code){var a=n.data.moduleId;e.props.getModuleInfo(a),e.props.changeCurrent()}})}})},e.canleClick=function(){k({title:"当前编辑信息未保存，是否继续退出",content:"",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){e.props.goBack()},onCancel:function(){}})},e.checkNumber=function(e,t,n){t<0?n("仅允许输入正整数"):n()},e}return t=f,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,n=t.moduleInfo,a=t.brandItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,b({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"模组生产厂家"},e("moduleBrandId",{rules:[{required:!0,message:"请选择模组生产厂家"}]})(i.a.createElement(p.a,{placeholder:"请选择模组生产厂家"},this.generateOptions(a)))),i.a.createElement(s.a.Item,{label:"模组型号"},e("hetModuleTypeName",{rules:[{required:!0,message:"请输入模组型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"模组IC型号"},e("originalModuleTypeName",{rules:[{required:!0,message:"请输入模组IC型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组IC型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"适用范围"},e("applyScope",{rules:[{required:!0,message:"请输入模组适用范围"},{type:"string",max:50,message:"上限20个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组适用范围，如：家电产品",maxLength:50}))),i.a.createElement(s.a.Item,{className:"moduleSize",label:"模组尺寸"},i.a.createElement(s.a.Item,{label:"",style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeWidth",{initialValue:n.sizeWidth,rules:[{required:!0,message:"请输入宽"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeHeight",{initialValue:n.sizeHeight,rules:[{required:!0,message:"请输入高"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeThickness",{initialValue:n.sizeThickness,rules:[{required:!0,message:"请输入厚"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("br",null),i.a.createElement("span",null,"（长*宽*高 mm）")),i.a.createElement(s.a.Item,b({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(c.a,{type:"primary",onClick:this.saveModuleInfo,style:{marginRight:10}},"下一步"),i.a.createElement(c.a,{type:"default",onClick:this.canleClick},"取 消"))))}}])&&O(t.prototype,n),a&&O(t,a),f}(),P=Object(d.b)(function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{saveModuleInfo:function(t){var n=m.a.saveModuleInfo(t);e(n)},getModuleInfo:function(t,n){var a=m.a.getModuleInfo(t,n);e(a)},changeCurApi:function(t,n){var a=m.a.changeCurApi(t,n);e(a)}}})(s.a.create({name:"BasicParamsFrom",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0],a=Object.values(t)[0];e.changeCurApi(n,a.value)}},mapPropsToFields:function(e){for(var t=e.moduleInfo,n={},a=0,r=Object.keys(t);a<r.length;a++){var o=r[a];n[o]=s.a.createFormField({value:t[o]})}return n}})(j)),x=(n(1332),n(1331)),L=(n(439),n(169)),D=(n(342),n(144)),T=(n(167),n(10)),N=(n(243),n(134)),R=(n(446),n(62),n(437),n(1407),n(31));function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function A(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(a,r)}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=p.a.Option,z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(d,o["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=V(e);if(t()){var r=V(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return B(this,n)}}(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=r.call(this,e)).moduleTypeOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(U,{value:e.moduleId,key:e.moduleId},e.moduleId+" "+e.hetModuleTypeName)})},t.potocolOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(U,{value:e.supportProtocol,key:e.supportProtocol},e.supportProtocolName)})},t.sceneOptions=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(U,{value:e.sceneTypeId,key:e.sceneTypeId},e.sceneTypeName)})},t.dataLengthLimitOption=function(e){if(e&&e.length>0)return e.map(function(e,t){return i.a.createElement(U,{value:e.dataLengthLimit,key:e.dataLengthLimit},e.dataLengthLimitName)})},t.preClick=function(){t.props.changeCurrent()},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){A(o,a,r,i,c,"next",e)}function c(e){A(o,a,r,i,c,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}(),t.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.handleSubmit=function(){var e=t.props.moduleInfo;t.props.form.validateFields(function(n,a){if(!n){var r={moduleTypeList:a.moduleTypeList,appModuleId:a.appModuleId,networkTypeList:a.networkTypeList,supportProtocolType:a.supportProtocolType,communicateSpeed:a.communicateSpeed,bindSceneType:a.bindSceneType,supportFileTransfer:a.supportFileTransfer,supportSocProject:a.supportSocProject,burnFileVersion:a.burnFileVersion,libraryFileVersion:a.libraryFileVersion,sourceCodeVersion:a.sourceCodeVersion,moduleId:e.moduleId,dataLengthLimit:a.dataLengthLimit,stepIndex:2,sizeWidth:e.sizeWidth,sizeHeight:e.sizeHeight,sizeThickness:e.sizeThickness,applyScope:e.applyScope,originalModuleTypeName:e.originalModuleTypeName,hetModuleTypeName:e.hetModuleTypeName,moduleBrandId:e.moduleBrandId};Object(y.j)(r).then(function(e){0===e.data.code&&N.a.success("提交成功",2,function(){return t.props.goBack()})})}})},t.checkboxOnChange=function(e){t.props.getAllModuleTypeList(e),t.props.form.resetFields("appModuleId")},t.handleChange=function(e,n){console.log(e,n.file,n.file.status,n.fileList);var a=n.file,r=n.fileList;if("done"===a.status){var o=r[0];o.url=o.response.data.url;var i=[];i.push(o),t.props.changeCurApi(e,i),t.saveFileUrl(e,n.file)}else"error"===a.status?(N.a.error("".concat(n.file.name," 上传失败")),n.fileList.length=0,t.props.changeCurApi(e,n.fileList)):"removed"===a.status?t.props.changeCurApi(e,n.fileList):void 0===n.file.status&&(n.fileList.length=0,t.props.changeCurApi(e,n.fileList))},t.saveFileUrl=function(e,n){var a=t.props.moduleInfo,r=a.historyObj,o={moduleId:a.moduleId,columnName:e,historyFileUrl:r[e],fileUrl:n.response.data.url,fileName:n.name};Object(y.k)(o).then(function(e){0===e.data.code&&console.log("文件保存成功")})},t.getFile=function(e,t){var n=[],a=t[e];if(void 0!==a){var r=e+"Name",o={url:a,status:"done",name:t[r],uid:0+r};n.push(o),console.log("render file :",o)}return n},t.state={previewVisible:!1,previewImage:""},t}return t=d,(n=[{key:"sourceCodeBeforeUpload",value:function(e){var t="application/zip"===e.type||"application/x-zip-compressed"===e.type;t||N.a.error("只能上传zip文件");var n=e.size/1024/1024<=512;n||N.a.error("zip文件必须小于512M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"libraryFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t=".a"===e.name.substr(e.name.lastIndexOf(".")).toLowerCase();t||N.a.error("只能上传.a库文件");var n=e.size/1024/1024<=512;n||N.a.error(".a库文件必须小于512M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"burnFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/macbinary"===e.type||"application/octet-stream"===e.type;t||N.a.error("只能上传烧录文件!");var n=e.size/1024/1024<=32;n||N.a.error(".bin文件必须小于32M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"modulePictureBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="image/jpeg"===e.type||"image/png"===e.type;t||N.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;n||N.a.error("图片必须小于500KB!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"referenceCircuitDiagramBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/pdf"===e.type;t||N.a.error("只能上传PDF文件");var n=e.size/1024/1024<=2;n||N.a.error("PDF must smaller than 2M!");var a=e.name.length<=50;return a||N.a.error("文件名称长度不超过50个字符"),t&&n&&a}},{key:"render",value:function(){var e={action:R.j,className:"upload-list-inline",data:function(e){return{appId:31438,domainType:4}}},t=this.props.form.getFieldDecorator,n=i.a.createElement(c.a,null,i.a.createElement(T.a,{type:"upload"})," 上传文档"),a=this.props,r=a.moduleInfo,o=a.communicationMethodList,d=a.dataLengthLimitList,m=a.networkMethodList,y=a.protocolList,h=a.bindSceneList,b=a.moduleTypeItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,M({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"通信方式"},t("moduleTypeList",{rules:[{required:!0,message:"请选择通信方式"}]})(i.a.createElement(D.a.Group,{onChange:this.checkboxOnChange},o&&o.length?o.map(function(e){return i.a.createElement(D.a,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)}):null))),i.a.createElement(s.a.Item,{label:"模组所属库"},t("appModuleId",{rules:[{required:!0,message:"请您选择模组所属库"}]})(i.a.createElement(p.a,{placeholder:"请选择模组所属库"},this.moduleTypeOption(b)))),i.a.createElement(s.a.Item,{label:"配网方式"},t("networkTypeList",{rules:[{required:!0,message:"请选择配网方式"}]})(i.a.createElement(D.a.Group,null,m&&m.length?m.map(function(e){return i.a.createElement(D.a,{value:e.networkType,key:e.networkType},e.networkTypeName)}):null))),i.a.createElement(s.a.Item,{label:"支持协议"},t("supportProtocolType",{rules:[{required:!0,message:"请选择支持协议"}]})(i.a.createElement(p.a,{placeholder:"请选择支持协议"},this.potocolOption(y)))),i.a.createElement(s.a.Item,{label:"通信速率"},t("communicateSpeed",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(l.a,{placeholder:"请输入通信速率",style:{width:"100%"},maxLength:6}))),i.a.createElement(s.a.Item,{label:"数据长度上限"},t("dataLengthLimit",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(p.a,{placeholder:"请选择数据长度上限"},this.dataLengthLimitOption(d)))),i.a.createElement(s.a.Item,{label:"绑定场景"},t("bindSceneType",{rules:[{required:!0,message:"请选择绑定场景"}]})(i.a.createElement(p.a,{placeholder:"请选择绑定场景"},this.sceneOptions(h)))),i.a.createElement(s.a.Item,{label:"支持文件传输"},t("supportFileTransfer",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(L.a.Group,null,i.a.createElement(L.a,{value:1},"是"),i.a.createElement(L.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"支持SOC方案"},t("supportSocProject",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(L.a.Group,null,i.a.createElement(L.a,{value:1},"是"),i.a.createElement(L.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"模组文件",style:{marginBottom:0}}),1===r.supportSocProject?i.a.createElement(s.a.Item,{label:"源码",extra:"（请上传格式为.zip源文件压缩包）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("sourceCode",{rules:[{required:!1,message:"请上传源码"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{beforeUpload:this.sourceCodeBeforeUpload,onChange:this.handleChange.bind(this,"sourceCode"),defaultFileList:r.sourceCode||[],accept:".zip "}),r.sourceCode&&r.sourceCode.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("sourceCodeVersion",{rules:[{required:!1,message:"请输入源码版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,1===r.supportSocProject?i.a.createElement(s.a.Item,{label:"库文件",extra:"（请上传格式为.a的库文件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("libraryFile",{rules:[{required:!1,message:"请上传库文件"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{beforeUpload:this.libraryFileBeforeUpload,onChange:this.handleChange.bind(this,"libraryFile"),defaultFileList:r.libraryFile||[],accept:".a"}),r.libraryFile&&r.libraryFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("libraryFileVersion",{initialValue:r.libraryFileVersion,rules:[{required:!1,message:"请输入库文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,i.a.createElement(s.a.Item,{label:"烧录文件",extra:"（请上传格式为.bin的烧录件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("burnFile",{rules:[{required:!1,message:"请上传烧录文件"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{beforeUpload:this.burnFileBeforeUpload,onChange:this.handleChange.bind(this,"burnFile"),defaultFileList:r.burnFile||[],accept:".bin"}),r.burnFile&&r.burnFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("burnFileVersion",{initialValue:r.burnFileVersion,rules:[{required:!1,message:"请输入烧录文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))),i.a.createElement(s.a.Item,{label:"模组图片",extra:"（请上传格式为.png，小于500k图片）"},t("modulePicture",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{listType:"picture",defaultFileList:r.modulePicture||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"modulePicture")}),r.modulePicture&&r.modulePicture.length>=1?null:i.a.createElement(c.a,null,i.a.createElement(T.a,{type:"upload"})," 上传图片")),i.a.createElement(f.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"参考电路",extra:"（请上传格式为.png，小于500k图片）"},t("referenceCircuitDiagram",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{listType:"picture",defaultFileList:r.referenceCircuitDiagram||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"referenceCircuitDiagram")}),r.referenceCircuitDiagram&&r.referenceCircuitDiagram.length>=1?null:i.a.createElement(c.a,null,i.a.createElement(T.a,{type:"upload"})," 上传图片")),i.a.createElement(f.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"说明文档",extra:"（请上传格式为.pdf，大小2M说明文件)"},t("readmePdf",{rules:[{required:!1,message:"请上传文档"}]})(i.a.createElement("div",null,i.a.createElement(x.a,M({},e,{defaultFileList:r.readmePdf||[],beforeUpload:this.referenceCircuitDiagramBeforeUpload,accept:".pdf",onChange:this.handleChange.bind(this,"readmePdf")}),r.readmePdf&&r.readmePdf.length>=1?null:n)))),i.a.createElement(s.a.Item,M({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(c.a,{className:"functionParmsForms_Next",onClick:this.preClick},"上一步"),i.a.createElement(c.a,{type:"primary",onClick:this.handleSubmit},"提  交"))))}}])&&F(t.prototype,n),a&&F(t,a),d}(),K=Object(d.b)(function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),networkMethodList:e.getIn(["moduleManager","networkMethodList"]).toJS(),protocolList:e.getIn(["moduleManager","protocolList"]).toJS(),moduleTypeItems:e.getIn(["moduleManager","moduleTypeItems"]).toJS(),bindSceneList:e.getIn(["moduleManager","bindSceneList"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS(),dataLengthLimitList:e.getIn(["moduleManager","dataLengthLimitList"]).toJS()}},function(e){return{getAllModuleTypeList:function(t){var n=m.a.getAllModuleTypeList(t);e(n)},socRadioChangeAction:function(t){var n=m.a.socRadioChangeAction(t);e(n)},changeCurApi:function(t,n){var a=m.a.changeCurApi(t,n);e(a)}}})(s.a.create({name:"FunctionParamsForm",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0];if("sourceCode"!==n&&"libraryFile"!==n&&"burnFile"!==n&&"modulePicture"!==n&&"referenceCircuitDiagram"!==n&&"readmePdf"!==n){var a=Object.values(t)[0];e.changeCurApi(n,a.value)}}},mapPropsToFields:function(e){var t=e.moduleInfo,n={};return Object.keys(t).map(function(e){n[e]=s.a.createFormField({value:void 0!==t[e]&&null!==t[e]?t[e]:void 0})}),console.log("props--",n),n}})(z));n(1408);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y=r.a.Step,$=a.a.Meta,X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(u,o["Component"]);var t,n,c,l=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=Q(e);if(t()){var r=Q(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return H(this,n)}}(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).next=function(){var e=t.state.current+1;t.setState({current:e})},t.prev=function(){var e=t.state.current-1;t.setState({current:e})},t.goBack=function(){t.props.history.goBack()},t.state={current:0},t}return t=u,(n=[{key:"componentWillUnmount",value:function(){this.props.clearModuleInfo({})}},{key:"componentDidMount",value:function(){var e=this.props.brandItems,t=this.props.match.params;if(t&&t.moduleId&&(this.props.getModuleInfo(t.moduleId,"edit"),e&&0===e.length)){var n=this.props,a=n.getBindSceneList,r=n.getAllModuleBrandList,o=n.getModuleTypeMenuAction;r(),a(),o()}}},{key:"getCurStepContent",value:function(){return[{title:"基本参数",content:i.a.createElement(P,{changeCurrent:this.next,goBack:this.goBack})},{title:"功能参数",content:i.a.createElement(K,{changeCurrent:this.prev,goBack:this.goBack})}]}},{key:"render",value:function(){var e=this.getCurStepContent(),t=this.state.current;return i.a.createElement(o.Fragment,null,i.a.createElement(a.a,null,i.a.createElement($,{title:"添加模组",description:""})),i.a.createElement(a.a,{style:{marginTop:10}},i.a.createElement("div",null,i.a.createElement(r.a,{className:"antd-pro-pages-form-step-form-style-steps",current:t},e.map(function(e){return i.a.createElement(Y,{key:e.title,title:e.title})})),i.a.createElement("div",{className:"steps-content"},e[t].content))))}}])&&W(t.prototype,n),c&&W(t,c),u}();t.default=Object(d.b)(function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},clearModuleInfo:function(t){var n=m.a.moduleInfoChangeAcion(t);e(n)},getModuleInfo:function(t,n){var a=m.a.getModuleInfo(t,n);e(a)}}})(X)},1498:function(e,t,n){"use strict";n.r(t);n(44),n(211);var a=n(81),r=(n(72),n(21)),o=(n(167),n(10)),i=(n(210),n(90)),c=(n(243),n(134)),l=(n(94),n(38)),u=(n(23),n(62),n(438),n(64),n(442),n(45),n(37),n(19),n(34),n(39),n(32),n(40),n(35),n(36),n(26),n(27),n(28),n(0)),s=n.n(u),f=n(1371),p=n(287),d=(n(342),n(144)),m=(n(121),n(58)),y=(n(1336),n(1338)),h=(n(188),n(75)),b=(n(142),n(33));n(109),n(437),n(339);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I,C=b.a.Item,k=h.a.Option,j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(i,s.a.Component);var t,n,a,o=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=S(e);if(t()){var r=S(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return w(this,n)}}(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=o.call.apply(o,[this].concat(n))).handleFilterSubmit=function(){var t=e.props.form.getFieldsValue();e.props.filterSubmit(t)},e.reset=function(){e.props.form.resetFields()},e.getOptionList=function(e){if(!e)return[];var t=[];return e.map(function(e){t.push(s.a.createElement(k,{value:e.id,key:e.id},e.name))}),t},e.initFormList=function(){var t=e.props.form.getFieldDecorator,n=e.props.formList,a=[];return n&&n.length>0&&n.forEach(function(n,o){var i=n.label,c=n.field||"",l=n.initialValue||void 0,u=n.placeholder,f=n.width||120,p=n.onSelect,b=n.resetFields;if("DatePicker"===n.type){var v=s.a.createElement(C,{label:i,key:c},t(c)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));a.push(v);var E=s.a.createElement(C,{label:"~",colon:!1,key:c},t(c)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));a.push(E)}else if("Input"===n.type){var O=s.a.createElement(C,{label:i,key:c},t(c,{initialValue:l})(s.a.createElement(m.a,{style:{width:f},type:"text",placeholder:u,maxLength:20})));a.push(O)}else if("Select"===n.type){var w=s.a.createElement(C,{label:i,key:c},t(c,{initialValue:l})(s.a.createElement(h.a,{className:c,style:{width:f,marginBottom:0},placeholder:u,onChange:function(t){n.resetFields&&e.props.form.resetFields(g(b)),p&&p(t)}},e.getOptionList(n.list))));a.push(w)}else if("Checkbox"===n.type){var S=s.a.createElement(C,{label:i,key:c},t(c,{valuePropName:"checked",initialValue:l})(s.a.createElement(d.a,null,i)));a.push(S)}else if("Button"===n.type){var I=s.a.createElement(C,{key:c},s.a.createElement(r.a,{type:"primary",onClick:p},i));a.push(I)}}),a},e}return t=i,(n=[{key:"render",value:function(){var e=this.props.node;return s.a.createElement(b.a,{layout:"inline"},this.initFormList(),s.a.createElement(C,null,s.a.createElement(r.a,{type:"primary",onClick:this.handleFilterSubmit},"查询")),s.a.createElement(C,null,s.a.createElement(r.a,{onClick:this.reset},"重置")),s.a.createElement(C,null,e))}}])&&E(t.prototype,n),a&&E(t,a),i}(),P=b.a.create({})(j),x=(n(1332),n(1331)),L=(n(446),n(166),n(108)),D=(n(1384),n(31));function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function R(e,t,n,a,r,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(a,r)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=b.a.Item,z=h.a.Option,K=Object(L.g)(I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(d,u["Component"]);var t,n,a,l=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=V(e);if(t()){var r=V(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return B(this,n)}}(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this,e)).categorySelect=function(e){t.setState({categoryId:e,subCategoryList:[]});t.props.form.resetFields([].concat(["subCategoryId","deviceTypeId"]));var n=t.props.allCategoryList,a=n.findIndex(function(t){return e===t.id});if(a>-1){var r=n[a];t.setState({subCategoryList:t.makeFormData(r.subCategoryList,"subCategoryName","subCategoryId")})}},t.subCategorySelect=function(e){t.setState({subCategoryId:e,deviceTypeList:[]}),t.props.form.resetFields("deviceTypeId");var n=t.state.subCategoryList,a=n.findIndex(function(t){return e===t.id});if(a>-1){var r=n[a];t.setState({deviceTypeList:t.makeFormData(r.deviceTypeList,"deviceTypeName","deviceTypeId")})}},t.threeCategorySelect=function(e){var n=t.state.deviceTypeList,a=n.findIndex(function(t){return e===t.id});if(a>-1){var r=n[a];console.log("三级菜单选择后：",r);var o=e,i=r.defaultDeviceSubtype.deviceSubtypeId;t.setState({deviceTypeId:o,deviceSubtypeId:i}),console.log("三级菜单选择后：deviceSubtypeId ===",i)}t.getProtocol(e)},t.makeFormData=function(e,t,n){var a=[];return console.log("data ===",e),e.map(function(e){var r=M(M({},e),{},{id:e[n],name:e[t]});a.push(r)}),a},t.getProtocol=function(e){var n={deviceTypeId:e};Object(p.f)(n).then(function(e){var n=e.data;0===n.code&&t.setState({protocoloList:t.makeFormData(n.data,"templateName","templateNumber")})})},t.handleChange=function(e){console.log("----info.file---",e.file),"error"===e.file.status?(c.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),t.setState({fileList:e.fileList})},t.showModal=function(){t.setState({visible:!0,iconLoading:!1})},t.handleOk=function(e){var n=t.state,a=n.fileList,r=n.deviceTypeId,o=n.deviceSubtypeId,i={};a.length<=0?c.a.warning("请上传模板图片!"):(a.map(function(e,t){"done"===e.status&&(i["page".concat(t+1)]=e.response.data.url)}),t.props.form.validateFields(function(e,n){if(!e){n.status=0,delete n.templatePicList,delete n.categoryId,delete n.subCategoryId,Object.assign(n,i);var a=M(M(M({},n),i),{},{deviceTypeId:r,deviceSubtypeId:o});t.setState({iconLoading:!0}),Object(f.e)(a).then(function(e){var n=e.data;if(0===n.code){t.setState({visible:!1,iconLoading:!1});var a=n.data.templateId;c.a.success("恭喜您，模板已创建成功！我们将进入自助接入系统",3,t.handleMessageClose(a))}}).finally(function(){t.setState(function(){return{iconLoading:!1}})})}}))},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){R(o,a,r,i,c,"next",e)}function c(e){R(o,a,r,i,c,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}(),t.getBase64=function(e){return new Promise(function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}})},t.handleMessageClose=function(e){var t=window.location.host,n="",a="";"cms.clife.cn"===t?(n="open.clife.cn",a=""):"pre.cms.clife.cn"===t?(n="pre.cms.clife.cn",a="/pre-wCloud-v2"):(n="dp.clife.net",a="/wCloud_v2");var r="https://"+n+a+"/app-developer/page/playground.html#/develop/edit/"+e+"?platform=1&operate=edit";window.open(r,"_self")},t.handleCancel=function(e){t.setState({visible:!1,fileList:[]}),t.props.form.resetFields("templatePicList"),t.props.form.resetFields()},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.textareaChange=function(e){e.target.value.length>=500&&c.a.warning("最大支持输入500个字符",1)},t.getOptionList=function(e){if(!e)return[];var t=[];return e.map(function(e){t.push(s.a.createElement(z,{value:e.id,key:e.id},e.name))}),t},t.state={fileList:[],visible:!1,previewVisible:!1,previewImage:"",subCategoryList:[],deviceTypeList:[],protocoloList:[],categoryId:"",subCategoryId:"",deviceTypeId:"",deviceSubtypeId:""},t}return t=d,(n=[{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||c.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||c.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:D.j,data:function(e){return{appId:31438,domainType:4}}},t=this.props,n=t.form,a=t.allCategoryList,c=n.getFieldDecorator,l=s.a.createElement("div",null,s.a.createElement(o.a,{type:"plus"}),s.a.createElement("div",{className:"ant-upload-text"},"Upload")),u=this.state,f=u.subCategoryList,p=u.deviceTypeList,d=u.protocoloList;u.fileList;return s.a.createElement("div",null,s.a.createElement(r.a,{type:"primary",onClick:this.showModal},"新建H5模板"),s.a.createElement(i.a,{width:800,title:"新建H5模板",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,cancelText:"取消",okText:"创建",confirmLoading:this.state.iconLoading,destroyOnClose:!0},s.a.createElement(b.a,N({},{labelCol:{span:6},wrapperCol:{span:15}},{className:"CreataH5Template_from"}),s.a.createElement(U,{label:"模板名称"},c("templateName",{rules:[{required:!0,message:"模板名称不能为空"}]})(s.a.createElement(m.a,{allowClear:!0,type:"text",placeholder:"请输入您喜欢的模板名称",maxLength:20}))),s.a.createElement(b.a.Item,{className:"chooseProduct",label:"所属分类"},s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("categoryId",{rules:[{required:!0,message:"请您选择一级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"一级类目",onChange:this.categorySelect},this.getOptionList(a)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("subCategoryId",{rules:[{required:!0,message:"请您选择二级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"二级类目",onChange:this.subCategorySelect},this.getOptionList(f)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("deviceTypeId",{rules:[{required:!0,message:"请您选择三级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"三级类目",onChange:this.threeCategorySelect},this.getOptionList(p))))),s.a.createElement(U,{label:"调取协议"}," ",c("templateNumber",{rules:[{required:!0,message:"请您选择协议"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择协议"},this.getOptionList(d)))),s.a.createElement(U,{label:"性质"},c("isFree",{rules:[{required:!0,message:"请您选择性质"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择"},s.a.createElement(z,{value:"1"},"免费")))),s.a.createElement(U,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"},c("templatePicList",{rules:[{required:!0,message:"请上传一张图片"}]})(s.a.createElement("div",{className:"product-div"},s.a.createElement(x.a,N({},e,{accept:"image/png,image/jpeg",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),this.state.fileList.length>=5?null:l),s.a.createElement(i.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},s.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),s.a.createElement(U,{label:"描述"},c("remark",{})(s.a.createElement(m.a.TextArea,{onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))))))}}])&&F(t.prototype,n),a&&F(t,a),d}())||I,J=b.a.create()(K),W=(n(1409),n(91));function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var te=l.a.Meta,ne=[{title:"模板信息",icon:"info",status:0,key:0},{title:"编辑",icon:"edit",status:0,key:1},{title:"发布",icon:"cloud-upload",status:0,key:2},{title:"删除",icon:"delete",status:0,key:3}],ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(y,u["Component"]);var t,n,d,m=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=ee(e);if(t()){var r=ee(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Z(this,n)}}(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=m.call(this,e)).getH5TemplateList=function(e){t.setState({loading:!0,oldParams:e}),Object(f.d)(e).then(function(e){var n=e.data;0===n.code&&t.setState(function(){return{h5TemplateList:t.makeAntTableData(n.data),pager:n.data.pager}})}).finally(function(){t.setState(function(){return{loading:!1}})})},t.getAllCategoryList=function(){Object(p.a)().then(function(e){var n=e.data;0===n.code&&t.setState({allCategoryList:t.makeFormData(n.data,"categoryName","categoryId")})})},t.h5Publish=function(e){Object(f.b)({templateId:e.templateId,status:e.status?0:1}).then(function(n){if(0===n.data.code){var a=e.status?"撤销成功！":"发布模板成功！";c.a.success(a,2).then(t.getH5TemplateList(t.state.oldParams))}})},t.h5Del=function(e){Object(f.a)({templateId:e.templateId}).then(function(e){if(0===e.data.code){c.a.success("删除模板成功！",2).then(t.getH5TemplateList(t.state.oldParams))}})},t.editTemplate=function(e){if(1!==e.status){var n=window.location.host;console.log(t.props);var a="",r="";"cms.clife.cn"===n?(a="open.clife.cn",r=""):"pre.cms.clife.cn"===n?(a="pre.cms.clife.cn",r="/pre-wCloud-v2"):(a="dp.clife.net",r="/wCloud_v2");var o="https://"+a+r+"/app-developer/page/playground.html#/develop/edit/"+e.templateId+"?platform=1&operate=edit";window.open(o,"_self")}else c.a.warning('对不起！模板"'+e.templateName+'" 是发布状态，禁止编辑',3)},t.makeFormData=function(e,t,n){var a=[];return e.map(function(e){var r=Q(Q({},e),{},{id:e[n],name:e[t]});a.push(r)}),a},t.categorySelect=function(e){t.setState({categoryId:e,subCategoryList:[]});var n=t.state.allCategoryList,a=n.findIndex(function(t){return e===t.id});if(a>-1){var r=n[a];console.log("一级菜单选择后：",r),t.setState({subCategoryList:t.makeFormData(r.subCategoryList,"subCategoryName","subCategoryId")})}},t.subCategorySelect=function(e){t.setState({subCategoryId:e,deviceTypeList:[]});var n=t.state.subCategoryList,a=n.findIndex(function(t){return e===t.id});if(a>-1){var r=n[a];console.log("二级菜单选择后：",r),t.setState({deviceTypeList:t.makeFormData(r.deviceTypeList,"deviceTypeName","deviceTypeId")})}},t.handleDelete=function(e,n){switch(n.key){case 0:t.props.history.push({pathname:"/config/h5template/info/".concat(e.templateId)});break;case 1:t.editTemplate(e);break;case 2:i.a.confirm({title:"确认",okText:"确定",cancelText:"取消",content:e.status?"点击确定将模板从模板市场撤销发布并保存为草稿":"点击确定后将同步到模板市场并对用户可见，点击取消可取消发布。",onOk:function(){t.h5Publish(e)}});break;case 3:i.a.confirm({title:"确认",okText:"确定",okType:"danger",cancelText:"取消",content:e.status?"点击确定将从模板管理页面删除模板，点击取消返回。":"点击确定将模板从模板管理页面和模板市场同时删除，点击取消返回",onOk:function(){t.h5Del(e)}})}},t.filterSubmit=function(e){var n=Q(Q({},t.state.oldParams),{},{deviceTypeId:e.deviceTypeId,status:e.status,nature:e.nature,templateName:e.templateName});for(var a in n){if(n.hasOwnProperty(a))n[a]||delete n[a]}t.getH5TemplateList(n)},t.paginationChange=function(e){console.log("分页选择了：",e);var n=Q(Q({},t.state.oldParams),{},{pageIndex:e});console.log(n),t.getH5TemplateList(n),document.querySelector(".ant-table-body").scrollTop=0},t.makeAntTableData=function(e){var t=[];return e.list.map(function(e,n){t.push(Q(Q({},e),{},{key:e.templateId}))}),t},t.state={h5TemplateList:[],loading:!1,oldParams:{},allCategoryList:[],subCategoryList:[],deviceTypeList:[],categoryId:"",subCategoryId:"",pager:{}},t}return t=y,(n=[{key:"componentWillMount",value:function(){this.getH5TemplateList({pageRows:10,sort:"modifyTime",order:"desc"}),this.getAllCategoryList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.allCategoryList,i=t.subCategoryList,c=t.deviceTypeList,u=(t.pagination,t.loading),f=t.h5TemplateList,p=t.pager,d=[{type:"Input",label:"关键字",field:"templateName",placeholder:"请输入模板名称",width:260},{type:"Select",label:"所属分类",field:"categoryId",placeholder:"一级类目",list:n,onSelect:this.categorySelect,resetFields:["subCategoryId","deviceTypeId"],width:140},{type:"Select",label:"",field:"subCategoryId",placeholder:"二级类目",list:i,onSelect:this.subCategorySelect,resetFields:["deviceTypeId"],width:140},{type:"Select",label:"",field:"deviceTypeId",placeholder:"三级类目",list:c,width:140},{type:"Select",label:"状态",field:"status",placeholder:"请选择",list:[{id:"0",name:"未发布"},{id:"1",name:"已发布"}],width:140},{type:"Select",label:"性质",field:"nature",placeholder:"请选择",list:[{id:"1",name:"免费"}],width:140}],m=[{title:"模板名称-CN",width:"15%",key:"templateName",dataIndex:"templateName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"所属分类",width:"15%",key:"allCategoryName",dataIndex:"allCategoryName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"二维码",width:"8%",key:"qrcode",dataIndex:"qrcode",render:function(e){var t=e?s.a.createElement("img",{className:"codeimg",src:e}):"二维码生成中";return s.a.createElement("div",{className:"td-qrcode"},s.a.createElement(o.a,{type:"barcode",className:"s-qrcode"}),s.a.createElement("div",{className:"hovershow"},s.a.createElement("span",{className:"leftarrow"}),t))}},{title:"性质",width:"80px",key:"isFree",dataIndex:"isFree",render:function(e){return 1===e?"免费":""}},{title:"状态",width:"80px",key:"status",dataIndex:"status",render:function(e){var t=1===e?"已发布":"未发布";return s.a.createElement("span",{title:t,style:{color:"".concat(["red","gray"][e])}},t)}},{title:"更新时间",width:"12%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=D.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return s.a.createElement("span",{title:t},t)}},{title:"操作",width:"13%",key:"operation",dataIndex:"operation",render:function(t,n){return s.a.createElement("div",null,ne.map(function(t,o){return s.a.createElement(a.a,{key:o,placement:"top",title:2===t.key&&1===n.status?"下线":t.title},s.a.createElement(r.a,{style:{marginLeft:"5px"},shape:"circle",size:"small",icon:2===t.key&&1===n.status?"cloud-download":t.icon,key:n.templateId,onClick:function(){return e.handleDelete(n,t)}}))}))}}];return s.a.createElement("div",{className:"H5TemplateContent"},s.a.createElement(l.a,null,s.a.createElement(te,{title:"H5模板",description:"",style:{marginBottom:10}}),s.a.createElement(P,{formList:d,filterSubmit:this.filterSubmit,node:s.a.createElement(J,{allCategoryList:n})})),s.a.createElement(l.a,{className:"H5TemplateTable"},s.a.createElement(W.a,{rowKey:"id",bordered:!0,columns:m,dataSource:f,pager:p,onPageChange:this.paginationChange,loading:u})))}}])&&$(t.prototype,n),d&&$(t,d),y}();t.default=ae},1507:function(e,t,n){"use strict";n.r(t);n(94);var a=n(38),r=(n(109),n(339),n(27),n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(28),n(0)),o=n.n(r),i=n(42),c=(n(1404),n(437),n(1348),n(64),function(e){var t=e.list,n=e.type,a=e.active,r=e.name,i=e.id,c=e.onChange,l=e.sub;if(0==t.length)return null;var u=t.reduce(function(e,t){return e[r].length>t[r].length?e:t},t[0]);return o.a.createElement("div",{style:{display:"block",position:"relative",minWidth:"1200px"}},o.a.createElement("div",{className:"list-category",style:{height:"".concat("top"==n?36*u[r].length:36*u[r].length+40,"px")}},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,"top"!==n?o.a.createElement("span",{className:"line-horizontal"}):null,t.map(function(e,t){return o.a.createElement("div",{className:"list-item ".concat(t==a&&l&&l.length>0?"active":""),onClick:function(){return"function"==typeof c?c(t):null},key:t},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,o.a.createElement("div",{className:"list-name"},o.a.createElement("span",null,"".concat(e[r]),o.a.createElement("br",null),o.a.createElement("b",{className:"list-num"},"(",e[i],")"))))}),void 0!==a&&l&&l.length>0?o.a.createElement("span",{className:"line-horizontal bottom ".concat(a>=t.length/2?"left":"right"),style:{width:56*Math.abs((t.length+1)/2-a-1)}}):null))});function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,o.a.Component);var t,n,r,i=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=d(e);if(t()){var r=d(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f(this,n)}}(l);function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=i.call.apply(i,[this].concat(n))).state={first:0,second:0},e.changeState=function(t){var n=p(e);return function(e){var a,r,o;console.log(e),"first"==t&&n.setState({second:0}),n.setState((o=e,(r=t)in(a={})?Object.defineProperty(a,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[r]=o,a))}},e}return t=l,(n=[{key:"render",value:function(){var e=this.state,t=e.first,n=e.second,r=this.props.allCategoryList,i=Array.from(r)||[],l=i[t]&&i[t].subCategoryList||[],u=l[n]&&l[n].deviceTypeList||[];return o.a.createElement("div",null,o.a.createElement(a.a,null,o.a.createElement(a.a.Meta,{title:"产品类目",description:"硬件产品的形态分类，开放平台接入产品，终端APP绑定设备时可获取类目数据。"})),o.a.createElement("div",{className:"product-categroy"},o.a.createElement("div",{style:{display:"inline-block"}},o.a.createElement(c,{type:"top",list:i,sub:l,active:t,name:"categoryName",id:"categoryId",onChange:this.changeState("first")}),o.a.createElement(c,{list:l,sub:u,active:n,name:"subCategoryName",id:"subCategoryId",onChange:this.changeState("second")}),o.a.createElement(c,{list:u,name:"deviceTypeName",id:"deviceTypeId"}))))}}])&&u(t.prototype,n),r&&u(t,r),l}();t.default=Object(i.b)(function(e){return{allCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"])}})(m)},1508:function(e,t,n){"use strict";n.r(t);n(142);var a=n(33),r=(n(121),n(58)),o=(n(211),n(81)),i=(n(72),n(21)),c=(n(210),n(90)),l=(n(94),n(38)),u=(n(188),n(75)),s=(n(23),n(62),n(438),n(64),n(44),n(45),n(37),n(19),n(34),n(39),n(32),n(40),n(35),n(36),n(26),n(27),n(28),n(0)),f=n.n(s),p=n(108),d=n(42),m=n(456),y=n(31),h=n(201),b=(n(281),n(155)),v=(n(286),n(63));n(1405);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(o,s["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=S(e);if(t()){var r=S(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return w(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).handleCancel=function(){t.props.viewModuleInfoCancle(!1)},t.handlePreview=function(){var e=t.props.moduleInfo;t.setState({previewImage:e.historyObj.referenceCircuitDiagram,previewVisible:!0})},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.getDataSource=function(e){return 0===e.supportSocProject?[{key:"1",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]:[{key:"1",fileType:"源码",fileName:e.sourceCodeName,version:""+e.sourceCodeVersion,fileUrl:e.historyObj.sourceCode},{key:"2",fileType:"库文件",fileName:e.libraryFileName,version:""+e.libraryFileVersion,fileUrl:e.historyObj.libraryFile},{key:"3",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]},t.state={previewVisible:!1,previewImage:""},t}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.moduleInfo,a=[{title:"模板文件",key:"fileType",dataIndex:"fileType"},{title:"文件名",key:"fileName",dataIndex:"fileName",render:function(e,t){return console.log("=====",t),f.a.createElement("a",{href:t.fileUrl,target:"_blank"},e)}},{title:"版本号",key:"version",dataIndex:"version"}],r=this.getDataSource(n);return f.a.createElement("div",null,f.a.createElement(c.a,{style:{top:20},width:800,title:"查看模组",visible:t,onCancel:this.handleCancel,footer:this.state.status?[f.a.createElement(i.a,{key:"back",onClick:this.handleCancel},"取消"),f.a.createElement(i.a,{key:"submit",type:"primary",onClick:this.handleOk},"确定")]:null},f.a.createElement(v.a,{title:"基础信息",size:"small"},f.a.createElement(v.a.Item,{label:"生产厂家",span:2},n.brandName),f.a.createElement(v.a.Item,{label:"模组所属库",span:2},n.moduleAffiliation),f.a.createElement(v.a.Item,{label:"模组型号",span:2},n.hetModuleTypeName),f.a.createElement(v.a.Item,{label:"模组IC型号",span:2},n.originalModuleTypeName),f.a.createElement(v.a.Item,{label:"使用范围",span:2},n.applyScope)),f.a.createElement(v.a,{title:"审核内容",size:"small"},f.a.createElement(v.a.Item,{label:"通信方式",span:2},n.moduleTypeNameList),f.a.createElement(v.a.Item,{label:"配网方式",span:2},n.networkTypeNameList),f.a.createElement(v.a.Item,{label:"支持协议",span:2},n.supportProtocolTypeName),f.a.createElement(v.a.Item,{label:"支持文件传输",span:2},0===n.supportFileTransfer?"否":"是"),f.a.createElement(v.a.Item,{label:"通信速率",span:2},n.communicateSpeed),f.a.createElement(v.a.Item,{label:"支持SOC方案",span:2},0===n.supportSocProject?"否":"是"),f.a.createElement(v.a.Item,{label:"数据上限",span:4},n.dataLengthLimitName)),f.a.createElement(v.a.Item,null,f.a.createElement(b.a,{bordered:!0,columns:a,dataSource:r,size:"small",pagination:!1})),f.a.createElement(v.a,{title:"说明文档",size:"small",style:{marginTop:10}},f.a.createElement(v.a.Item,{label:"参考电路",span:4},f.a.createElement("div",{className:"ReferenceCircuitPic",style:{background:"url("+n.historyObj.referenceCircuitDiagram+") no-repeat center / contain",border:"1px solid #1890ff"},onClick:this.handlePreview}," "),f.a.createElement(c.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},f.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))),f.a.createElement(v.a.Item,{label:"说明文档",span:4},f.a.createElement("a",{href:n.historyObj.readmePdf,target:"_blank"},n.readmePdfName)))))}}])&&E(t.prototype,n),a&&E(t,a),o}(),k=(n(1406),n(91));function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach(function(t){L(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=u.a.Option,M=l.a.Meta,A=c.a.confirm,F=Object(p.g)(I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(d,s["Component"]);var t,n,c,p=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=R(e);if(t()){var r=R(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return N(this,n)}}(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=p.call(this,e)).getModuleList=function(e){t.setState({loading:!0,oldparams:e}),Object(h.h)(e).then(function(e){if(0===e.data.code){var n=e.data.data.list;n.map(function(e,t){e.key=e.moduleId});var a=y.e.pagination(e.data.data.pager,t.paginationChange);t.setState(function(){return{moduleList:n,pagination:a,pager:e.data.data.pager}})}}).finally(function(){t.setState(function(){return{loading:!1}})})},t.generateOptions=function(e){if(e)return e.map(function(e,t){return f.a.createElement(_,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)})},t.searchClick=function(){var e=t.state.oldparams;t.props.form.validateFields(function(n,a){var r=x(x(x({},e),a),{},{pageIndex:1});t.getModuleList(r)})},t.addModule=function(){t.props.history.push({pathname:"/config/ModuleManager/add/"})},t.reset=function(){t.props.form.resetFields()},t.releaseOperation=function(e,n){Object(h.i)(e,n).then(function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}})},t.deleteOperation=function(e){Object(h.e)(e).then(function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}})},t.OfflineOperataion=function(e,n){Object(h.i)(e,n).then(function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}})},t.generateOperationBtn=function(e){return 1===e.releaseStatus?t.releaseBtnArr().map(function(n,a){return t.createOperationBtn(n,e)}):t.unReleaseBtnArr().map(function(n,a){return t.createOperationBtn(n,e)})},t.createOperationBtn=function(e,n){return f.a.createElement(o.a,{key:e.key,placement:"top",title:e.title},f.a.createElement(i.a,{style:{marginLeft:"10px"},shape:"circle",size:"small",icon:e.icon,key:e.templateId,onClick:function(){return t.handleOperation(e,n)}}))},t.releaseBtnArr=function(){return[{title:"查看",icon:"info",key:"View"},{title:"下线",icon:"cloud-download",key:"Offline"}]},t.unReleaseBtnArr=function(){return[{title:"发布",icon:"cloud-upload",key:"release"},{title:"编辑",icon:"edit",key:"edit"},{title:"删除",icon:"delete",key:"delete"}]},t.paginationChange=function(e){t.setState({pageIndex:e}),console.log("分页选择了：",e);var n=x(x({},t.state.oldparams),{},{pageIndex:e});t.getModuleList(n)},t.handleOperation=function(e,n){switch(e.key){case"View":t.props.getModuleInfoPreview(n.moduleId,"view");break;case"Offline":A({title:"下线模组?",content:"确认下线后，模组将同步从开放平台下线，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.OfflineOperataion(n.moduleId,0)},onCancel:function(){}});break;case"release":console.log(n.completeStatus),0===n.completeStatus?A({title:"发布模组",content:"当前模组信息不完整，请完善后提交发布",okText:"确定",cancelText:"取消",onOk:function(){},onCancel:function(){}}):A({title:"发布模组",content:"确认发布后，模组信息将会同步到开放平台,确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.releaseOperation(n.moduleId,1)},onCancel:function(){}});break;case"edit":var a=n.moduleId;t.props.history.push({pathname:"/config/ModuleManager/edit/".concat(a)});break;case"delete":A({title:"删除模组",content:"删除后，模组信息将同步删除，无法撤销，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.deleteOperation(n.moduleId)},onCancel:function(){}})}},t.state={moduleList:[],loading:!1,pagination:{},oldparams:{},pager:{}},t}return t=d,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.getBindSceneList,n=e.getAllModuleBrandList,a=e.getModuleTypeMenuAction;this.getModuleList({pageIndex:1,moduleType:"",hetModuleTypeName:"",pageRows:10}),n(),t(),a()}},{key:"render",value:function(){var e=this,t=[{title:"模组型号",width:"15%",key:"hetModuleTypeName",dataIndex:"hetModuleTypeName",render:function(e){return f.a.createElement("span",{title:e},e)}},{title:"支持通信",width:"15%",key:"moduleTypeList",dataIndex:"moduleTypeList",render:function(e){return f.a.createElement("span",{title:e},e)}},{title:"生产厂商",width:"15%",key:"brandName",dataIndex:"brandName"},{title:"状态",width:"65px",key:"releaseStatus",dataIndex:"releaseStatus",render:function(e){return f.a.createElement("span",{style:{color:"".concat(["green","gray"][e])}},1===e?"已发布":"草稿")}},{title:"更新时间",width:"15%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=y.b.formateDate(e,"yyyy-MM-dd hh:mm:ss");return f.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",key:"operation",dataIndex:"operation",render:function(t,n){return f.a.createElement("div",null,e.generateOperationBtn(n))}}],n=this.state,o=n.moduleList,c=n.loading,p=(n.pagination,n.pager),d=this.props,m=d.moduleInfo,h=d.visible,b=d.communicationMethodList,v=d.visibleChangeAcion,g=this.props.form.getFieldDecorator;return f.a.createElement(s.Fragment,null,f.a.createElement(l.a,null,f.a.createElement(C,{visible:h,moduleInfo:m,viewModuleInfoCancle:v}),f.a.createElement(M,{title:"模组管理",description:"",style:{marginBottom:10,fontSize:20}}),f.a.createElement(a.a,{layout:"inline",onSubmit:this.handleSubmit},f.a.createElement(a.a.Item,{label:"关键字"},g("hetModuleTypeName",{})(f.a.createElement(r.a,{placeholder:"请输入生产厂商或模组型号",style:{width:260},maxLength:20}))),f.a.createElement(a.a.Item,{label:"通信方式"},g("moduleType",{initialValue:void 0})(f.a.createElement(u.a,{style:{width:140,marginBottom:0},placeholder:"请选择通信方式"},this.generateOptions(b)))),f.a.createElement(a.a.Item,null,f.a.createElement(i.a,{type:"primary",onClick:this.searchClick},"查询")),f.a.createElement(a.a.Item,null,f.a.createElement(i.a,{type:"default",onClick:this.reset},"重置")),f.a.createElement(a.a.Item,null,f.a.createElement(i.a,{type:"primary",onClick:this.addModule},"添加模组")))),f.a.createElement(l.a,{className:"ModuleManagerListTable",style:{marginTop:10}},f.a.createElement(k.a,{rowKey:"id",bordered:!0,columns:t,dataSource:o,pager:p,onPageChange:this.paginationChange,loading:c})))}}])&&D(t.prototype,n),c&&D(t,c),d}())||I;t.default=Object(d.b)(function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),visible:e.getIn(["moduleManager","visible"]),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}},function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},visibleChangeAcion:function(t){var n=m.a.visibleChangeAcion(t);e(n);var a=m.a.moduleInfoChangeAcion({});e(a)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},getModuleInfoPreview:function(t){var n=m.a.getModuleInfoPreviewAction(t);e(n)}}})(a.a.create({})(F))},1509:function(e,t,n){"use strict";n.r(t);n(94);var a,r=n(38),o=(n(211),n(81)),i=(n(72),n(21)),c=(n(166),n(44),n(45),n(23),n(19),n(35),n(36),n(26),n(27),n(28),n(0)),l=n.n(c),u=n(42),s=(n(121),n(58)),f=(n(808),n(451)),p=(n(142),n(33)),d=(n(188),n(75)),m=n(1),y=n.n(m),h=n(287),b=n(12);n(1376);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}d.a.Option;var S=Object(u.b)(function(e){var t=e.getIn(["globalDeviceInfo","deviceType"]);return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceType:t,deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}})(a=p.a.create({name:"horizontal_pannel"})(a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(o,c["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=w(e);if(t()){var r=w(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return O(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).state={deviceSubType:[]},t}return t=o,(n=[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,n){if(!e){console.log(n);var a=n.deviceTypeSelect,r=n.templateName;if(a&&3==a.length){var o=a[2];t.props.filterPannelOperation({deviceTypeId:o,templateName:r})}else t.props.filterPannelOperation({templateName:r})}})}},{key:"deviceTypeSelect",value:function(e){var t=this;Object(h.c)({deviceTypeId:e}).then(function(e){if(e.data.code===b.a){var n=e.data.data;t.props.form.resetFields(["deviceSubType"]),t.setState({deviceSubType:n})}})}},{key:"deviceSubTypeSelect",value:function(e){console.log("deviceSubTypeSelect: "+e)}},{key:"resetContent",value:function(){this.props.form.resetFields(),this.props.filterPannelOperation({deviceTypeId:void 0})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=(this.props.deviceCategoryList,this.props.deviceCascaderList);return l.a.createElement("div",null,l.a.createElement(p.a,{layout:"inline",onSubmit:this.handleSubmit.bind(this)},l.a.createElement(p.a.Item,{label:"所属分类"},e("deviceTypeSelect")(l.a.createElement(f.a,{options:t,placeholder:"请选择所属分类",style:{width:260}}))),l.a.createElement(p.a.Item,{label:"模板名称"},e("templateName")(l.a.createElement(s.a,{type:"text",onChange:this.handleNumberChange,style:{width:200},placeholder:"输入模板名称"}))),l.a.createElement(p.a.Item,null,l.a.createElement(i.a,{type:"primary",htmlType:"submit"},"查询"),l.a.createElement("span",null," "),l.a.createElement(i.a,{type:"primary",onClick:this.resetContent.bind(this)},"重置"))))}}])&&g(t.prototype,n),a&&g(t,a),o}())||a)||a;S.prototype={filterPannelOperation:y.a.func};var I,C=S,k=n(1385),j=n(31),P=n(108),x=n(91);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?R(e):t}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=Object(P.g)(I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(s,c["Component"]);var t,n,a,u=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=_(e);if(t()){var r=_(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return N(this,n)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=u.call(this,e)).tableColumn=[{title:"模板ID",dataIndex:"protocolTemplateId",key:"protocolTemplateId",width:"75px"},{title:"模板名称",dataIndex:"templateName",key:"templateName",width:"20%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"语言版本",dataIndex:"language",key:"language",width:"9%",render:function(e){return l.a.createElement("span",null,0===e?"中文":"英文")}},{title:"所属分类",dataIndex:"allCategoryName",key:"allCategoryName",width:"28%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"templateStatus",key:"templateStatus",width:"10%",render:function(e){return l.a.createElement("span",null,1===e?"正式":"草稿")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=j.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return l.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"修改时间",dataIndex:"updateTime",key:"updateTime",width:"15%",render:function(e){var t=j.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return l.a.createElement("span",{className:"td-break",title:t},t)}},{title:"操作",dataIndex:"templateNumber",key:"operation",width:"100px",fixed:"right",render:function(e){return l.a.createElement(o.a,{placement:"top",title:"编辑"},l.a.createElement(i.a,{onClick:t.editProtocolTemp.bind(R(t),e),icon:"edit",shape:"circle",size:"small"}))}}],t.state={tableDataSources:[],pageRows:10,currentPage:0,totalRows:0,isLoading:!1,searchParams:{},pager:{}},t}return t=s,(n=[{key:"componentDidMount",value:function(){this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:this.state.currentPage})}},{key:"getProtocolTemplateList",value:function(e){var t=this;this.setState({isLoading:!0}),e=Object.assign({},this.state.searchParams,e),e=j.d.filterParam(e),Object(k.c)(e).then(function(e){if(t.setState({isLoading:!1}),e.data.code===b.a){var n=e.data.data.list,a=e.data.data.pager;t.setState({tableDataSources:n,totalRows:a.totalRows,currentPage:a.pageIndex,pager:a})}}).catch(function(){t.setState({isLoading:!1})})}},{key:"handleFilter",value:function(e){console.log("Receve values of form:",e),this.setState({searchParams:e});var t={pageRows:this.state.pageRows,sort:"modifyTime",order:"desc",deviceTypeId:e.deviceTypeId,templateName:e.templateName,pageIndex:0};this.getProtocolTemplateList(t)}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({currentPage:e}),this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:e})}},{key:"addTemplate",value:function(){this.props.history.push("/config/protocoltemplate/add")}},{key:"editProtocolTemp",value:function(e){this.props.history.push({pathname:"/config/protocoltemplate/edit/".concat(e)})}},{key:"render",value:function(){var e=this.tableColumn,t=this.state.tableDataSources;this.state.totalRows;return l.a.createElement("div",null,l.a.createElement(r.a,null,l.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold"}},"协议模板"),l.a.createElement(C,{filterPannelOperation:this.handleFilter.bind(this)}),l.a.createElement("div",{style:{marginTop:"20px"}},l.a.createElement(i.a,{type:"primary",onClick:this.addTemplate.bind(this)},"新增协议模板"))),l.a.createElement(r.a,{style:{marginTop:"10px"}},l.a.createElement(x.a,{bordered:!0,columns:e,dataSource:t,rowKey:"protocolTemplateId",loading:this.state.isLoading,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,scroll:{x:1200,y:"auto"}})))}}])&&D(t.prototype,n),a&&D(t,a),s}())||I,A=Object(u.b)(function(e){return{deviceType:e.getIn(["globalDeviceInfo","deviceType"])}})(M);t.default=A},1510:function(e,t,n){"use strict";n.r(t);n(94);var a=n(38),r=(n(1332),n(1331)),o=(n(72),n(21)),i=(n(439),n(169)),c=(n(342),n(144)),l=(n(121),n(58)),u=(n(167),n(10)),s=(n(243),n(134)),f=(n(135),n(43)),p=(n(188),n(75)),d=(n(142),n(33)),m=(n(338),n(98),n(245),n(244),n(64),n(109),n(437),n(44),n(45),n(23),n(37),n(19),n(34),n(39),n(32),n(40),n(166),n(35),n(36),n(26),n(27),n(28),n(0)),y=n.n(m),h=n(42),b=n(108),v=n(73),g=n(287),E=n(1385),O=n(12),w=(n(281),n(155)),S=(n(280),n(99));n(1410);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x,L,D,T=S.a.TabPane,N=[{id:1,name:"字符"},{id:2,name:"数值"},{id:3,name:"枚举"},{id:4,name:"布尔"},{id:5,name:"绝对时间"},{id:6,name:"相对时间"},{id:7,name:"循环时间"},{id:8,name:"RGB颜色"},{id:9,name:"二进制"},{id:10,name:"数组"},{id:11,name:"结构体"}],R=[{title:"协议属性(key)",dataIndex:"mark"},{title:"协议属性名",dataIndex:"describe"},{title:"数据单位",dataIndex:"propertyValueType",width:"90px"},{title:"数据类型",dataIndex:"functionDataType",width:"100px",render:function(e){return e?N[e-1].name:y.a.createElement("span",null,"LONG")}},{title:"字节数",dataIndex:"length",width:"90px"},{title:"数据属性",ellipsis:!0,dataIndex:"dataProperty",render:function(e,t,n){var a="";if(10==t.functionDataType){var r=t.extend||[],o=N[r[0].functionDataType-1].name;a="".concat(r.length,"个").concat(o,"型元素")}else if(11==t.functionDataType){(t.extend||[]).map(function(e,t){var n=e.gap,r=e.mulriple,o=e.unit,i=e.range;a+="数值范围：".concat(i||"--",", 间距：").concat(n||"--",", 倍数：").concat(r||"--",", 单位：").concat(o||"--")})}else{var i=t.gap,c=t.mulriple,l=t.unit,u=t.range;a="数值范围：".concat(u||"--",", 间距：").concat(i||"--",", 倍数：").concat(c||"--",", 单位：").concat(l||"--")}return y.a.createElement("span",{key:"dataProperty"+n},a)}},{title:"是否保留字",dataIndex:"ignore",width:"110px",render:function(e){return y.a.createElement("span",null,e?"是":"否")}}],_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(o,m["Component"]);var t,n,a,r=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=P(e);if(t()){var r=P(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return j(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).state={controlList:[],runList:[],errList:[],configList:[]},t}return t=o,(n=[{key:"filterPannel",value:function(){var e=this.props.protocolList||{},t=e["控制数据"]||[],n=e["运行数据"]||[],a=e["故障数据"]||[],r=e["配置数据"]||[];return{dataSource:t.concat(n,a,r),controlList:t,runList:n,errList:a,configList:r}}},{key:"render",value:function(){var e=this.filterPannel(),t=e.dataSource,n=e.controlList,a=e.runList,r=e.errList,o=e.configList;return y.a.createElement(S.a,{animated:!1,className:"protocoltable"},y.a.createElement(T,{tab:"全部",key:"0"},y.a.createElement(w.a,{tableLayout:"fixed",bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:t,pagination:!1})),y.a.createElement(T,{tab:"控制数据",key:"1"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:n,pagination:!1})),y.a.createElement(T,{tab:"运行数据",key:"2"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:a,pagination:!1})),y.a.createElement(T,{tab:"故障数据",key:"3"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:r,pagination:!1})),y.a.createElement(T,{tab:"配置数据",key:"4"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:o,pagination:!1})))}}])&&C(t.prototype,n),a&&C(t,a),o}(),M=n(1376),A=n(31);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){U(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=d.a.Item,H=(p.a.Option,x=Object(h.b)(function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}}),L=d.a.create({name:"template"}),x(D=Object(b.g)(D=L(D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(b,m["Component"]);var t,n,p,h=function(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}return function(){var n,a=W(e);if(t()){var r=W(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return J(this,n)}}(b);function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(t=h.call(this,e)).handeleUpdate=function(e){e.protocolTemplateId=t.state.protocolTemplateId,Object(E.d)(e).then(function(e){t.props.history.push("/config/protocoltemplate/list")})},t.handleAdd=function(e){Object(E.b)(e).then(function(e){t.props.history.push("/config/protocoltemplate/list")})},t.handleSubmit=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll(function(e,n){if(!e){if(!n.deviceTypeSelect||!n.deviceTypeSelect.deviceTypeId)return void f.a.warn({message:"提示",description:"请选择设备类型"});var a=n.deviceTypeSelect.deviceTypeId||"",r=n.deviceTypeSelect.deviceSubTypeId||"",o={templateName:n.templateName||"",deviceTypeId:a,deviceSubtypeId:r,templateStatus:n.templateStatus,remark:n.remark||"",language:n.language,bindTypeIds:n.bindTypeIds.join(",")};t.state.templateId&&(o.tempId=t.state.templateId),o=A.d.filterParam(o),t.state.isEdit?t.handeleUpdate(o):t.handleAdd(o)}})},t.state={isEdit:!1,templateNumber:"0",bindTypeList:[],protocolTempList:[],protocolTemplateId:"",templateId:null,bindTypeIds:[],templateName:"",deviceTypeId:void 0,deviceSubtypeId:void 0,templateStatus:"",remark:"",language:""},t}return t=b,(n=[{key:"checkDeviceTypeSelect",value:function(e,t,n){t.deviceTypeId&&t.deviceSubTypeId?n():n("请选择设备分类")}},{key:"componentDidMount",value:function(){var e=this;Object(g.b)().then(function(t){if(t.data.code===O.a){var n=t.data.data;n?e.setState({bindTypeList:n}):f.a.warn({message:"提示",description:"获取数据字段为空"})}});var t=this.props.match.params;if(t&&t.templateNumber){this.setState({isEdit:!0,templateNumber:t.templateNumber});var n=t.templateNumber;Object(E.a)(n).then(function(t){if(t.data.code===O.a){var n=t.data.data,a=(n.bindTypeIds||"").split(",");a=a.map(function(e){return+e}),e.setState({templateName:n.templateName||"",deviceTypeId:n.deviceTypeId||"",deviceSubtypeId:n.deviceSubtypeId||"",catagoryId:n.categoryId||"",subCategoryId:n.subCategoryId||"",templateStatus:n.templateStatus+"",templateNumber:n.templateNumber,remark:n.remark||"",language:n.language+"",protocolTempList:n.map||[],protocolTemplateId:n.protocolTemplateId||"",bindTypeIds:a||[]})}})}}},{key:"handelUploadFile",value:function(e){if(console.log("info.file---",e.file),e.file.status,"done"===e.file.status){var t=e.file.response;if(t.code===O.a){var n=t.data;this.setState({protocolTempList:n.map,templateId:n.tempId}),s.a.success("".concat(e.file.name," 文件上传成功， 文件ID： ").concat(t.data.tempId))}else{var a=t.data;s.a.error("".concat(e.file.name," 文件上传失败， 原因： ").concat(a),10)}}else"error"===e.file.status&&s.a.error("".concat(e.file.name," 文件上传失败"))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.isEdit||!1,n=this.state.bindTypeList,s=this.props.deviceCategoryList||[],f=this.state,p=f.bindTypeIds,m=f.templateName,h=f.deviceTypeId,b=f.deviceSubtypeId,g=f.catagoryId,E=f.subCategoryId,O=f.templateStatus,w=f.remark,S=f.language,I={initialValue:{categoryId:g,subCategoryId:E,deviceTypeId:h,deviceSubTypeId:b}};return y.a.createElement("div",null,y.a.createElement(a.a,null,y.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},y.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},t?"编辑协议模板":"新增协议模板"),y.a.createElement("div",null,y.a.createElement(v.b,{to:"/config/protocoltemplate/list",style:{padding:"10px"}},y.a.createElement(u.a,{type:"left"})," 返回"))),y.a.createElement(d.a,q({},{labelCol:{span:2},wrapperCol:{span:22}},{onSubmit:this.handleSubmit}),y.a.createElement(G,{label:"模板名称"},e("templateName",{initialValue:m,rules:[{required:!0,message:"模板名称不能为空"}]})(y.a.createElement(l.a,{maxLength:30,type:"text",style:{width:"300px"},placeholder:"请输入您喜欢的模板名称"}))),y.a.createElement(G,{label:"所属分类"},e("deviceTypeSelect",V(V({},I),{},{rules:[{required:!0,message:"请选择所属分类",validator:this.checkDeviceTypeSelect.bind(this)}]}))(y.a.createElement(M.a,{deviceCategoryList:s}))),y.a.createElement(G,{label:"技术方案"},e("bindTypeIds",{initialValue:p,rules:[{required:!0,message:"请您选择技术方案"}]})(y.a.createElement(c.a.Group,null,n.map(function(e){return y.a.createElement(c.a,{value:e.bindTypeId,key:e.bindTypeName},e.bindTypeName)})))),y.a.createElement(d.a.Item,{label:"语言版本"},e("language",{rules:[{required:!0,message:"请选择语言版本"}],initialValue:S})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"0",key:"0"},"中文"),y.a.createElement(i.a,{value:"1",key:"1"},"英文")))),y.a.createElement(d.a.Item,{label:"状态"},e("templateStatus",{rules:[{required:!0,message:"请选择发布状态"}],initialValue:O})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"1",key:"1"},"正式"),y.a.createElement(i.a,{value:"0",key:"0"},"草稿")))),y.a.createElement(G,{label:"模板设置"},e("tempId",{rules:[{required:!t,message:"选择模板"}]})(y.a.createElement("div",null,y.a.createElement(r.a,{name:"uploadJson",showUploadList:!1,action:"/v1/web/manage-open/protocol/template/importJson",onChange:this.handelUploadFile.bind(this),accept:".json"},y.a.createElement(o.a,null,y.a.createElement(u.a,{type:"upload"})," 选择模板")),y.a.createElement("div",null,"（仅支持导入json文件类型，文件扩展名：.json，",y.a.createElement("a",{href:"/v1/web/manage-open/protocol/template/download",style:{color:"#27a9e3"}},"下载模板范本"),"）")))),y.a.createElement(G,{label:"备注"},e("remark",{initialValue:w})(y.a.createElement(l.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容",maxLength:100}))),y.a.createElement(G,{label:"数据分类"},y.a.createElement(_,{protocolList:this.state.protocolTempList})),y.a.createElement(o.a,{htmlType:"submit",style:{float:"right"}},"提交"))))}}])&&z(t.prototype,n),p&&z(t,p),b}())||D)||D)||D);t.default=H}}]);