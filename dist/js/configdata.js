(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1447:function(e,t,n){"use strict";n(112),n(78),n(159),n(226),n(494),n(158),n(113),n(58),n(41),n(261),n(390),n(50),n(51),n(18),n(39),n(43),n(32),n(44),n(142),n(35),n(22),n(36),n(26),n(27),n(28);var r=n(0);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var a=m(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(m,t);var n,a,i,d=p(m);function m(){var e;u(this,m);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=d.call.apply(d,[this].concat(n))).state={pageIndex:1},e.onChange=function(t){var n=e.state.pageIndex;e.setState({pageIndex:t||n||1},(function(){var t=e.state,n=[];for(var r in t)t[r]&&n.push("".concat(r,"=").concat(t[r]));e.props.history.replace("?"+n.join("&")),e.props.getList(c({},t))}))},e.onFilter=function(t){var n=e.props.form;n&&(t=n.getFieldsValue()),e.setState(c({},t),(function(){e.onChange(1)}))},e.onReset=function(){var t=e.props.form;t&&t.resetFields()},e}return n=m,(a=[{key:"componentDidMount",value:function(){var e=this,t={pageIndex:1},n=this.props.history.location.search;n&&n.length&&n.slice(1).split("&").map((function(e){if(/^(.+)=(.+)$/.test(e)){var n=e.split("=");t[n[0]]=decodeURI(n[1])}})),this.setState(c({},t),(function(){e.props.getList(t)}));var r=this.props.form;if(r){var a=r.getFieldsValue(),o=Object.keys(a);for(var i in t)o.includes(i)&&r.setFieldsValue(l({},i,+t[i]||t[i]))}}},{key:"render",value:function(){return r.createElement(e,o({},this.props,{onChange:this.onChange,onFilter:this.onFilter,onReset:this.onReset,query:this.state}))}}])&&s(n.prototype,a),i&&s(n,i),m}(r.Component)}},1449:function(e,t,n){"use strict";n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28);var r=n(0),a=n(12),o=n.n(a);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var a=p(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(p,t);var n,a,i,f=s(p);function p(){return c(this,p),f.apply(this,arguments)}return n=p,(a=[{key:"componentDidMount",value:function(){var e=o.a.findDOMNode(this);e&&e.parentElement&&e.parentElement.parentElement&&(e.parentElement.parentElement.scrollTop=0)}},{key:"render",value:function(){return r.createElement(e,this.props)}}])&&l(n.prototype,a),i&&l(n,i),p}(r.Component)}},1452:function(e,t,n){"use strict";n(41),n(18),n(142),n(50),n(51),n(35),n(36),n(113),n(311);var r=n(228),a=(n(263),n(128)),o=(n(58),n(122),n(39),n(261),n(390),n(32),n(78),n(158),n(112),n(133),n(27),n(26),n(22),n(852),n(853),n(854),n(855),n(856),n(857),n(858),n(859),n(860),n(861),n(862),n(863),n(864),n(865),n(866),n(867),n(868),n(28),n(0));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=["children"],l=["children"];function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var a=y(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var v=a.a.TreeNode;var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(m,e);var t,n,i,s=d(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=s.call(this,e)).handleCheck=function(e,n){"function"==typeof t.props.onChange&&t.props.onChange(e,n)},t.handleSelect=function(e,n){var r=t.state.expandedKeys,a=n.node.props.eventKey;r.includes(a)?t.setState({expandedKeys:r.filter((function(e){return e!==a}))}):t.setState({expandedKeys:[].concat(u(r),[a])})},t.handleExpand=function(e){t.setState({expandedKeys:e})},t.state={expandedKeys:[],selectedKeys:[]},t}return t=m,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isExpand,n=e.dataSource,r=[];t&&function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;t&&t.forEach((function(t){t.children&&t.children.length&&r.push(n+t.id),e(t.children,n+t.id+"-",r)}))}(n,"",r),this.setState({expandedKeys:r})}},{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.target,i=e.isCheck,u=void 0===i||i,s=e.checkStrictly,f=void 0!==s&&s,p=e.searchStr,d=void 0===p?"":p,m=this.state,y=m.expandedKeys,g=m.selectedKeys,E=u&&!f?n:Array.from(new Set(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.map((function(e){var n=e.split("-"),r="";n.map((function(e){e&&(r+=e,t.push(r),r+="-")}))})),t}(n)));return u||E.length?o.createElement(a.a,{blockNode:!0,checkable:u,defaultExpandParent:!0,multiple:!0,showLine:!u,checkStrictly:f,selectedKeys:g,checkedKeys:E,expandedKeys:y,onCheck:this.handleCheck,onSelect:this.handleSelect,onExpand:this.handleExpand},u?function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map((function(t){var a=t.children,i=b(t,c),l=i.name.toLowerCase(),u=r.toLowerCase(),s=l.indexOf(u),f=i.name.substr(0,s),p=i.name.substring(s,s+r.length),d=i.name.substr(s+r.length),m=s>-1?o.createElement("span",null,f,o.createElement("span",{style:{color:"#f50"}},p),d):o.createElement("span",null,i.name);return o.createElement(v,h({},i,{key:n+i.id,title:m}),e(a,n+i.id+"-",r))}))}(t,"",d):function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t&&t.map((function(t){var a=t.children,i=b(t,l);return n.includes(r+i.id)?o.createElement(v,h({},i,{disableCheckbox:!0,key:r+i.id,title:i.name}),e(a,n,r+i.id+"-")):null})).filter((function(e){return e}))}(t,E)):o.createElement(r.a,null)}}])&&f(t.prototype,n),i&&f(t,i),m}(o.Component);t.a=g},1456:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n(3),a=function(e){return r.c.request({url:"/manage-open/panel/template/list",params:e,method:"get"})},o=function(e){return r.c.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},i=function(e){return r.c.request({url:"/manage-open/panel/template/saveTemplate",data:e,method:"post"})},c=function(e){return r.c.request({url:"/manage-open/panel/template/delTemplate",data:e,method:"post"})},l=function(e){return r.c.request({url:"/manage-open/panel/template/get",params:e,method:"get"})}},1461:function(e,t,n){"use strict";n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(142),n(35),n(22),n(36),n(26),n(27),n(28),n(157);var r=n(37),a=(n(58),n(0)),o=n.n(a);n(314),n(9),n(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var a=y(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=r.a.Option,b={},v={},g={},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(l,e);var t,n,a,i=d(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).triggerChange=function(e){var n=t.props.onChange;n&&(t.props.value?n(u({categoryId:t.props.value.categoryId,subCategoryId:t.props.value.subCategoryId,deviceTypeId:t.props.value.deviceTypeId,deviceSubTypeId:t.props.value.deviceSubTypeId},e)):n(u({},e)))};t.props.value;return t.state={deviceSubCategoryList:[],deviceTypeList:[],isCalculate:!1},t}return t=l,(n=[{key:"deviceCategorySelect",value:function(e){if(b[e]){var t=b[e];this.setState({deviceSubCategoryList:t})}this.triggerChange({categoryId:e,subCategoryId:void 0,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceSubCategorySelect",value:function(e){if(v[e]){var t=v[e];this.setState({deviceTypeList:t})}this.triggerChange({subCategoryId:e,deviceTypeId:void 0,deviceSubTypeId:void 0})}},{key:"deviceTypeListSelect",value:function(e){if(g[e]){var t=g[e].defaultDeviceSubtype.deviceSubtypeId;this.triggerChange({deviceTypeId:g[e].deviceTypeId,deviceSubTypeId:t})}}},{key:"componentDidMount",value:function(){this.props.deviceCategoryList}},{key:"componentWillUpdate",value:function(e,t){var n=this;if(!this.state.isCalculate&&e.value&&e.deviceCategoryList&&e.deviceCategoryList.length>0){var r=e.value.categoryId,a=e.value.subCategoryId;if(!r||!a)return;e.deviceCategoryList.map((function(e,t){if(b[e.categoryId]=e.subCategoryList,e.categoryId==r){var o=e.subCategoryList;n.setState({deviceSubCategoryList:o}),o.map((function(e,t){if(v[e.subCategoryId]=e.deviceTypeList,e.subCategoryId==a){var r=e.deviceTypeList;n.setState({deviceTypeList:r}),r.map((function(e,t){g[e.deviceTypeId]=e}))}}))}})),this.setState({isCalculate:!0})}}},{key:"render",value:function(){var e=this.props.deviceCategoryList||[],t=this.state.deviceSubCategoryList,n=this.state.deviceTypeList,a={},i={},l={};if(void 0!==this.props.value){var u=this.props.value.subCategoryId,s=this.props.value.categoryId;this.props.value.deviceSubTypeId,a={value:s},i={value:u},l={value:this.props.value.deviceTypeId}}return o.a.createElement("div",null,o.a.createElement(r.a,c({onSelect:this.deviceCategorySelect.bind(this),placeholder:"选择一级类目",style:{width:150}},a),e.map((function(e,t){return b[e.categoryId]=e.subCategoryList,o.a.createElement(h,{value:e.categoryId,key:t},e.categoryName)}))),o.a.createElement(r.a,c({onSelect:this.deviceSubCategorySelect.bind(this),placeholder:"选择二级类目",style:{width:150}},i),t.map((function(e,t){return v[e.subCategoryId]=e.deviceTypeList,o.a.createElement(h,{value:e.subCategoryId,key:t},e.subCategoryName)}))),o.a.createElement(r.a,c({onSelect:this.deviceTypeListSelect.bind(this),placeholder:"选择三级类目",style:{width:150}},l),n.map((function(e,t){return g[e.deviceTypeId]=e,o.a.createElement(h,{value:e.deviceTypeId,key:t},e.deviceTypeName)}))))}}])&&f(t.prototype,n),a&&f(t,a),l}(a.Component);t.a=E},1462:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n(3),a="manage-open",o=function(e){return r.c.request({url:"/".concat(a,"/param/dictionary/list"),params:e,method:"get"})},i=function(e){return r.c.request({url:"/".concat(a,"/param/dictionary/get"),params:{paramId:e},method:"get"})},c=function(e){return r.c.request({url:"/".concat(a,"/param/dictionary/add"),data:e,method:"post"})},l=function(e){return r.c.request({url:"/".concat(a,"/param/dictionary/update"),data:e,method:"post"})},u=function(e){return r.c.request({url:"/".concat(a,"/param/dictionary/delete"),params:{paramId:e},method:"get"})}},1469:function(e,t,n){},1470:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(3),a="manage-open",o=function(e){return r.c.request({url:"/".concat(a,"/protocol/template/getList"),params:e,method:"get"})},i=function(e){return r.c.request({url:"/".concat(a,"/protocol/template/getByTemplateNumber"),params:{templateNumber:e},method:"get"})},c=function(e){return r.c.request({url:"/".concat(a,"/protocol/template/update"),data:e,method:"post"})},l=function(e){return r.c.request({url:"/".concat(a,"/protocol/template/insert"),data:e,method:"post"})}},1477:function(e,t,n){},1478:function(e,t,n){},1479:function(e,t,n){},1480:function(e,t,n){},1481:function(e,t,n){},1482:function(e,t,n){},1483:function(e,t,n){},1484:function(e,t,n){},1485:function(e,t,n){},1486:function(e,t,n){},1487:function(e,t,n){},1488:function(e,t,n){},1537:function(e,t,n){"use strict";n.r(t),n.d(t,"H5TemplateInfo",(function(){return x}));n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(142),n(35),n(36),n(26),n(27),n(28),n(104);var r=n(46),a=(n(69),n(19)),o=(n(200),n(85)),i=(n(849),n(493)),c=(n(103),n(48)),l=(n(172),n(7)),u=(n(223),n(123)),s=(n(157),n(37)),f=(n(132),n(23)),p=(n(391),n(22),n(65),n(389),n(122),n(58),n(78),n(158),n(224),n(0)),d=n.n(p),m=n(1456),y=(n(1469),n(33));function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=f.a.Item,P=s.a.Option,x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(v,e);var t,n,p,h=j(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=h.call(this,e)).getH5TemplateInfo=function(e){t.setState({loading:!0}),Object(m.c)({templateId:e}).then((function(e){var n=e.data;if(0===n.code){var r=t.doWithPages(n.data);t.setState({templateInfo:n.data,fileList:r})}})).finally((function(){t.setState((function(){return{loading:!1}}))}))},t.doWithPages=function(e){for(var t=[],n=0;n<=5;n++){var r="page".concat(n),a=e[r];e[r]&&t.push({url:a,status:"done",type:"image/png",name:"page".concat(n),uid:n})}return t},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){w(o,r,a,i,c,"next",e)}function c(e){w(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.handleChange=function(e){"error"===e.file.status?(u.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),t.setState({fileList:e.fileList})},t.getBase64=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},t.handleSubmit=function(){var e=t.state,n=e.templateInfo,r=e.fileList,a={};r.length<=0?u.a.warning("请上传模板图片!"):(r.map((function(e,t){"done"===e.status&&(e.hasOwnProperty("url")?a["page".concat(t+1)]=e.url:a["page".concat(t+1)]=e.response.data.url)})),t.props.form.validateFields((function(e,r){if(!e){console.log("values =====",r);var o=g(g({},r),{},{templateNumber:n.templateNumber,templateId:n.templateId,deviceTypeId:n.deviceTypeId,deviceSubtypeId:n.deviceSubtypeId},a);delete o.templatePicList,t.setState({loading:!0}),Object(m.e)(o).then((function(e){0===e.data.code&&u.a.success("模板信息更新成功",3,t.props.history.goBack())})).finally((function(){t.setState((function(){return{loading:!1}}))}))}})))},t.getCategoryList=function(e){return"string"==typeof e?e.split("-"):["","",""]},t.usercodeValidator=function(e,t,n){t||n("内容不能为空")},t.state={templateInfo:{},fileList:[],productNameList:[]},t}return t=v,(n=[{key:"componentWillMount",value:function(){var e=this.props.match.params;e&&e.templateId&&this.getH5TemplateInfo(e.templateId)}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||u.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||u.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:y.j,data:function(e){return{appId:31438,domainType:4}}},t=this.state,n=t.templateInfo,u=t.fileList,p=this.props.form.getFieldDecorator,m={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:15}}},h=d.a.createElement("div",null,d.a.createElement(l.a,{type:"plus"}),d.a.createElement("div",{className:"ant-upload-text"},"Upload")),v=this.getCategoryList(n.allCategoryName);return d.a.createElement("div",null,d.a.createElement(r.a,{title:"模板基本信息",loading:this.state.loading},d.a.createElement(f.a,{layout:"horizontal",className:"CreataH5Template_from"},d.a.createElement(k,b({label:"模板名称"},m),p("templateName",{initialValue:n.templateName,rules:[{required:!0,message:"模板名称不能为空"}]})(d.a.createElement(c.a,{style:{width:"460px"},type:"text",placeholder:"请输入您喜欢的模板名称",disabled:Boolean(n.status),allowClear:Boolean(!n.templateId),maxLength:20}))),d.a.createElement(f.a.Item,b({className:"chooseProduct",label:"所属分类"},m),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceTypeId",{initialValue:v[0],rules:[{required:!0,message:"请您选择一级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"一级类目"}))),d.a.createElement("span",null," "),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceSubtypeId",{initialValue:v[1],rules:[{required:!0,message:"请您选择二级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),placeholder:"二级类目"}))),d.a.createElement("span",null," "),d.a.createElement(f.a.Item,{style:{display:"inline-block",width:"150px"}},p("deviceSubtypeId",{initialValue:v[2],rules:[{required:!0,message:"请您选择三级类目"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),initialValue:n.deviceSubtypeId,placeholder:"三级类目"})))),d.a.createElement(k,b({},m,{label:"产品协议"}),p("templateNumber",{initialValue:n.protocolTemplateName,rules:[{required:!0,message:"请您选择协议"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择协议"}))),d.a.createElement(k,b({},m,{label:"性质"}),p("isFree",{initialValue:1,rules:[{required:!0,message:"请您选择性质"}]})(d.a.createElement(s.a,{disabled:Boolean(n.templateId),style:{width:150},placeholder:"请选择"},d.a.createElement(P,{value:1},"免费")))),d.a.createElement(k,b({},m,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"}),p("templatePicList",{initialValue:u,rules:[{required:!0,message:"请上传一张图片"}]})(d.a.createElement("div",{className:"product-div"},d.a.createElement(i.a,b({},e,{accept:"image/png",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),u.length>=5?null:h),d.a.createElement(o.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},d.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),d.a.createElement(k,b({},m,{label:"描述"}),p("remark",{initialValue:n.remark})(d.a.createElement(c.a.TextArea,{disabled:Boolean(this.state.status),style:{width:460},onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))),Boolean(this.state.status)?d.a.createElement("div",null):d.a.createElement(k,{style:{textAlign:"center"}},d.a.createElement(a.a,{type:"primary",onClick:this.handleSubmit},"保存")))))}}])&&O(t.prototype,n),p&&O(t,p),v}(p.Component);t.default=f.a.create()(x)},1538:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(35),n(22),n(36),n(26),n(27),n(28),n(104);var r,a=n(46),o=(n(103),n(48)),i=(n(223),n(123)),c=(n(1415),n(1416)),l=(n(225),n(86)),u=(n(69),n(19)),s=(n(157),n(37)),f=(n(132),n(23)),p=(n(122),n(142),n(0)),d=n.n(p),m=(n(45),n(1462)),y=n(9),h=n(33),b=n(97);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=f.a.Item,P=(s.a.Option,f.a.create()(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(p,e);var t,n,r,s=I(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=s.call(this,e)).column=[{title:"参数ID",dataIndex:"paramId",key:"paramId",width:"80px"},{title:"名称",dataIndex:"name",key:"name",width:"15%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"参数值",dataIndex:"value",key:"value",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"desc",key:"desc",width:"25%",render:function(e){return d.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"status",key:"status",width:"100px",render:function(e){return d.a.createElement("span",null,e?"有效":"无效")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return d.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"操作",dataIndex:"paramId",key:"operation",width:"120px",render:function(e){return d.a.createElement("div",null,d.a.createElement(l.a,{title:"编辑",placement:"top"},d.a.createElement(u.a,{onClick:t.pushToDetail.bind(S(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",d.a.createElement(c.a,{title:"确认要删除吗",onConfirm:t.deleteDataDic.bind(S(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},d.a.createElement(l.a,{title:"删除",placement:"top"},d.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={pageIndex:1,pageRows:10,dataManagerList:[],totalRows:0,searchParams:{},loading:!1,pager:{}},t}return t=p,(n=[{key:"pushToDetail",value:function(e){this.props.history.push("/config/datadic/edit/".concat(e))}},{key:"deleteDataDic",value:function(e){var t=this;Object(m.b)(e).then((function(e){e.data.code===y.a&&(i.a.success("删除成功"),t.requestListData())})).catch((function(e){i.a.error("删除失败")}))}},{key:"handleReset",value:function(){this.props.form.resetFields(["name"]),this.setState({pageIndex:0,searchParams:{}}),this.requestListData({pageIndex:0,name:""})}},{key:"handleFilter",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e,n){if(!e){console.log("Received values of form: ",n);var r=n.name;t.setState({searchParams:{name:r}}),t.requestListData({name:r,pageIndex:0})}}))}},{key:"componentDidMount",value:function(){this.requestListData()}},{key:"requestListData",value:function(e){var t=this,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({pageIndex:this.state.pageIndex,pageRows:this.state.pageRows,order:"asc"},this.state.searchParams);e&&(n=Object.assign({},n,e)),this.setState({loading:!0}),Object(m.e)(n).then((function(e){if(e.data.code===y.a){var n=e.data.data;t.setState({dataManagerList:n.list,totalRows:n.pager.totalRows,pageIndex:n.pager.pageIndex,loading:!1,pager:n.pager})}})).catch((function(e){t.setState({loading:!0})}))}},{key:"addDataDic",value:function(){this.props.history.push("/config/datadic/add")}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({pageIndex:e}),this.requestListData({pageRows:this.state.pageRows,pageIndex:e})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.dataManagerList;return d.a.createElement("div",{style:{minWidth:"1400"}},d.a.createElement(a.a,null,d.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"数据字典管理"),d.a.createElement(f.a,{layout:"inline",onSubmit:this.handleFilter.bind(this)},d.a.createElement(k,{label:"名称"},e("name")(d.a.createElement(o.a,{style:{width:"240px"},placeholder:"请输入名称"}))),d.a.createElement(k,null,d.a.createElement(u.a,{type:"primary",htmlType:"submit"},"查询")),d.a.createElement(k,null,d.a.createElement(u.a,{onClick:this.handleReset.bind(this)},"重置")),d.a.createElement(k,null,d.a.createElement(u.a,{type:"primary",onClick:this.addDataDic.bind(this)},"新增")))),d.a.createElement(a.a,{style:{marginTop:"10px"}},d.a.createElement(b.a,{rowKey:function(e){return e.paramId},columns:this.column,dataSource:t,bordered:!0,pager:this.state.pager,loading:this.state.loading,onPageChange:this.handlePagination.bind(this)})))}}])&&w(t.prototype,n),r&&w(t,r),p}(p.Component))||r);t.default=P},1539:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(142),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(69);var r,a,o,i=n(19),c=(n(488),n(174)),l=(n(103),n(48)),u=(n(104),n(46)),s=(n(172),n(7)),f=(n(157),n(37)),p=(n(132),n(23)),d=(n(78),n(224),n(122),n(0)),m=n.n(d),y=n(45),h=n(40),b=n(1462),v=n(9),g=n(33);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=p.a.Item,P=(f.a.Option,r=Object(y.b)((function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"])}})),a=p.a.create({name:"template"}),r(o=Object(h.withRouter)(o=a(o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(o,e);var t,n,r,a=j(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).handeleUpdate=function(e){e.paramId=t.state.paramId,Object(b.d)(e).then((function(e){t.props.history.push("/config/datadic/list")}))},t.handleAdd=function(e){Object(b.a)(e).then((function(e){t.props.history.push("/config/datadic/list")}))},t.handleSubmit=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll((function(e,n){if(!e){console.log("Received values of form: ",n);var r={name:n.dicname,status:n.dicstatus,desc:n.dicdesc,value:n.dicvalue};r=g.d.filterParam(r),t.state.isEdit?t.handeleUpdate(r):t.handleAdd(r)}}))},t.state={isEdit:!1,paramId:"",dicname:"",dicstatus:"",dicdesc:"",dicvalue:""},t}return t=o,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if(t&&t.paramId){this.setState({isEdit:!0,paramId:t.paramId});var n=t.paramId;Object(b.c)(n).then((function(t){if(t.data.code===v.a){var n=t.data.data;e.setState({paramId:n.paramId,dicname:n.name,dicstatus:n.status+"",dicdesc:n.desc,dicvalue:n.value})}}))}}},{key:"render",value:function(){var e={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:4}}},t=this.props.form.getFieldDecorator,n=this.state.isEdit||!1,r=this.state,a=r.dicname,o=r.dicstatus,f=r.dicdesc,d=r.dicvalue;return m.a.createElement("div",null,m.a.createElement(u.a,null,m.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},m.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},n?"编辑数据字典":"新增数据字典"),m.a.createElement("div",null,m.a.createElement(h.Link,{to:"/config/datadic/list",style:{padding:"10px"}},m.a.createElement(s.a,{type:"left"})," 返回")))),m.a.createElement(u.a,{style:{marginTop:"20px"}},m.a.createElement(p.a,w({},{labelCol:{xs:{span:16},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),m.a.createElement(k,{label:"名称"},t("dicname",{initialValue:a,rules:[{required:!0,message:"模板名称不能为空"}]})(m.a.createElement(l.a,{type:"text",style:{width:"300px"},maxLength:30,placeholder:"请输入您喜欢的模板名称,长度不超过30"}))),m.a.createElement(k,{label:"参数值"},t("dicvalue",{initialValue:d,rules:[{required:!0,message:"参数值不能为空"}]})(m.a.createElement(l.a.TextArea,{rows:7,placeholder:"请输入参数值,限制内容长度5000",maxLength:5e3}))),m.a.createElement(p.a.Item,{label:"状态"},t("dicstatus",{rules:[{required:!0,message:"请选择状态"}],initialValue:o})(m.a.createElement(c.a.Group,{style:{width:150}},m.a.createElement(c.a,{value:"1"},"有效"),m.a.createElement(c.a,{value:"0"},"无效")))),m.a.createElement(k,{label:"描述"},t("dicdesc",{rules:[{required:!0,message:"请输入描述"}],initialValue:f})(m.a.createElement(l.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容,限制内容长度50",maxLength:50}))),m.a.createElement(k,e,m.a.createElement(i.a,{type:"primary",htmlType:"submit"},n?"保存":"添加")))))}}])&&O(t.prototype,n),r&&O(t,r),o}(d.Component))||o)||o)||o);t.default=P},1548:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(104);var r,a=n(46),o=(n(315),n(96)),i=(n(78),n(159),n(158),n(0)),c=n.n(i),l=n(316),u=n(40),s=n(45),f=(n(200),n(85)),p=(n(103),n(48)),d=(n(91),n(24)),m=(n(1415),n(1416)),y=(n(225),n(86)),h=(n(69),n(19)),b=(n(157),n(37)),v=(n(132),n(23)),g=(n(1422),n(1425)),E=(n(58),n(870),n(499)),w=(n(223),n(123)),O=(n(122),n(142),n(9)),I=(n(1461),n(97));n(1484);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var a=x(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return P(this,n)}}function P(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T,L=v.a.Item,D=Object(s.b)((function(e){return{deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}}))(r=v.a.create()(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(o,e);var t,n,r,a=k(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).state={dataSource:[],pageIndex:0,pageRows:10,isLoading:!1,pager:{},searchParams:{}},t}return t=o,(n=[{key:"handelUploadFile",value:function(e){if(e.file.status,"done"===e.file.status){var t=e.file.response;0==t.code?(w.a.success("".concat(e.file.name," 文件上传成功")),this.refreshTable()):w.a.error("".concat(t.msg))}else"error"===e.file.status&&w.a.error("".concat(e.file.name," 文件上传失败."),10)}},{key:"refreshTable",value:function(){console.log("refresh Table");var e={pageRows:this.state.pageRows,pageIndex:this.state.current};this.getChildTableRequest(e)}},{key:"handleSearch",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e,n){console.log("value:"+JSON.stringify(n));var r={};t.props.filterPannel.map((function(e,t){if("DeviceType"==e.type){var a=n.deviceTypeSelect;if(a&&3==a.length){var o=e.paramskey,i=a[2];r[o]=i}}else{var c=e.paramskey,l=n[c];l&&(r[c]=l)}})),t.setState({searchParams:r}),t.getChildTableRequest(r)}))}},{key:"handlePagination",value:function(e){this.setState({pageIndex:e});var t={pageRows:this.state.pageRows,pageIndex:e};t=Object.assign({},this.state.searchParams,t),this.getChildTableRequest(t)}},{key:"getFilterPannel",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.deviceCascaderList;return this.props.filterPannel.map((function(n,r){return"Input"===n.type?c.a.createElement(L,{label:n.title,key:r},e(n.paramskey)(c.a.createElement(p.a,{placeholder:n.placeholder,maxLength:20,style:{width:"260px"}}))):"DeviceType"===n.type?c.a.createElement(L,{label:n.title,key:r},e("deviceTypeSelect")(c.a.createElement(E.a,{options:t,placeholder:"请选择所属分类",style:{width:"260px"}}))):c.a.createElement("span",null)}))}},{key:"componentDidMount",value:function(){this.getChildTableRequest(),this.props.refFunction(this.refreshTable.bind(this))}},{key:"getChildTableRequest",value:function(e){var t=this;this.setState({isLoading:!0}),this.props.getTableRequest(e).then((function(e){if(t.setState({isLoading:!1}),e.data.code===O.a){var n=e.data.data.list,r=e.data.data.pager;t.setState({dataSource:n,isLoading:!1,pager:r})}})).catch((function(e){t.setState({isLoading:!1})}))}},{key:"handleNewProtocolDic",value:function(){this.props.handleNewProtocolDic()}},{key:"resetFields",value:function(){this.setState({searchParams:{}}),this.props.form.resetFields()}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("div",{style:{marginBottom:"10px"}},c.a.createElement(h.a,{style:{float:"right"},type:"primary",onClick:this.handleNewProtocolDic.bind(this)},"新建")),c.a.createElement(v.a,{layout:"inline",onSubmit:this.handleSearch.bind(this),style:{marginBottom:"10px"}},this.getFilterPannel(),c.a.createElement(L,null,c.a.createElement(h.a,{htmlType:"submit"},"查询")),c.a.createElement(L,null,c.a.createElement(h.a,{onClick:this.resetFields.bind(this)},"重置"))),c.a.createElement(I.a,{className:"proptcolDicBase",bordered:!0,columns:this.props.columns,dataSource:this.state.dataSource,rowKey:this.props.rowKey,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,loading:this.state.isLoading}))}}])&&S(t.prototype,n),r&&S(t,r),o}(c.a.Component))||r)||r,N=n(241),R=n(33),_=n(497);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var a=U(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return q(this,n)}}function q(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return V(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var z=g.a.SHOW_PARENT,K=v.a.Item,J=b.a.Option,W=Object(s.b)((function(e){return{subjectMenuList:e.getIn(["globalProtocolDicInfo","subjectMenu"]),subjectExtendsMenuLsit:e.getIn(["globalProtocolDicInfo","subjectExtendsMenu"]),functionMenuList:e.getIn(["globalProtocolDicInfo","functionMenu"]),functionExtendsMenuList:e.getIn(["globalProtocolDicInfo","functionExtendsMenu"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}}),(function(e){return{getSubjectMenu:function(){e(_.e())},getSubjectExtendsMenu:function(){e(_.d())},getFunctionMenu:function(){e(_.c())},getFunctionExtendsMenu:function(){e(_.b())}}}))(T=v.a.create()(T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(o,e);var t,n,r,a=F(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).columns=[{title:"ID",dataIndex:"commonId",width:"100px"},{title:"协议数据",dataIndex:"protocolName"},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"协议类型",dataIndex:"dataTypeNameList",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"commonId",key:"0",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(y.a,{title:"编辑",placement:"top"},c.a.createElement(h.a,{onClick:t.handleEdit.bind(V(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(m.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(V(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(y.a,{title:"删除",placement:"top"},c.a.createElement(h.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={visibleModal:!1,isEdit:!1,commonData:{}},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.b)({commonId:e}).then((function(e){if(e.data.code===O.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}}))}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.a)({commonId:e}).then((function(e){e.data.code===O.a&&(d.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}))}},{key:"getTableRequest",value:function(e){return Object(N.d)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getSubjectMenu(),this.props.getSubjectExtendsMenu(),this.props.getFunctionMenu(),this.props.getFunctionExtendsMenu()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields((function(e,n){if(!e){console.log("validateFields: "+n);var r=n.selectDeviceType,a={},o=[];R.c.getDeviceTypeFromSelectList(r,t.props.deviceCategoryList).map((function(e,t){var n={deviceTypeId:e};o.push(n)})),a.deviceTypeList=o,a.protocolName=n.protocolName,a.subjectId=n.subjectId,a.functionId=n.functionId,n.subjectExtendId&&(a.subjectExtendId=n.subjectExtendId),n.functionExtendId&&(a.functionExtendId=n.functionExtendId),t.state.isEdit&&(a.commonId=t.state.commonData.commonId),Object(N.c)(a).then((function(e){e.data.code===O.a&&(console.log("保存： 成功"),d.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})),t.setState({visibleModal:!1,commonData:{}})}}))}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.subjectMenuList||[],n=this.props.subjectExtendsMenuLsit||[],r=this.props.functionMenuList||[],a=this.props.functionExtendsMenuList||[],o={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:z,searchPlaceholder:"请选择管理设备类型",style:{width:300},showArrow:!0},i={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},l=this.state.isEdit,u=l?this.state.commonData.protocolName:void 0,s=l?this.state.commonData.subjectId:void 0,d=l?this.state.commonData.subjectExtendId:void 0,m=l?this.state.commonData.functionId:void 0,y=l?this.state.commonData.functionExtendId:void 0,h=void 0;if(l){var E=this.state.commonData.deviceTypeList,w=[];E instanceof Array&&(E.map((function(e){var t=e.deviceTypeId;w.push(t)})),w.length>0&&(h=w))}return c.a.createElement("div",null,c.a.createElement(D,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"commonId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,deviceCascaderList:this.props.deviceCascaderList,filterPannel:[{type:"Input",title:"协议数据",paramskey:"protocolName",placeholder:"请输入协议数据"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/common/importExcel",download:"/v1/web/manage-open/protocol/dictionary/common/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(f.a,{title:this.state.isEdit?"编辑常用":"新建常用",visible:this.state.visibleModal,onOk:this.handleSubmitSave.bind(this),onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(v.a,i,c.a.createElement(K,{label:"协议数据"},e("protocolName",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:u})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(K,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!0,message:"请关联所属分类"}],initialValue:h})(c.a.createElement(g.a,o))),c.a.createElement(K,{label:"主体"},e("subjectId",{rules:[{required:!0,message:"请输入主体"}],initialValue:s})(c.a.createElement(b.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map((function(e,t){return c.a.createElement(J,{key:t,value:e.menuId},e.menuName)}))))),c.a.createElement(K,{label:"主体扩展名"},e("subjectExtendId",{rules:[{required:!1,message:"请输入主体数据"}],initialValue:d})(c.a.createElement(b.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map((function(e,t){return c.a.createElement(J,{key:t,value:e.menuId},e.menuName)}))))),c.a.createElement(K,{label:"功能"},e("functionId",{rules:[{required:!0,message:"请输入协议数据"}],initialValue:m})(c.a.createElement(b.a,{showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map((function(e,t){return c.a.createElement(J,{key:t,value:e.menuId},e.menuName)}))))),c.a.createElement(K,{label:"功能扩展名"},e("functionExtendId",{rules:[{required:!1,message:"请输入协议数据"}],initialValue:y})(c.a.createElement(b.a,{allowClear:!0,showSearch:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.map((function(e,t){return c.a.createElement(J,{key:t,value:e.menuId},e.menuName)}))))))))}}])&&B(t.prototype,n),r&&B(t,r),o}(c.a.Component))||T)||T;n(261),n(390);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var a=Z(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee,te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(o,e);var t,n,r,a=$(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).onChange=function(e,n){if(e.includes("all"))if((t.props.value||[]).length===t.props.children.length)t.triggerChange([]);else{var r=t.props.children.map((function(e){return e.props.value}));t.triggerChange(r)}else t.triggerChange(e)},t.triggerChange=function(e){var n=t.props.onChange;n&&n(e)},t}return t=o,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement(b.a,H({mode:"multiple"},this.props,{onChange:this.onChange,showArrow:!0}),c.a.createElement(b.a.Option,{key:"all",style:{backgroundColor:"#eee"}},c.a.createElement("span",{style:{fontWeight:"bold"}},"全选")),this.props.children)}}])&&Q(t.prototype,n),r&&Q(t,r),o}(c.a.Component);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ue(e);if(t){var a=ue(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}function ce(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return le(e)}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se,fe=v.a.Item,pe=Object(s.b)((function(e){return{functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}}),(function(e){return{getFunctionAllList:function(){e(_.a())}}}))(ee=v.a.create()(ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(o,e);var t,n,r,a=ie(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).columns=[{title:"ID",dataIndex:"subjectId",key:"subjectId",width:"100px"},{title:"主体（中文）",dataIndex:"subjectNameCN",key:"subjectNameCN"},{title:"主体（英文)",dataIndex:"subjectNameEN",key:"subjectNameEN"},{title:"主体标识",dataIndex:"subjectMark",key:"subjectMark"},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(y.a,{title:"编辑",placement:"top"},c.a.createElement(h.a,{onClick:t.handleEdit.bind(le(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(m.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(le(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(y.a,{title:"删除",placement:"top"},c.a.createElement(h.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.onChange=function(e){var n=t.props.functionAllList;t.setState({checkedList:e,indeterminate:!!e.length&&e.length<n.length,checkAll:e.length===n.length})},t.onCheckAllChange=function(e){var n=t.props.functionAllList;t.setState({checkedList:e.target.checked?n:[],indeterminate:!1,checkAll:e.target.checked})},t.state={commonData:{},visibleModal:!1,isEdit:!1},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.t)({subjectId:e}).then((function(e){if(e.data.code===O.a){var n=e.data.data,r=n.functionList,a=[];r.map((function(e){var t=e.functionId;a.push(t)})),n.functionList=a,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}}))}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.s)({subjectId:e}).then((function(n){n.data.code===O.a&&(console.log("删除： "+e+" 成功"),d.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}))}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"getTableRequest",value:function(e){return Object(N.v)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields((function(e,n){if(!e){console.log("validateFields: "+n);var r={};if(r.subjectNameCN=n.subjectNameCN,r.subjectNameEN=n.subjectNameEN,r.subjectMark=n.subjectMark,t.state.isEdit&&(r.subjectId=t.state.commonData.subjectId),n.functionList){var a=n.functionList,o=[];a.map((function(e){var t={functionId:e};o.push(t)})),r.functionList=o}Object(N.u)(r).then((function(e){e.data.code===O.a&&(d.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})),t.setState({visibleModal:!1,commonData:{}})}}))}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"render",value:function(){var e={labelCol:{span:24},wrapperCol:{span:24}},t=this.props.functionAllList||[],n=this.state.isEdit,r=n?this.state.commonData.subjectNameCN:void 0,a=n?this.state.commonData.subjectNameEN:void 0,o=n?this.state.commonData.subjectMark:void 0,i=n?this.state.commonData.functionList:void 0,l=this.props.form.getFieldDecorator;return c.a.createElement("div",null,c.a.createElement(D,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体",paramskey:"subjectNameCN",placeholder:"请输入主体名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/subject/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subject/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(f.a,{title:this.state.isEdit?"编辑主体":"新建主体",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(v.a,re({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(fe,{label:"主体-中文"},l("subjectNameCN",{rules:[{required:!0,message:"请输入主体中文"}],initialValue:r})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(fe,{label:"主体-英文"},l("subjectNameEN",{rules:[{required:!0,message:"请输入主体英文"}],initialValue:a})(c.a.createElement(p.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(fe,{label:"主体识符"},l("subjectMark",{rules:[{required:!0,message:"请输入主体识符"}],initialValue:o})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(fe,{label:"关联功能"},l("functionList",{rules:[{required:!1,message:"请输入关联功能"}],initialValue:i})(c.a.createElement(te,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map((function(e,t){return c.a.createElement(b.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)}))))),c.a.createElement(fe,e,c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(h.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(h.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&ae(t.prototype,n),r&&ae(t,r),o}(c.a.Component))||ee)||ee;function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(){return(me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var a=Ee(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===de(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=v.a.Item,Oe=g.a.SHOW_PARENT,Ie=Object(s.b)((function(e){return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"])}}))(se=v.a.create()(se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(o,e);var t,n,r,a=be(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).columns=[{title:"ID",dataIndex:"subjectExtendId",key:"subjectExtendId",width:"80px"},{title:"主体扩展名（中文）",dataIndex:"subjectExtendNameCN",key:"subjectExtendNameCN"},{title:"主体扩展名（英文）",dataIndex:"subjectExtendNameEN",key:"subjectExtendNameEN"},{title:"主体扩展名标识",dataIndex:"subjectExtendMark",key:"subjectExtendMark"},{title:"匹配所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"subjectExtendId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(y.a,{title:"编辑",placement:"top"},c.a.createElement(h.a,{onClick:t.handleEdit.bind(ge(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(m.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(ge(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(y.a,{title:"删除",placement:"top"},c.a.createElement(h.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={visibleModal:!1},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;Object(N.q)({subjectExtendId:e}).then((function(e){if(e.data.code===O.a){var n=e.data.data;t.setState({commonData:n,visibleModal:!0,isEdit:!0})}}))}},{key:"handleDelete",value:function(e){var t=this;Object(N.p)({subjectExtendId:e}).then((function(n){n.data.code===O.a&&(console.log("删除： "+e+" 成功"),d.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}))}},{key:"getTableRequest",value:function(e){return Object(N.w)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields((function(e,n){if(!e){var r=n.selectDeviceType,a={},o=[];R.c.getDeviceTypeFromSelectList(r,t.props.deviceCategoryList).map((function(e,t){var n={deviceTypeId:e};o.push(n)})),a.deviceTypeList=o,a.subjectExtendNameCN=n.subjectExtendNameCN,a.subjectExtendNameEN=n.subjectExtendNameEN,a.subjectExtendMark=n.subjectExtendMark,t.state.isEdit&&(a.subjectExtendId=t.state.commonData.subjectExtendId),Object(N.r)(a).then((function(e){e.data.code===O.a&&(d.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})),t.setState({visibleModal:!1,commonData:{}})}}))}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"render",value:function(){var e={labelCol:{span:24},wrapperCol:{span:24}},t={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:Oe,searchPlaceholder:"请选择管理设备类型",style:{width:300}},n=this.state.isEdit,r=n?this.state.commonData.subjectExtendNameCN:void 0,a=n?this.state.commonData.subjectExtendNameEN:void 0,o=n?this.state.commonData.subjectExtendMark:void 0,i=void 0;if(n){var l=this.state.commonData.deviceTypeList,u=[];l instanceof Array&&(l.map((function(e){var t=e.deviceTypeId;u.push(t)})),u.length>0&&(i=u))}var s=this.props.form.getFieldDecorator;return c.a.createElement("div",null,c.a.createElement(D,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"subjectExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"主体扩展名（中文）",paramskey:"subjectExtendNameCN",placeholder:"请输入主体扩展名（中文）"},{type:"DeviceType",title:"所属分类",paramskey:"deviceTypeId",placeholder:"请输入所属分类"}],upload:"/v1/web/manage-open/protocol/dictionary/subjectExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/subjectExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(f.a,{title:this.state.isEdit?"编辑主体扩展":"新建主体扩展",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(v.a,me({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(we,{label:"主体扩展名-中文"},s("subjectExtendNameCN",{rules:[{required:!0,message:"请输入主体扩展名中文"}],initialValue:r})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(we,{label:"主体扩展名-英文"},s("subjectExtendNameEN",{rules:[{required:!0,message:"请输入主体扩展名英文"}],initialValue:a})(c.a.createElement(p.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(we,{label:"主体扩展名识符"},s("subjectExtendMark",{rules:[{required:!0,message:"请主体扩展名识符"}],initialValue:o})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(we,{label:"关联所属分类"},s("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:i})(c.a.createElement(g.a,t))),c.a.createElement(we,e,c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(h.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(h.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&ye(t.prototype,n),r&&ye(t,r),o}(c.a.Component))||se)||se,je=(n(39),n(43),n(32),n(44),n(41),n(490),n(177)),Se=(n(491),n(119));n(227),n(112);function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=De(e);if(t){var a=De(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Le(this,n)}}function Le(e,t){if(t&&("object"===Ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ne=v.a.Item,Re=b.a.Option,_e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(o,e);var t,n,r,a=Te(o);function o(){return ke(this,o),a.apply(this,arguments)}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.defaultField,r=e.defaultLen,a=e.defaultUnit,o=e.form,i=e.name,l=o.getFieldDecorator;return c.a.createElement(je.a,{type:"flex",justify:"space-around"},c.a.createElement(Se.a,null,c.a.createElement(Ne,null,l("id_"+i,{rules:[{required:!1}]})(c.a.createElement(p.a,{style:{display:"none"},size:"small"})))),c.a.createElement(Se.a,{span:11},c.a.createElement(Ne,null,l("field_"+i,{initialValue:n||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{placeholder:t,size:"small"})))),c.a.createElement(Se.a,{span:5},l("len_"+i,{initialValue:r||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{size:"small"}))),c.a.createElement(Se.a,{span:6},l("unit_"+i,{initialValue:a||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(b.a,{size:"small"},c.a.createElement(Re,{value:1},"字节"),c.a.createElement(Re,{value:2},"位")))))}}])&&Pe(t.prototype,n),r&&Pe(t,r),o}(c.a.Component);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ue(e);if(t){var a=Ue(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ve(this,n)}}function Ve(e,t){if(t&&("object"===Me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(o,e);var t,n,r,a=qe(o);function o(){var e;Be(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).getFieldsItem=function(){var t=e.props,n=t.protocolType,r=t.form;return n?n.content.map((function(e,t){return c.a.createElement(_e,{key:n.id+"_"+t,form:r,placeholder:e.placeholder,defaultLen:e.defaultLen,defaultUnit:e.defaultUnit,name:t})})):null},e}return t=o,(n=[{key:"render",value:function(){return c.a.createElement("div",{className:"value-type"},c.a.createElement(je.a,null,c.a.createElement(Se.a,{span:11},c.a.createElement("span",null,"数据标识")),c.a.createElement(Se.a,{span:6},c.a.createElement("span",null,"长度")),c.a.createElement(Se.a,{span:7},c.a.createElement("span",null,"单位"))),this.getFieldsItem())}}])&&Ae(t.prototype,n),r&&Ae(t,r),o}(c.a.Component);n(133);function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ye(e);if(t){var a=Ye(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Qe(this,n)}}function Qe(e,t){if(t&&("object"===Ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $e=v.a.Item,Xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(o,e);var t,n,r,a=He(o);function o(){var e;Je(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).state={functionDetailList:e.props.functionDetailList||[{functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}]},e.handleAdd=function(){var t=e.state.functionDetailList,n=Array.from(t);n.push({functionDetailId:null,functionMark:null,functionLength:1,functionUnit:2}),e.setState({functionDetailList:n})},e.handleDel=function(t){var n=e.props.form,r=n.getFieldsValue(),a=[],o={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(r).map((function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");a[t[1]]||(a[t[1]]={}),a[t[1]][o[t[0]]]=r[e]}})),a=a.filter((function(e,n){return n!=t}));var i={};a.map((function(e,t){i["id_"+t]=e.functionDetailId,i["field_"+t]=e.functionMark,i["len_"+t]=e.functionLength,i["unit_"+t]=e.functionUnit})),n.setFieldsValue(i),e.setState({functionDetailList:a})},e}return t=o,(n=[{key:"componentWillReceiveProps",value:function(e){this.props.flag!=e.flag&&this.setState({functionDetailList:e.functionDetailList||[{functionDetailId:null,functionMark:null}]})}},{key:"render",value:function(){var e=this,t=this.props.form,n=this.state.functionDetailList,r=t.getFieldDecorator;return c.a.createElement("div",{className:"value-type"},c.a.createElement(je.a,null,c.a.createElement(Se.a,{span:4},c.a.createElement("span",null," ")),c.a.createElement(Se.a,{span:15},c.a.createElement("span",null,"数据标识")),c.a.createElement(Se.a,{span:4},c.a.createElement("span",null," "))),n&&n.map((function(t,n){return c.a.createElement(je.a,{type:"flex",justify:"space-around",key:n+t.functionMark},c.a.createElement(Se.a,{span:4},c.a.createElement($e,null,c.a.createElement("p",null,"BIT".concat(n)))),c.a.createElement(Se.a,{span:0},c.a.createElement($e,null,r("id_"+n,{initialValue:t.functionDetailId||null,rules:[{required:!1}]})(c.a.createElement(p.a,{style:{display:"none"},size:"small"})))),c.a.createElement(Se.a,{span:15},c.a.createElement($e,null,r("field_"+n,{initialValue:t.functionMark,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{size:"small"})))),c.a.createElement(Se.a,{span:0},r("len_"+n,{initialValue:t.functionLength||1,rules:[{required:!1,message:"字段不能为空"}]})(c.a.createElement(p.a,{style:{opacity:0},size:"small"}))),c.a.createElement(Se.a,{span:0},r("unit_"+n,{initialValue:t.Unit||2,rules:[{required:!1,message:"字段不能为空"}]})(c.a.createElement(p.a,{style:{opacity:0},size:"small"}))),c.a.createElement(Se.a,{span:4,style:{textAlign:"center"}},n>0?c.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):c.a.createElement("p",null," ")))})),c.a.createElement(je.a,null,c.a.createElement(Se.a,{span:4},c.a.createElement("a",{onClick:this.handleAdd},"添加"))))}}])&&We(t.prototype,n),r&&We(t,r),o}(c.a.Component);function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ot(e);if(t){var a=ot(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return at(this,n)}}function at(e,t){if(t&&("object"===Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var it,ct=v.a.Item,lt=b.a.Option,ut=[{id:1,name:"字符",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:2,name:"数值",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:3,name:"枚举",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:4,name:"布尔",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:5,name:"绝对时间",content:[{placeholder:"时间戳数据位",defaultLen:13,defaultUnit:1}]},{id:6,name:"相对时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:7,name:"循环时间",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"周"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"时"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"分"数据位',defaultLen:1,defaultUnit:1}]},{id:8,name:"RGB颜色",content:[{placeholder:'"红色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"黄色"数据位',defaultLen:1,defaultUnit:1},{placeholder:'"蓝色"数据位',defaultLen:1,defaultUnit:1}]},{id:9,name:"二进制",content:[{placeholder:"",defaultLen:1,defaultUnit:1}]},{id:10,name:"数组",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]},{id:11,name:"结构体",content:[{placeholder:'"天"数据位',defaultLen:1,defaultUnit:1}]}],st=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(o,e);var t,n,r,a=rt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).handleChange=function(e){t.setState({protocolType:ut[e-1]},(function(){if(e<10){for(var t=ut[e-1].content.length,n=[],r=0;r<t;r++)n.push("id_"+r),n.push("field_"+r),n.push("len_"+r),n.push("unit_"+r);this.props.form.resetFields(n)}}))},t.handleAdd=function(){var e=t.state.childfunclist,n=JSON.parse(JSON.stringify(e));n.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),t.setState({childfunclist:n})},t.handleAdd=function(){var e=t.state.childfunclist,n=JSON.parse(JSON.stringify(e));n.push({functionDetailName:"",functionMark:"",functionDataType:"",functionLength:""}),t.setState({childfunclist:n})},t.handleDel=function(e){var n=t.state.childfunclist,r=JSON.parse(JSON.stringify(n));r.splice(e,1),t.setState({childfunclist:r})},t.state={functionDetailList:null,childfunclist:[{functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}],protocolType:ut[t.props.functionDataType-1]||ut[0]},t}return t=o,(n=[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.functionDataType,r=t.visibleModal,a=t.functionDetailList;if(console.log("....Props..functionDetailList---",a,e.functionDetailList),(n!=e.functionDataType||r!=e.visibleModal)&&(this.setState({protocolType:ut[e.functionDataType-1],functionDetailList:e.functionDetailList}),11==e.functionDataType)){var o=e.functionDetailList&&e.functionDetailList[0]&&e.functionDetailList[0].subFunctionDetailList||[];0==o.length&&o.push({functionDetailName:"",functionMark:"",functionDataType:1,functionLength:""}),console.log(111,e.functionDetailList),this.setState({childfunclist:o})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.protocolType,r=t.functionDetailList,a=t.childfunclist;console.log("...childfunclist...",a);var o=this.props.form.getFieldDecorator,i={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},l={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:16}}},u=c.a.createElement("div",null);return u=9==n.id?c.a.createElement(Xe,{functionDetailList:r,form:this.props.form}):10==n.id?c.a.createElement("div",null,c.a.createElement(ct,et({label:"数据标识"},l),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(c.a.createElement(p.a,{placeholder:"50个以内的字符",maxLength:50}))),c.a.createElement(ct,et({label:"元素类型"},l),o("functionDataTypeChild",{rules:[{required:!0,message:"元素类型不能为空"}],initialValue:1})(c.a.createElement(b.a,{placeholder:"选择元素类型"},c.a.createElement(lt,{value:1},"字符型"),c.a.createElement(lt,{value:2},"数值型")))),c.a.createElement(ct,et({label:"元素字节长度"},l),o("functionLength",{rules:[{required:!0,message:"元素字节长度"}]})(c.a.createElement(p.a,{placeholder:"最大不超过1000",maxLength:4})))):11==n.id?c.a.createElement("div",null,c.a.createElement(ct,et({label:"数据标识"},i,{style:{marginBottom:"0"}}),o("functionMark",{rules:[{required:!0,message:"数据标识不能为空"}]})(c.a.createElement(p.a,{placeholder:"50个以内的字符",maxLength:50}))),c.a.createElement(ct,et({label:"JSON对象"},i,{style:{marginBottom:"0"}}),o("JSONobj",{rules:[{required:!0,message:""}],initialValue:123})(c.a.createElement(p.a,{type:"hidden"}))),c.a.createElement(je.a,null,c.a.createElement(Se.a,{span:6},c.a.createElement("span",null,"参数名称")),c.a.createElement(Se.a,{span:6},c.a.createElement("span",null,"数据标识")),c.a.createElement(Se.a,{span:5},c.a.createElement("span",null,"数据类型")),c.a.createElement(Se.a,{span:4},c.a.createElement("span",null,"字节长度")),c.a.createElement(Se.a,{span:3,style:{textAlign:"right"}},c.a.createElement("span",null,"操作"))),a.map((function(t,n){return c.a.createElement(je.a,{gutter:4,key:"childfunc_"+n},c.a.createElement(Se.a,{span:6},c.a.createElement(ct,{style:{marginBottom:"0"}},o("functionDetailName_"+n,{initialValue:t.functionDetailName||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{placeholder:"参数名称",maxLength:50,size:"small"})))),c.a.createElement(Se.a,{span:6},c.a.createElement(ct,{style:{marginBottom:"0"}},o("functionMark_"+n,{initialValue:t.functionMark||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{placeholder:"数据标识",maxLength:50,size:"small"})))),c.a.createElement(Se.a,{span:5},c.a.createElement(ct,{style:{marginBottom:"0"}},o("functionDataType_"+n,{initialValue:t.functionDataType||1,rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(b.a,{placeholder:"选择数据类型",size:"small"},c.a.createElement(lt,{value:1},"字符型"),c.a.createElement(lt,{value:2},"数值型"),c.a.createElement(lt,{value:3},"枚举型"),c.a.createElement(lt,{value:4},"布尔型"))))),c.a.createElement(Se.a,{span:4},c.a.createElement(ct,{style:{marginBottom:"0"}},o("functionLength_"+n,{initialValue:t.functionLength||"",rules:[{required:!0,message:"字段不能为空"}]})(c.a.createElement(p.a,{placeholder:"字节长度",maxLength:4,size:"small"})))),c.a.createElement(Se.a,{span:3,style:{textAlign:"right"}},n>0?c.a.createElement("a",{onClick:e.handleDel.bind(e,n)},"删除"):c.a.createElement("p",null," ")))})),c.a.createElement(je.a,null,c.a.createElement(Se.a,{span:24,style:{textAlign:"right"}},c.a.createElement("a",{onClick:this.handleAdd},"添加")))):c.a.createElement(ze,{protocolType:n,form:this.props.form}),c.a.createElement(ct,et({},i,{label:"协议类型"}),o("functionDataType",{initialValue:1,rules:[{required:!0,message:"请选择协议类型"}]})(c.a.createElement(b.a,{placeholder:"选择协议类型",onChange:this.handleChange},ut.map((function(e){return c.a.createElement(lt,{value:e.id,key:e.id},e.name)})))),u)}}])&&tt(t.prototype,n),r&&tt(t,r),o}(c.a.Component);function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(){return(pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Et(e);if(t){var a=Et(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(e,t){if(t&&("object"===ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gt(e)}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wt,Ot=[{functionType:20,functionTypeName:"历史控制数据"},{functionType:8,functionTypeName:"历史运行数据"},{functionType:27,functionTypeName:"状态数据"},{functionType:9,functionTypeName:"红外数据"},{functionType:2,functionTypeName:"控制数据"},{functionType:3,functionTypeName:"运行数据"},{functionType:4,functionTypeName:"故障数据"},{functionType:5,functionTypeName:"配置数据"}],It=v.a.Item,jt=(g.a.SHOW_PARENT,v.a.create()(it=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(o,e);var t,n,r,a=bt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).columns=[{title:"ID",dataIndex:"functionId",width:"100px"},{title:"功能名（中文）",dataIndex:"functionNameCN"},{title:"功能名（英文）",dataIndex:"functionNameEN"},{title:"类型",dataIndex:"dataTypeNameList",width:"30%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionId",key:"0",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(y.a,{title:"编辑",placement:"top"},c.a.createElement(h.a,{onClick:t.handleEdit.bind(gt(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(m.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(gt(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(y.a,{title:"删除",placement:"top"},c.a.createElement(h.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={functionDataType:1,functionDetailList:null,commonData:{}},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this,n=this;Object(N.l)({functionId:e}).then((function(e){if(console.log("get detail---",e.data.data),e.data.code===O.a){var r=e.data.data;t.setState({functionDataType:r.functionDataType,functionDetailList:r.functionDetailList,commonData:r,visibleModal:!0,isEdit:!0},(function(){var e=r.functionDetailList,t={},a=r.functionDataType;a<10?e.map((function(e,n){t["id_"+n]=e.functionDetailId,t["field_"+n]=e.functionMark,t["len_"+n]=e.functionLength,t["unit_"+n]=e.functionUnit})):10==a?(t.functionMark=e[0].functionMark,t.functionDataTypeChild=e[0].functionDataType,t.functionLength=e[0].functionLength):11==a&&(t.functionMark=e[0].functionMark,(e[0].subFunctionDetailList||[]).map((function(e,n){t["functionMark_"+n]=e.functionMark,t["functionDetailName_"+n]=e.functionDetailName,t["functionDataType_"+n]=e.functionDataType,t["functionLength_"+n]=e.functionLength}))),setTimeout((function(){n.props.form.setFieldsValue(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({functionNameCN:r.functionNameCN,functionNameEN:r.functionNameEN,dataTypeList:Array.isArray(r.dataTypeList)?r.dataTypeList:[r.dataTypeList],functionDataType:a},t))}),100)}))}}))}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.k)({functionId:e}).then((function(n){n.data.code===O.a&&(console.log("删除： "+e+" 成功"),d.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}))}},{key:"getTableRequest",value:function(e){return Object(N.n)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1,functionDataType:1},(function(){this.props.form.resetFields()}))}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields((function(e,n){if(!e){console.log("....values...",n);var r=n.functionDataType,a={};a.functionNameCN=n.functionNameCN,a.functionNameEN=n.functionNameEN,a.dataTypeList=n.dataTypeList,a.functionDataType=r,t.state.isEdit&&(a.functionId=t.state.commonData.functionId);var o=[];if(10==r)o[0]={functionMark:n.functionMark,functionDataType:n.functionDataTypeChild,functionLength:n.functionLength};else if(11==r){o[0]={functionMark:n.functionMark,functionDataType:r,subFunctionDetailList:[]};var i=[];Object.keys(n).map((function(e){var t=e.split("_");if(t.length>1){var r=t[1],a=t[0],o=n[e];console.log("---",r,a,o,"---"),i[r]||(i[r]={}),i[r][a]=o}})),o[0].subFunctionDetailList=i}else if(r<10){var c={id:"functionDetailId",field:"functionMark",len:"functionLength",unit:"functionUnit"};Object.keys(n).map((function(e){if(/^id_|field_|len_|unit_\d$/.test(e)){var t=e.split("_");o[t[1]]||(o[t[1]]={}),o[t[1]][c[t[0]]]=n[e]}}))}a.functionDetailList=o,Object(N.m)(a).then((function(e){e.data.code===O.a&&(console.log("保存： 成功"),d.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})),t.setState({visibleModal:!1,commonData:{},functionDetailList:null})}}))}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{},functionDetailList:null})}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:24},wrapperCol:{span:24}},n=this.state.commonData.functionNameCN||"",r=this.state.commonData.functionNameEN||"",a=this.state.commonData.dataTypeList||[],o=this.state,i=o.functionDataType,l=o.functionDetailList;return c.a.createElement("div",null,c.a.createElement(D,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能名（中文）",paramskey:"functionNameCN",placeholder:"请输入功能名（中文）"}],upload:"/v1/web/manage-open/protocol/dictionary/function/importExcel",download:"/v1/web/manage-open/protocol/dictionary/function/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(f.a,{title:this.state.isEdit?"编辑功能":"新建功能",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),width:700},c.a.createElement(v.a,pt({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:17}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(It,{label:"功能-中文"},e("functionNameCN",{rules:[{required:!0,message:"请输入功能中文"}],initialValue:n})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(It,{label:"功能-英文"},e("functionNameEN",{rules:[{required:!0,message:"请输入功能英文"}],initialValue:r})(c.a.createElement(p.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(It,{label:"功能分类"},e("dataTypeList",{rules:[{required:!0,message:"请输入功能分类"}],initialValue:a})(c.a.createElement(te,{showArrow:!0,showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},Ot.map((function(e){return c.a.createElement(b.a.Option,{value:e.functionType,key:e.functionType},e.functionTypeName)}))))),c.a.createElement(st,{visibleModal:this.state.visibleModal,functionDataType:i,functionDetailList:l,form:this.props.form}),c.a.createElement(It,t,c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(h.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(h.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&yt(t.prototype,n),r&&yt(t,r),o}(c.a.Component))||it);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dt(e);if(t){var a=Dt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Tt(this,n)}}function Tt(e,t){if(t&&("object"===St(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Lt(e)}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dt(e){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nt=g.a.SHOW_PARENT,Rt=v.a.Item,_t=(b.a.Option,Object(s.b)((function(e){return{deviceCategoryTreeSelect:e.getIn(["globalDeviceInfo","deviceCategoryTreeSelect"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),functionAllList:e.getIn(["globalProtocolDicInfo","functionAllList"])}}),(function(e){return{getFunctionAllList:function(){e(_.a())}}}))(wt=v.a.create()(wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(o,e);var t,n,r,a=xt(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).columns=[{title:"ID",dataIndex:"functionExtendId",key:"functionExtendId",width:"80px"},{title:"功能扩展名（中文）",dataIndex:"functionExtendNameCN",key:"functionExtendNameCN",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"功能扩展名（英文）",dataIndex:"functionExtendNameEN",key:"functionExtendNameEN",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"功能扩展名标识",dataIndex:"functionExtendMark",key:"functionExtendMark",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"关联功能",dataIndex:"functionList",key:"functionList",width:"20%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryNameList",key:"allCategoryNameList",width:"20%",render:function(e){return c.a.createElement("span",{title:e},e)}},{title:"操作",dataIndex:"functionExtendId",key:"1",width:"100px",render:function(e){return c.a.createElement("div",null,c.a.createElement(y.a,{title:"编辑",placement:"top"},c.a.createElement(h.a,{onClick:t.handleEdit.bind(Lt(t),e),shape:"circle",icon:"edit",size:"small"})),"  ",c.a.createElement(m.a,{title:"确认要删除吗",onConfirm:t.handleDelete.bind(Lt(t),e),okText:"确认",cancelText:"取消",placement:"topRight"},c.a.createElement(y.a,{title:"删除",placement:"top"},c.a.createElement(h.a,{icon:"delete",shape:"circle",size:"small"}))))}}],t.state={},t}return t=o,(n=[{key:"handleEdit",value:function(e){var t=this;console.log("get detail"),Object(N.f)({functionExtendId:e}).then((function(e){if(console.log("get detail"),e.data.code===O.a){var n=e.data.data,r=n.functionList,a=[];r.map((function(e){var t=e.functionId;a.push(t)})),n.functionList=a,t.setState({commonData:n,visibleModal:!0,isEdit:!0})}}))}},{key:"handleDelete",value:function(e){var t=this;console.log("handleDelete: "+e),Object(N.e)({functionExtendId:e}).then((function(n){n.data.code===O.a&&(console.log("删除： "+e+" 成功"),d.a.success({message:"提示",description:"删除成功"}),t.setState({visibleModal:!1,commonData:{}}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())}))}},{key:"getTableRequest",value:function(e){return this.setState({isLoading:!0}),Object(N.h)(e)}},{key:"handleNewProtocolDic",value:function(){this.setState({visibleModal:!0,isEdit:!1})}},{key:"handleOk",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"handleCancel",value:function(){this.setState({visibleModal:!1,commonData:{}})}},{key:"componentDidMount",value:function(){this.props.getFunctionAllList()}},{key:"handleSubmitSave",value:function(e){var t=this;this.props.form.validateFields((function(e,n){if(!e){console.log("validateFields: "+n);var r=n.selectDeviceType,a={},o=[];if(R.c.getDeviceTypeFromSelectList(r,t.props.deviceCategoryList).map((function(e,t){var n={deviceTypeId:e};o.push(n)})),a.deviceTypeList=o,a.functionExtendNameCN=n.functionExtendNameCN,a.functionExtendNameEN=n.functionExtendNameEN,a.functionExtendMark=n.functionExtendMark,t.state.isEdit&&(a.functionExtendId=t.state.commonData.functionExtendId),n.functionList){var i=n.functionList,c=[];i.map((function(e){var t={functionId:e};c.push(t)})),a.functionList=c}Object(N.g)(a).then((function(e){e.data.code===O.a&&(console.log("保存： 成功"),d.a.success({message:"提示",description:"保存成功"}),t.ProtocolDicBaseItemRefreshTable&&t.ProtocolDicBaseItemRefreshTable())})),t.setState({visibleModal:!1,commonData:{}})}}))}},{key:"ProtocolDicCallback",value:function(e){this.ProtocolDicBaseItemRefreshTable=e}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:24},wrapperCol:{span:24}},n={treeData:this.props.deviceCategoryTreeSelect||[],treeCheckable:!0,showCheckedStrategy:Nt,searchPlaceholder:"请选择管理设备类型",style:{width:300}},r=this.props.functionAllList||[],a=this.state.isEdit,o=a?this.state.commonData.functionExtendNameCN:void 0,i=a?this.state.commonData.functionExtendNameEN:void 0,l=a?this.state.commonData.functionExtendMark:void 0,u=a?this.state.commonData.functionList:void 0,s=void 0;if(a){var d=this.state.commonData.deviceTypeList,m=[];d instanceof Array&&(d.map((function(e){var t=e.deviceTypeId;m.push(t)})),m.length>0&&(s=m))}return c.a.createElement("div",null,c.a.createElement(D,{refFunction:this.ProtocolDicCallback.bind(this),getTableRequest:this.getTableRequest.bind(this),rowKey:"functionExtendId",columns:this.columns,deviceCategoryList:this.props.deviceCategoryList,filterPannel:[{type:"Input",title:"功能扩展名（中文）",paramskey:"functionExtendNameCN",placeholder:"请输入功能扩展名"}],upload:"/v1/web/manage-open/protocol/dictionary/functionExtend/importExcel",download:"/v1/web/manage-open/protocol/dictionary/functionExtend/download",handleNewProtocolDic:this.handleNewProtocolDic.bind(this)}),c.a.createElement(f.a,{title:this.state.isEdit?"编辑功能扩展名":"新建功能扩展名",visible:this.state.visibleModal,footer:null,onCancel:this.handleCancel.bind(this),destroyOnClose:!0},c.a.createElement(v.a,Ct({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmitSave.bind(this)}),c.a.createElement(Rt,{label:"功能扩展名-中文"},e("functionExtendNameCN",{rules:[{required:!0,message:"请输入功能扩展名中文"}],initialValue:o})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(Rt,{label:"功能扩展名-英文"},e("functionExtendNameEN",{rules:[{required:!0,message:"请输入功能扩展名英文"}],initialValue:i})(c.a.createElement(p.a,{placeholder:"40个以内的字符",maxLength:40}))),c.a.createElement(Rt,{label:"功能扩展名标识符"},e("functionExtendMark",{rules:[{required:!0,message:"请输入功能扩展名标识符"}],initialValue:l})(c.a.createElement(p.a,{placeholder:"20个以内的字符",maxLength:20}))),c.a.createElement(Rt,{label:"关联功能"},e("functionList",{rules:[{required:!0,message:"请输入关联功能"}],initialValue:u})(c.a.createElement(te,{maxTagCount:20,placeholder:"请选择关联功能",showSearch:!0,filterOption:function(e,t){var n=t.props.children;return"string"==typeof n&&n.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map((function(e,t){return c.a.createElement(b.a.Option,{value:e.functionId,key:e.functionId},e.functionNameCN)}))))),c.a.createElement(Rt,{label:"关联所属分类"},e("selectDeviceType",{rules:[{required:!1,message:"请关联所属分类"}],initialValue:s})(c.a.createElement(g.a,n))),c.a.createElement(Rt,t,c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"flex-end"}},c.a.createElement(h.a,{style:{width:"100px",marginRight:"10px"},onClick:this.handleCancel.bind(this)},"取消"),c.a.createElement(h.a,{type:"primary",htmlType:"submit",style:{width:"100px",marginRight:"20px"}},"确认"))))))}}])&&kt(t.prototype,n),r&&kt(t,r),o}(c.a.Component))||wt)||wt);function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function At(e,t){return(At=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vt(e);if(t){var a=Vt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return qt(this,n)}}function qt(e,t){if(t&&("object"===Mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ut=o.a.Item,zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&At(e,t)}(s,e);var t,n,r,i=Ft(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).state={menuIndex:"common"},t}return t=s,(n=[{key:"menuClick",value:function(e){this.setState({menuIndex:e.key})}},{key:"componentDidMount",value:function(){var e=window.location.hash.replace(/#|\?.*$/g,"").split("/").pop();this.setState({menuIndex:e}),this.props.getFunctionAllList()}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement(a.a,{style:{marginBottom:"10px"}},c.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px"}},"协议字典"),c.a.createElement(o.a,{onClick:this.menuClick.bind(this),selectedKeys:[this.state.menuIndex],mode:"horizontal"},c.a.createElement(Ut,{key:"common"},c.a.createElement(u.Link,{to:"/config/protocoldic/common"},"常用")),c.a.createElement(Ut,{key:"main"},c.a.createElement(u.Link,{to:"/config/protocoldic/main"},"主体")),c.a.createElement(Ut,{key:"mainextends"},c.a.createElement(u.Link,{to:"/config/protocoldic/mainextends"},"主体扩展名")),c.a.createElement(Ut,{key:"function"},c.a.createElement(u.Link,{to:"/config/protocoldic/function"},"功能")),c.a.createElement(Ut,{key:"functionextends"},c.a.createElement(u.Link,{to:"/config/protocoldic/functionextends"},"功能扩展名")))),c.a.createElement(a.a,null,c.a.createElement(u.Switch,null,c.a.createElement(l.a,{path:"/config/protocoldic/common",component:W}),c.a.createElement(l.a,{path:"/config/protocoldic/main",component:pe}),c.a.createElement(l.a,{path:"/config/protocoldic/mainextends",component:Ie}),c.a.createElement(l.a,{path:"/config/protocoldic/function",component:jt}),c.a.createElement(l.a,{path:"/config/protocoldic/functionextends",component:_t}),c.a.createElement(u.Redirect,{to:"/config/protocoldic/common",from:"/config/protocoldic"}))))}}])&&Bt(t.prototype,n),r&&Bt(t,r),s}(c.a.Component);t.default=Object(s.b)(null,(function(e){return{getFunctionAllList:function(){e(_.a())}}}))(zt)},1552:function(e,t,n){"use strict";n.r(t);n(78),n(224);var r=n(0),a=n.n(r),o=n(40),i=(n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(35),n(22),n(36),n(26),n(27),n(28),n(104),n(46)),c=(n(103),n(48)),l=(n(225),n(86)),u=(n(69),n(19)),s=(n(200),n(85)),f=(n(112),n(122),n(50),n(45)),p=n(97),d=n(487),m=n(496);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var a=j(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=d.a.Option,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(f,e);var t,n,r,o=O(f);function f(){var e;g(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={projectName:"",robotId:"",queryStatus:null,loading:!1},e.handleChange=function(t){var n=t.target,r=n.name,a=n.value;e.setState(v({},r,a))},e.handleSearch=function(){var t=e.state,n=t.projectName,r=t.robotId;e.setState({queryStatus:{projectName:n,robotId:r}},(function(){e.pageChange()}))},e.handleReset=function(){e.setState({projectName:"",robotId:"",queryStatus:null},(function(){e.refInpt1.setState({value:""}),e.refInpt2.setState({value:""})}))},e.handleNew=function(){e.props.history.push("./0")},e.handleEdit=function(t){e.props.history.push("./".concat(t))},e.handleDel=function(t){s.a.confirm({title:"确定删除项目",centered:!0,onOk:function(){e.props.delProject(t)}})},e.pageChange=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=b(b({},e.state.queryStatus),{},{pageIndex:t});console.log(n),e.setState({loading:!0},(function(){e.props.getList(n).then((function(t){e.setState({loading:!1})}))}))},e}return t=f,(n=[{key:"componentDidMount",value:function(){console.log(this.props),this.pageChange()}},{key:"render",value:function(){var e=this,t=this.state.loading,n=this.props,r=n.pager,o=n.list,s=[{title:"项目ID",dataIndex:"projectId",width:"10%"},{title:"名称",dataIndex:"projectName",width:"20%"},{title:"机器人ID",dataIndex:"robotId",width:"150px"},{title:"关联产品",dataIndex:"productNameList",width:"30%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",render:function(t){return a.a.createElement("div",{className:"action"},a.a.createElement(l.a,{placement:"top",title:"管理"},a.a.createElement(u.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.handleEdit.bind(e,t.projectId)})),"  |  ",a.a.createElement(l.a,{placement:"top",title:"删除"},a.a.createElement(u.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.projectId)})))}}];return a.a.createElement("div",{className:"projectmanage"},a.a.createElement(d.a,{title:"项目管理"},a.a.createElement(S,null,a.a.createElement(c.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入项目名称查询",name:"projectName",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt1=t}})),a.a.createElement(S,null,a.a.createElement(c.a,{style:{width:240},type:"text",maxLength:20,className:"het-input-text",placeholder:"请输入机器人ID查询",name:"robotId",onChange:this.handleChange,onPressEnter:this.handleSearch,ref:function(t){return e.refInpt2=t}})),a.a.createElement(S,null,a.a.createElement(u.a,{type:"primary",onClick:this.handleSearch},"查询")),a.a.createElement(S,null,a.a.createElement(u.a,{type:"primary",onClick:this.handleReset},"重置")),a.a.createElement(S,{align:"right"},a.a.createElement(u.a,{type:"primary",onClick:this.handleNew},"新建"))),a.a.createElement(i.a,null,a.a.createElement(p.a,{rowKey:"projectId",pagination:!1,columns:s,dataSource:o,pager:r,onPageChange:this.pageChange,loading:t})))}}])&&E(t.prototype,n),r&&E(t,r),f}(a.a.Component),k=Object(f.b)((function(e){return{list:e.getIn(["projectManage","list"]).toJS(),pager:e.getIn(["projectManage","pager"]).toJS()}}),(function(e){return{getList:function(t){return e(m.a.getList(t))},delProject:function(t){return e(m.a.delProject(t))}}}))(C),P=(n(91),n(24)),x=(n(159),n(9)),T=(n(308),n(160));n(500),n(309);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var a=B(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M(this,n)}}function M(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(i,e);var t,n,r,o=_(i);function i(){var e;D(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={macAddress:"",loading:!1},e.handleOk=function(){var t=e.props.deviceList;t&&0!==t.length?(e.props.addDevice(t),e.props.onCancel()):e.props.onCancel()},e.handleChange=function(t){e.setState({macAddress:t.target.value})},e.handleQuery=function(){e.setState({loading:!0},(function(){var t=e.props.projectId;e.props.getDevice({macAddress:e.state.macAddress,projectId:t}).then((function(t){e.setState({loading:!1})}))}))},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&(this.setState({macAddress:""}),this.props.clearDevice())}},{key:"render",value:function(){var e=this.state,t=e.macAddress,n=e.loading,r=this.props,o=r.deviceList,i=r.visible,l=r.onCancel;return a.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:1200,visible:i,onCancel:l,footer:a.a.createElement("div",{className:"footer"},a.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),a.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:l},"取消"))},a.a.createElement("h2",null,"添加产品设备"),a.a.createElement("div",{className:"header"},a.a.createElement(c.a,{placeholder:"请输入MAC地址查询",maxLength:20,onChange:this.handleChange,value:t,onPressEnter:this.handleQuery}),a.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),a.a.createElement("div",{className:"projectmanage-modal-table product"},a.a.createElement(T.a,{bordered:!0,loading:n,rowKey:"productId",pagination:!1,columns:[{title:"MAC",dataIndex:"macAddress",width:"15%"},{title:"IMEI",dataIndex:"imei",width:"15%"},{title:"产品ID",dataIndex:"productId",width:"10%"},{title:"产品型号",dataIndex:"productCode",width:"20%"},{title:"产品名称",dataIndex:"productName",width:"20%"},{title:"所属分类",dataIndex:"allCategoryName",width:"20%"}],dataSource:o})))}}])&&N(t.prototype,n),r&&N(t,r),i}(a.a.Component),F=Object(f.b)((function(e){return{deviceList:e.getIn(["projectManage","deviceList"]).toJS()}}),(function(e){return{getDevice:function(t){return e(m.a.getDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))},clearDevice:function(){return e(m.a.setDevice([]))}}}))(A);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G(e);if(t){var a=G(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return W(this,n)}}function W(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(i,e);var t,n,r,o=J(i);function i(){var e;U(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1,macAddress:"",productId:"",query:{macAddress:"",productId:""}},e.fileInput=null,e.fileChange=function(t){e.props.uploadDevice(t.target.files[0]).then((function(e){e&&P.a.success({message:"导入成功",duration:3})})),e.fileInput.value=""},e.handleAdd=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e.handleDel=function(t){e.props.delDevice(t)},e.handleChange=function(t){var n=t.target,r=n.name,a=n.value;e.setState(V({},r,a))},e.handleQuery=function(){var t=e.state,n=t.macAddress,r=t.productId;e.setState({query:{macAddress:n,productId:r}})},e}return t=i,(n=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.match.params.projectId,n=this.state,r=n.visible,o=n.query,i=this.props,l=i.projectDeviceProductList,s=i.positionList,f=[{title:"MAC",dataIndex:"macAddress",width:"150px",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"IMEI",dataIndex:"imei",width:"10%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"产品ID",dataIndex:"productId",width:"100px"},{title:"产品型号",dataIndex:"productCode",width:"15%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"产品名称",dataIndex:"productName",width:"20%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"所属分类",dataIndex:"allCategoryName",width:"20%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"操作",width:"100px",render:function(t){return a.a.createElement("div",{className:"action"},a.a.createElement("span",{onClick:e.handleDel.bind(e,t)},"删除"))}}],p=o.macAddress,d=o.productId,m=l&&l.length>0?l.filter((function(e){return e.macAddress.toLowerCase().indexOf(p.toLowerCase())>=0})).filter((function(e){return new RegExp("^".concat(d.toLowerCase())).test((e.productId+"").toLowerCase())})):[];return a.a.createElement("div",{className:"edit-detail production"},a.a.createElement("div",{className:"tab-query"},a.a.createElement(c.a,{placeholder:"MAC地址",maxLength:20,className:"left",name:"macAddress",onChange:this.handleChange,onPressEnter:this.handleQuery}),a.a.createElement(c.a,{placeholder:"产品ID",maxLength:20,className:"left",name:"productId",onChange:this.handleChange,onPressEnter:this.handleQuery}),a.a.createElement(u.a,{type:"primary",className:"left",onClick:this.handleQuery},"查询"),a.a.createElement(u.a,{type:"primary",className:"right",onClick:this.handleAdd},"添加产品"),a.a.createElement("div",{className:"btn-upload"},a.a.createElement(u.a,{type:"primary"},"批量导入",a.a.createElement("input",{type:"file",className:"upload",accept:".xls, .xlsx",onChange:this.fileChange,ref:function(t){return e.fileInput=t}}))),a.a.createElement("a",{className:"right",href:"/v1/web/manage-open/project/management/deviceProduct/download"},"下载模板")),a.a.createElement(T.a,{rowKey:"macAddress",bordered:!0,pagination:!1,columns:f,dataSource:m,scroll:{x:"max-content",y:500}}),a.a.createElement(F,{visible:r,onOk:this.handleOk,onCancel:this.handleCancel,projectDeviceProductList:l,projectId:t,positionList:s}))}}])&&z(t.prototype,n),r&&z(t,r),i}(a.a.Component),Q=Object(f.b)((function(e){return{projectDeviceProductList:e.getIn(["projectManage","project","projectDeviceProductList"]).toJS()}}),(function(e){return{getProductList:function(t){return e(m.a.getProductList(t))},uploadDevice:function(t){return e(m.a.uploadDevice(t))},delDevice:function(t){return e(m.a.delDevice(t))},addDevice:function(t){return e(m.a.addDevice(t))}}}))(H);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var a=ne(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(i,e);var t,n,r,o=ee(i);function i(){var e;$(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={active:null,modelName:"",query:""},e.handleOk=function(){var t=e.state.active;null!=Y(t)?(e.props.setPosition(t),e.props.getSummaryList(t.modelId),e.props.onCancel()):e.props.onCancel()},e.handleClick=function(t){e.setState({active:t})},e.handleChange=function(t){e.setState({modelName:t.target.value})},e.handleQuery=function(){var t=e.state.modelName;e.setState({query:t})},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&this.setState({active:null,modelName:"",query:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.active,r=t.modelName,o=t.query,i=(n||this.props.projectPositionDataModel).modelId,l=this.props,f=l.visible,p=l.onCancel,d=l.positionList,m=d?d.filter((function(e){return e.modelName.toLowerCase().indexOf(o.toLowerCase())>=0})):[];return a.a.createElement(s.a,{wrapClassName:"projectmanage-modal-add",width:800,visible:f,onOk:this.handleOk,onCancel:p,footer:a.a.createElement("div",{className:"footer"},a.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleOk},"保存"),a.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:p},"取消"))},a.a.createElement("h2",null,"选择位置数据模型"),a.a.createElement("div",{className:"header"},a.a.createElement(c.a,{placeholder:"请选择位置数据模型",maxLength:20,onChange:this.handleChange,value:r,onPressEnter:this.handleQuery}),a.a.createElement(u.a,{type:"primary",onClick:this.handleQuery},"查询")),a.a.createElement("div",{className:"projectmanage-modal-table"},a.a.createElement(T.a,{rowKey:"modelId",pagination:!1,columns:[{title:"模型名称",dataIndex:"modelName",width:"40%"},{title:"描述",dataIndex:"modelDesc",width:"60%"}],dataSource:m,onRow:function(t){return{onClick:e.handleClick.bind(e,t)}},scroll:{x:"max-content",y:400},rowSelection:{type:"radio",selectedRowKeys:[i],onSelect:this.handleClick}})))}}])&&X(t.prototype,n),r&&X(t,r),i}(a.a.Component),ae=Object(f.b)((function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}}),(function(e){return{setPosition:function(t){return e(m.a.setPosition(t))},getSummaryList:function(t){return e(m.a.getSummaryList(t))}}}))(re);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fe(e);if(t){var a=fe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return se(this,n)}}function se(e,t){if(t&&("object"===oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(i,e);var t,n,r,o=ue(i);function i(){var e;ie(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1},e.handleAdd=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this.props.positionList;e&&0!==e.length||this.props.getPositionList()}},{key:"render",value:function(){var e=this.state.visible,t=this.props.projectPositionDataModel,n=t.modelId,r=t.modelName;return a.a.createElement("div",{className:"edit-detail position"},a.a.createElement("p",null,n?"已关联位置数据模型":"尚未关联位置数据模型"),n?a.a.createElement("p",{className:"model-name"},r):"",a.a.createElement(u.a,{type:"primary",className:"btn-choose",onClick:this.handleAdd},"选择位置数据模型"),a.a.createElement(ae,{visible:e,onOk:this.handleOk,onCancel:this.handleCancel}))}}])&&ce(t.prototype,n),r&&ce(t,r),i}(a.a.Component),de=Object(f.b)((function(e){return{projectPositionDataModel:e.getIn(["projectManage","project","projectPositionDataModel"]).toJS(),positionList:e.getIn(["projectManage","positionList"]).toJS()}}),(function(e){return{getPositionList:function(){return e(m.a.getPositionList())}}}))(pe),me=(n(157),n(37));n(58);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var a=Ee(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ge(this,n)}}function ge(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=me.a.Option,Oe=["找不到设备","设备不在线","能力超出范围","指令超出范围","场景无法执行"],Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(i,e);var t,n,r,o=ve(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleClick=function(e){t.setState({tabIndex:e})},t.handleChange=function(e){var n=e.target,r=n.name,a=n.value;t.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,a),(function(){t.props.setRobotDetail(r,a)}))},t.handleSelect=function(e){t.props.setRobotDetail("summaryId",e)},t.delVoice=function(e){var n=t.state,r=n.tabIndex,a=n.replyList;a[r]=a[r].filter((function(t,n){return n!==e})),console.log("----",a),t.setState({replyList:a},(function(){t.props.setReplyList(a)}))},t.editVoice=function(e,n){var r=t.state,a=r.tabIndex,o=r.replyList;o[a][n].replyInfo=e,t.setState({replyList:o},(function(){t.props.setReplyList(o)}))},t.addVoice=function(){var e=t.state,n=e.tabIndex,r=e.replyList,a={sceneId:n,replyIndex:1e3*Math.random()|0,replyInfo:""};r[n].push(a),t.setState({replyList:r},(function(){t.props.setReplyList(r)}))};var n=e.replyList;return t.state={tabIndex:0,robotId:"",robotDesc:"",replyList:n||null},t}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.replyList,n=e.projectVoiceRobot,r=n.robotId,a=n.robotDesc;r===this.state.robotId&&a===this.state.robotDesc||this.setState({robotId:r,robotDesc:a}),JSON.stringify(t)!==JSON.stringify(this.state.replyList)&&this.setState({replyList:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.tabIndex,r=t.robotId,o=t.robotDesc,i=this.props,l=i.projectVoiceRobot,u=i.summaryList,s=l.summaryId,f=l.summaryName,p=this.state.replyList||l.replyList;return console.log(u,s,f),a.a.createElement("div",{className:"edit-detail robot"},a.a.createElement("div",{className:"robot-choose"},a.a.createElement("div",{className:"form-item"},a.a.createElement("p",{className:"label"},a.a.createElement("span",null,"机器人ID：")),a.a.createElement(c.a,{placeholder:"请输入机器人ID",maxLength:6,value:r||l.robotId,name:"robotId",onChange:this.handleChange})),a.a.createElement("div",{className:"form-item"},a.a.createElement("p",{className:"label"},a.a.createElement("span",null,"描述：")),a.a.createElement(c.a,{placeholder:"请输入描述",maxLength:150,value:o||l.robotDesc,name:"robotDesc",onChange:this.handleChange})),a.a.createElement("div",{className:"robot-tab-voice"},a.a.createElement("div",{className:"robot-position"},a.a.createElement("p",null,"语音机器人覆盖的最大空间区域"),a.a.createElement(me.a,{className:"robot-position-select",value:s,defaultActiveFirstOption:!!s,onChange:this.handleSelect},u&&u.length?u.map((function(e){return a.a.createElement(we,{value:e.summaryId,key:e.summaryId},e.summary)})):a.a.createElement(we,{value:s,key:s},f))),a.a.createElement("p",null,"异常场景回复语配置"),a.a.createElement("div",{className:"robot-voice-tabs"},a.a.createElement("ul",null,Oe.map((function(t,r){return a.a.createElement("li",{key:t,className:r===n?"active":"",onClick:e.handleClick.bind(e,r)},a.a.createElement("span",null,t))}))),a.a.createElement("div",{className:"robot-voice-list"},a.a.createElement("p",null,"回复语料（配置多条语料时随机下发）"),p&&p[n]&&p[n].map((function(t,n){return a.a.createElement("div",{className:"voice",key:"".concat(t.sceneId,"-").concat(t.replyIndex)},a.a.createElement(c.a,{placeholder:"最多输入50个字符",maxLength:50,value:t.replyInfo,onChange:function(t){return e.editVoice(t.target.value,n)}}),n>0?a.a.createElement("div",{className:"decrease",onClick:e.delVoice.bind(e,n)},a.a.createElement("p",null,"-")):null)})),a.a.createElement("div",{className:"voice-add"},a.a.createElement("span",{onClick:this.addVoice},"添加")))))))}}])&&he(t.prototype,n),r&&he(t,r),i}(a.a.Component),je=Object(f.b)((function(e){return{projectVoiceRobot:e.getIn(["projectManage","project","projectVoiceRobot"]).toJS(),summaryList:e.getIn(["projectManage","summaryList"]).toJS(),replyList:e.getIn(["projectManage","replyList"]).toJS()}}),(function(e){return{setRobotDetail:function(t,n){return e(m.a.setRobotDetail(t,n))},getSummaryList:function(t){return e(m.a.getSummaryList(t))},setReplyList:function(t){return e(m.a.setReplyList(t))}}}))(Ie);function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Le(e);if(t){var a=Le(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Te(this,n)}}function Te(e,t){if(t&&("object"===Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(s,e);var t,n,r,l=xe(s);function s(){var e;Ce(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=l.call.apply(l,[this].concat(n))).state={projectName:""},e.handleBack=function(){e.props.history.push("../list")},e.handleChange=function(t){var n=t.target.value;e.setState({projectName:n},(function(){e.props.setProjectName(n)}))},e.handleSave=function(){e.state.projectName?e.props.saveProject().then((function(t){t&&(P.a.success({message:"保存成功",duration:3}),e.props.history.push("../list"))})):P.a.error({message:"请输入项目名称",duration:3})},e}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match,n=t.params.projectId;+n&&this.props.getProject(n).then((function(t){var n=t.data.code,r=t.data.data;n===x.a&&e.setState({projectName:r.projectName})})),this.props.history.replace("".concat(t.url,"/product"))}},{key:"componentWillUnmount",value:function(){this.props.clearData()}},{key:"render",value:function(){var e=this.props.match,t=this.state.projectName;return a.a.createElement("div",{className:"projectmanage"},a.a.createElement(d.a,{title:"项目管理"}),a.a.createElement(i.a,{className:"het-list"},a.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"< 返回"),a.a.createElement("h2",null,"基本信息"),a.a.createElement("div",{className:"form-item"},a.a.createElement("p",{className:"label"},a.a.createElement("span",null,a.a.createElement("i",{className:"dot"},"*"),"名称：")),a.a.createElement(c.a,{placeholder:"请输入名称",maxLength:20,name:"projectName",value:t,onChange:this.handleChange})),a.a.createElement("h2",{style:{marginTop:20}},"关联信息"),a.a.createElement("div",{className:"nav-list"},a.a.createElement(o.NavLink,{to:"".concat(e.url,"/product")},"产品设备"),a.a.createElement(o.NavLink,{to:"".concat(e.url,"/position")},"位置数据模型"),a.a.createElement(o.NavLink,{to:"".concat(e.url,"/robot")},"语音机器人")),a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{path:"".concat(e.path,"/product"),component:Q}),a.a.createElement(o.Route,{path:"".concat(e.path,"/position"),component:de}),a.a.createElement(o.Route,{path:"".concat(e.path,"/robot"),component:je}),a.a.createElement(o.Redirect,{from:"".concat(e.path,"/"),to:"".concat(e.path,"/product")})),a.a.createElement("div",{className:"footer"},a.a.createElement(u.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),a.a.createElement(u.a,{type:"primary",className:"btn-cancel",onClick:this.handleBack},"取消"))))}}])&&ke(t.prototype,n),r&&ke(t,r),s}(a.a.Component),Ne=Object(f.b)((function(e){return{project:e.getIn(["projectManage","project"]).toJS()}}),(function(e){return{getProject:function(t){return e(m.a.getProject(t))},setProjectName:function(t){return e(m.a.setProjectName(t))},clearData:function(){return e(m.a.clearData())},saveProject:function(){return e(m.a.saveProject())}}}))(De);n(1486),t.default=function(e){var t=e.match;return a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{path:"".concat(t.url,"/list"),component:k}),a.a.createElement(o.Route,{path:"".concat(t.url,"/:projectId"),component:Ne}),a.a.createElement(o.Redirect,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1553:function(e,t,n){"use strict";n.r(t);n(78),n(224);var r=n(0),a=n.n(r),o=n(40),i=(n(1485),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(35),n(22),n(36),n(26),n(27),n(28),n(104),n(46)),c=(n(103),n(48)),l=(n(1419),n(1420)),u=(n(225),n(86)),s=(n(69),n(19)),f=(n(200),n(85)),p=(n(50),n(45)),d=n(97),m=n(518),y=n(487);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var a=I(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=y.a.Option,S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(p,e);var t,n,r,o=w(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=o.call(this,e)).changeModelName=function(e){console.log(e.target.value),t.setState({modelName:e.target.value})},t.handleFilter=function(){var e=t.state.modelName;t.setState({query:{modelName:e}},t.onChange)},t.handleReset=function(){t.setState({modelName:"",query:{}},(function(){t.refInpt.setState({value:""})}))},t.onChange=function(e){t.setState({loading:!0}),t.props.getLocationList(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({pageIndex:e},t.state.query)).then((function(){t.setState({loading:!1})}))},t.onEdit=function(e){t.props.history.push("/config/positionmodel/".concat(e))},t.handleDel=function(e){f.a.confirm({title:"确定删除数据",centered:!0,onOk:function(){t.props.deleteModel(e)}})},t.state={loading:!1,modelName:"",query:{}},t}return t=p,(n=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this,t=this.props,n=t.locationModelList,r=t.pager,o=this.state.loading,f=[{title:"模型ID",dataIndex:"modelId",key:"modelId",width:"100px"},{title:"名称",dataIndex:"modelName",width:"30%",key:"modelName",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"描述",dataIndex:"modelDesc",width:"40%",key:"modelDesc",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"操作",width:"120px",key:"操作",render:function(t){return a.a.createElement("span",null,a.a.createElement(u.a,{placement:"top",title:"管理模型"},a.a.createElement(s.a,{shape:"circle",size:"small",icon:"container",key:0,onClick:e.onEdit.bind(e,t.modelId)})),a.a.createElement(l.a,{type:"vertical"}),a.a.createElement(u.a,{placement:"top",title:"删除模型"},a.a.createElement(s.a,{shape:"circle",size:"small",icon:"delete",key:1,onClick:e.handleDel.bind(e,t.modelId)})))}}];return a.a.createElement("div",{className:"LocationDataModel_Content"},a.a.createElement(y.a,{title:"数据位置模型"},a.a.createElement(j,null,a.a.createElement(c.a,{style:{width:240},placeholder:"请输入模型名称查询",onChange:this.changeModelName.bind(this),onPressEnter:this.handleFilter.bind(this),ref:function(t){return e.refInpt=t}})),a.a.createElement(j,null,a.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleFilter.bind(this)},"查询")),a.a.createElement(j,null,a.a.createElement(s.a,{className:"modelSearch",type:"primary",onClick:this.handleReset.bind(this)},"重置")),a.a.createElement(j,{align:"right"},a.a.createElement(s.a,{className:"modelCreate",type:"primary",onClick:this.onEdit.bind(this,0)},"新建"))),a.a.createElement(i.a,{className:"LocationDataModel_bottomCard"},a.a.createElement(d.a,{rowKey:"modelId",columns:f,dataSource:n,pager:r,loading:o,onPageChange:this.onChange})))}}])&&g(t.prototype,n),r&&g(t,r),p}(r.Component),C=Object(p.b)((function(e){return{locationModelList:e.getIn(["positionModel","locationModelList"]).toJS(),pager:e.getIn(["positionModel","pager"]).toJS()}}),(function(e){return{getLocationList:function(t){return e(m.getLocationList(t))},deleteModel:function(t){return e(m.deleteLocation(t))}}}))(S),k=(n(1433),n(1445)),P=(n(91),n(24)),x=(n(112),n(122),n(159),n(58),n(393)),T=(n(313),n(172),n(7)),L=(n(1429),n(142),n(308),n(160)),D=(n(132),n(23));function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=q(e);if(t){var a=q(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return F(this,n)}}function F(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V=D.a.Item,U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(i,e);var t,n,r,o=A(i);function i(){var e;_(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={selectedRowKeys:[]},e.onSelectChange=function(t){console.log("..selectedRowKeys..",t),e.setState({selectedRowKeys:t})},e.handleSave=function(){var t=e.props.form,n=e.state.selectedRowKeys;t.validateFields((function(t,r){t||e.props.onOk({elementName:r.elementName,parentIds:n})}))},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.elementsItem;t&&t!==this.props.visible&&n&&(this.setState({selectedRowKeys:"string"==typeof n.parentIds?JSON.parse(n.parentIds):n.parentIds||[]}),this.props.form.setFieldsValue({elementName:n.elementName}))}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onOk,r=e.onCancel,o=e.form,i=e.list,l=o.getFieldDecorator,u={labelCol:{span:5},wrapperCol:{span:17}},p={selectedRowKeys:this.state.selectedRowKeys.filter((function(e){return i.findIndex((function(t){return t.elementId==e}))>=0})),onChange:this.onSelectChange};return a.a.createElement(f.a,{width:600,visible:t,onCancel:r,onOk:n,title:"添加数据",className:"data-model",footer:null},a.a.createElement(D.a,null,a.a.createElement(V,R({},u,{label:"名称"}),l("elementName",{rules:[{required:!0,message:"请输入名称"}]})(a.a.createElement(c.a,{placeholder:"20个以内的字符",maxLength:20}))),this.props.id>0?a.a.createElement(V,R({},u,{label:"关联父层级"}),a.a.createElement(L.a,{rowKey:"elementId",size:"small",rowSelection:p,columns:[{title:"父层级数据",dataIndex:"elementName",width:1e3,textWrap:"word-break"}],pagination:!1,dataSource:i,scroll:{y:194},bordered:!1})):null,a.a.createElement(V,{className:"footer"},a.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),a.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:r},"取消"))))}}])&&M(t.prototype,n),r&&M(t,r),i}(a.a.Component),z=D.a.create()(U);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var a=Z(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(i,e);var t,n,r,o=$(i);function i(){var e;H(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={index:0,visible:!1,selected:[],elementsItem:null},e.onChange=function(t){e.setState({index:t})},e.onEdit=function(t){e.setState({visible:!0,elementsItem:t||null})},e.onCloseItem=function(){e.setState({visible:!1})},e.onAddItem=function(t){var n=e.state.elementsItem,r=e.props,a=r.model,o=r.modelId,i=a.summary.summaryId;a.elements&&a.elements.length>99?P.a.error({message:"单层数据不能超过100",duration:3}):n.elementId&&t.elementName==n.elementName&&t.parentIds==n.parentIds?e.setState({visible:!1}):e.props.addElement(W(W({},t),{},{elementId:n.elementId||null,summaryId:i})).then((function(t){t&&(e.props.getModelList(o),e.setState({visible:!1}))}))},e}return t=i,(n=[{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.model,i=r.nextItem,c=r.prevItem,l=r.id,u=o.summary,s=o.elements,f=this.state,p=f.index,d=f.visible,m=f.elementsItem,y=[];if(i.map((function(e,t){e.parentIds="string"==typeof e.parentIds?JSON.parse(e.parentIds):e.parentIds||[],e.parentIds.findIndex((function(e){return e==s[p].elementId}))>=0&&y.push(t)})),y.length>0){var h=y.sort((function(e,t){return e.id-t.id}));e=p<h[0]?p:h[0],t=p>h[h.length-1]?p:h[h.length-1]}return a.a.createElement("div",null,a.a.createElement("div",{className:"title"},a.a.createElement("p",{title:u.summary},u.summary)),a.a.createElement("ul",null,s.map((function(e,t){return a.a.createElement("li",{className:t==p?"active":"",key:t,onClick:n.onChange.bind(n,t)},e.elementName,a.a.createElement(T.a,{type:"edit",className:"edit",onClick:n.onEdit.bind(n,e)}))})),a.a.createElement("li",{className:"add"},a.a.createElement("p",{onClick:this.onEdit},"添加数据"))),y.length>0?a.a.createElement("svg",{className:"svg",height:50*t+100},a.a.createElement("polyline",{points:"0,".concat(50*p||1," ").concat(40,",").concat(50*p||1)}),y.map((function(e,t){return a.a.createElement("polyline",{points:"".concat(40,",").concat(50*e||1," ").concat(80,",").concat(50*e||1),key:t})})),a.a.createElement("polyline",{points:"".concat(40,",").concat(50*e," ").concat(40,",").concat(50*t)})):null,a.a.createElement(z,{visible:d,onOk:this.onAddItem,onCancel:this.onCloseItem,list:c,wrappedComponentRef:function(e){return n.form=e},elementsItem:m,id:l}))}}])&&Q(t.prototype,n),r&&Q(t,r),i}(a.a.Component),te=Object(p.b)(null,(function(e){return{addElement:function(t){return e(x.a.addElement(t))},getModelList:function(t){return e(x.a.getLocationDetailList(t))}}}))(ee);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ue(e);if(t){var a=ue(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return le(this,n)}}function le(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=D.a.Item,fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(i,e);var t,n,r,o=ce(i);function i(){var e;ae(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).handleSave=function(){e.props.form.validateFields((function(t,n){t||e.props.onOk(n)}))},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible,n=e.summary;t&&t!==this.props.visible&&n&&this.props.form.setFieldsValue({summary:n.summary})}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,r=e.onCancel,o=e.onOk,i=t.getFieldDecorator;return a.a.createElement(f.a,{width:600,visible:n,onCancel:r,onOk:o,title:"编辑数据",className:"data-model",footer:null},a.a.createElement(D.a,null,a.a.createElement(se,re({},{labelCol:{span:5},wrapperCol:{span:15}},{label:"名称"}),i("summary",{rules:[{required:!0,message:"请输入名称"}]})(a.a.createElement(c.a,{placeholder:"20个以内的字符",maxLength:20}))),a.a.createElement(se,{className:"footer"},a.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"),a.a.createElement(s.a,{type:"primary",className:"btn-cancel",onClick:r},"取消"))))}}])&&oe(t.prototype,n),r&&oe(t,r),i}(a.a.Component),pe=D.a.create()(fe);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ge(e);if(t){var a=ge(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===de(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(i,e);var t,n,r,o=be(i);function i(){var e;me(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={visible:!1,summaryItem:null},e.onAddGroup=function(t){var n,r=e.props,a=r.modelId,o=r.model,i=e.state.summaryItem,c=o.length,l=c>0&&i?o.findIndex((function(e){return e.summary.summaryId==i.summaryId})):void 0;n=l?o[l-1].summary.summaryId:void 0;var u={summaryId:i?i.summaryId:null,summary:t.summary,modelId:a,parentId:i?n:c>0?o[c-1].summary.summaryId:void 0};e.props.saveSummary(u).then((function(t){0===t?e.onCloseGroup():P.a.error({message:"保存数据失败",duration:3})}))},e.onCloseGroup=function(){e.form.props.form.resetFields(),e.setState({visible:!1,summaryItem:null})},e.onEdit=function(t){var n=e.props,r=n.modelId,a=n.model;+r?t&&t.summary||!(a.length>9)?(t&&t.summary&&e.setState({summaryItem:t.summary}),e.setState({visible:!0})):P.a.error({message:"层级数不得超过十",duration:3}):P.a.error({message:"请先保存基本信息",duration:3})},e.handleDel=function(t){var n=e.props.modelId;f.a.confirm({title:"是否删除层级？",centered:!0,onOk:function(){e.props.delSummary(t.summaryId).then((function(t){t&&e.props.getModelList(n)}))}})},e}return t=i,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.model,r=t.modelId,o=this.state,i=o.visible,c=o.summaryItem;return a.a.createElement("div",{className:"data-model"},n&&n.length>0?n.map((function(t,o){return a.a.createElement("div",{className:"data-model-item",key:o},a.a.createElement("h2",null,"第".concat("一二三四五六七八九十"[o],"层级")),a.a.createElement(te,{model:t,id:o,nextItem:n[o+1]?n[o+1].elements:[],onEdit:e.onEditItem,prevItem:o>0?n[o-1].elements:[],modelId:r}),a.a.createElement("div",{className:"footer"},a.a.createElement("a",{className:"edit",onClick:e.onEdit.bind(e,t)},"编辑"),a.a.createElement("a",{className:"delete",onClick:e.handleDel.bind(e,t.summary)},"删除")))})):a.a.createElement("div",{className:"data-model-item"},a.a.createElement("div",{className:"title"},a.a.createElement("a",{onClick:this.onEdit},"点击添加"))),n&&n.length>0?a.a.createElement("div",{className:"data-model-item add"},a.a.createElement("a",{onClick:this.onEdit.bind(this)},"添加子层级")):null,a.a.createElement(pe,{visible:i,onOk:this.onAddGroup,onCancel:this.onCloseGroup,wrappedComponentRef:function(t){return e.form=t},summary:c}))}}])&&ye(t.prototype,n),r&&ye(t,r),i}(a.a.Component),we=Object(p.b)((function(e){return{model:e.getIn(["positionModel","model"]).toJS()}}),(function(e){return{saveSummary:function(t){return e(x.a.saveSummary(t))},delSummary:function(t){return e(x.a.delSummary(t))},getModelList:function(t){return e(x.a.getLocationDetailList(t))}}}))(Ee),Oe=n(3);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var a=Te(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){if(t&&("object"===Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Le="/manage-open",De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(u,e);var t,n,r,o=Pe(u);function u(){var e;Se(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={modelName:"",modelDesc:"",editid:-1,editkey:"",editval:"",addkey:"",addval:"",delLabelId:"",deleteLoading:!1,dellabelKey:"",dellabelValue:"",keylist:[],valuesource:[]},e.handleChange=function(t){var n=t.target,r=n.name,a=n.value;e.setState(je({},r,a))},e.handleSave=function(){var t=e.state,n=t.modelName,r=t.modelDesc,a=e.props.match.params.modelId;n?e.props.saveModelDetail({modelName:n,modelDesc:r,modelId:parseInt(a)||""}).then((function(t){0===t&&(P.a.success({message:"保存数据成功",duration:3}),0==a&&e.props.getLocationList().then((function(t){if(t){var n=(t.list?t.list[0]:{}).modelId;n&&e.props.history.replace("/config/positionmodel/".concat(n))}})))})):P.a.error({message:"位置数据模型名称不能为空",duration:3})},e.handleBack=function(){e.props.history.go(-1)},e}return t=u,(n=[{key:"componentDidMount",value:function(){var e=this.props.match.params.modelId,t=this;this.props.resetModelList(),this.getLabelKeyList(),+e&&(this.props.getModelDetail(e).then((function(e){if(e){var n=e.modelName,r=e.modelDesc;t.setState({modelName:n,modelDesc:r})}})),this.props.getModelList(e),this.props.getModLabelList(e))}},{key:"getLabeListHtml",value:function(){var e=this,t=this.props.modList||[],n=this.state,r=n.editid,o=n.editkey,i=n.editval,c=n.valuesource;return t.map((function(t,n){var u=t.relaId,s=t.keyName,f=t.valueName;return u==r?a.a.createElement("tr",{key:"tr_"+n},a.a.createElement("td",null,a.a.createElement(k.a,{value:o,dataSource:e.getKeySource(),style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editkey"),placeholder:"Key",filterOption:!0})),a.a.createElement("td",null,a.a.createElement(k.a,{value:i,dataSource:c,style:{width:"80%"},onChange:e.onChangeInput.bind(e,"editval"),placeholder:"Value",filterOption:!0})),a.a.createElement("td",null,a.a.createElement("a",{href:"javascript:",onClick:e.editConfirm.bind(e,s,f)},"确认"),a.a.createElement(l.a,{type:"vertical"}),a.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,-1,"","")},"取消"))):a.a.createElement("tr",{key:"tr_"+n},a.a.createElement("td",null,s),a.a.createElement("td",null,f),a.a.createElement("td",null,a.a.createElement("a",{href:"javascript:",onClick:e.editLabel.bind(e,u,s,f)},"编辑"),a.a.createElement(l.a,{type:"vertical"}),a.a.createElement("a",{href:"javascript:",onClick:function(){return e.openDelMod(u,s,f)}},"删除")))}))}},{key:"openDelMod",value:function(e,t,n){var r=this,a=this.props.match.params.modelId;f.a.confirm({title:"是否删除该标签？",centered:!0,onOk:function(){Oe.c.Get(Le+"/position/label/rela/delete",{relaId:e}).then((function(e){0==e.data.code&&r.props.getModLabelList(a)}))}})}},{key:"addConfirm",value:function(){var e=this,t=this.state,n=t.addkey,r=t.addval;if(""==n||""==r)return P.a.warning({message:"请将正在添加的标签输入框补充完整",duration:3}),!1;var a=this.props.match.params.modelId;Oe.c.Get(Le+"/position/label/rela/save",{modelId:a,keyName:n,valueName:r}).then((function(t){0==t.data.code&&(e.setState({addkey:"",addval:""}),e.props.getModLabelList(a),e.getLabelKeyList())}))}},{key:"editLabel",value:function(e,t,n){this.setState({editid:e,editkey:t,editval:n})}},{key:"editConfirm",value:function(e,t){var n=this,r=this.state,a=r.editid,o=r.editkey,i=r.editval,c=this.props.match.params.modelId;""==o&&""==i&&P.a.warning({message:"请将标签编辑输入框补充完整",duration:3}),Oe.c.Get(Le+"/position/label/rela/save",{modelId:c,relaId:a,keyName:o||e,valueName:i||t}).then((function(e){0==e.data.code&&(n.setState({editid:-1,editkey:"",editval:""}),n.props.getModLabelList(c),n.getLabelKeyList())}))}},{key:"getDataSource",value:function(e){}},{key:"getKeySource",value:function(){return this.state.keylist.map((function(e,t){return e.keyName}))}},{key:"getLabelKeyList",value:function(){var e=this;Oe.c.Get(Le+"/position/label/key/getList",{}).then((function(t){if(0==t.data.code){var n=t.data.data||[];e.setState({keylist:n})}}))}},{key:"getValueSource",value:function(e){var t=this,n="-1";this.state.keylist.forEach((function(t){t.keyName==e&&(n=t.keyId)})),console.log(n),"-1"!==n?Oe.c.Get(Le+"/position/label/value/getList",{keyId:n}).then((function(e){if(0==e.data.code){var n=(e.data.data||[]).map((function(e,t){return e.valueName}));t.setState({valuesource:n})}})):this.setState({valuesource:[]})}},{key:"onChangeInput",value:function(e,t){if(t&&t.length>20)return!1;var n={};n[e]=t,this.setState(n),"addkey"!=e&&"editkey"!=e||this.getValueSource(t)}},{key:"render",value:function(){var e=this.props.match.params.modelId,t=this.state,n=t.modelName,r=t.modelDesc,o=t.addkey,l=t.addval,u=t.valuesource;return a.a.createElement("div",{className:"location-data"},a.a.createElement(y.a,{title:"".concat("0"!==e?"管理":"新建","位置数据模型")}),a.a.createElement(i.a,{className:"location-detail"},a.a.createElement("div",{className:"het-list"},a.a.createElement(s.a,{type:"primary",className:"btn-back",onClick:this.handleBack.bind(this)},"返回"),a.a.createElement("h2",null,"基本信息"),a.a.createElement("div",{className:"form-item"},a.a.createElement("p",{className:"label"},a.a.createElement("span",null," ",a.a.createElement("i",{className:"dot"},"*"),"名称：")),a.a.createElement(c.a,{placeholder:"请输入名称",value:n,maxLength:20,name:"modelName",onChange:this.handleChange})),a.a.createElement("div",{className:"form-item"},a.a.createElement("p",{className:"label"},a.a.createElement("span",null,"描述：")),a.a.createElement(c.a.TextArea,{placeholder:"请输入名称",value:r,maxLength:100,name:"modelDesc",onChange:this.handleChange})),a.a.createElement("div",{className:"footer"},a.a.createElement(s.a,{type:"primary",className:"btn-save",onClick:this.handleSave},"保存"))),a.a.createElement("div",{className:"het-list"},a.a.createElement("h2",null,"数据模型"),a.a.createElement(we,{modelId:e})),+e>0&&a.a.createElement("div",{className:"het-list"},a.a.createElement("h2",null,"标签管理"),a.a.createElement("table",{className:"labeltable"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{style:{width:"38%"}},"标签Key"),a.a.createElement("th",{style:{width:"38%"}},"标签Value"),a.a.createElement("th",{style:{width:"24%"}},"管理"))),a.a.createElement("tbody",null,this.getLabeListHtml(),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement(k.a,{value:o,dataSource:this.getKeySource(),style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addkey"),placeholder:"Key",maxLength:"20",filterOption:!0})),a.a.createElement("td",null,a.a.createElement(k.a,{value:l,dataSource:u,style:{width:"80%"},onChange:this.onChangeInput.bind(this,"addval"),placeholder:"Value",maxLength:"20",filterOption:!0})),a.a.createElement("td",null,a.a.createElement("a",{href:"javascript:",onClick:this.addConfirm.bind(this)},"确认"))))))))}}])&&Ce(t.prototype,n),r&&Ce(t,r),u}(a.a.Component),Ne=Object(p.b)((function(e){return{modelDetail:e.getIn(["positionModel","modelDetail"]).toJS(),modList:e.getIn(["positionModel","modList"]).toJS()}}),(function(e){return{getModelDetail:function(t){return e(x.a.getLocationDetail(t))},saveModelDetail:function(t){return e(x.a.saveLocationDetail(t))},getLocationList:function(){return e(x.a.getLocationList())},getModelList:function(t){return e(x.a.getLocationDetailList(t))},resetModelList:function(){return e(x.a.resetModelList())},getModLabelList:function(t){return e(x.a.getModLabelList(t))}}}))(De),Re=n(1449);t.default=function(e){var t=e.match;return a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{exact:!0,path:"".concat(t.url,"/list"),component:C}),a.a.createElement(o.Route,{exact:!0,path:"".concat(t.url,"/:modelId"),component:Object(Re.a)(Ne)}),a.a.createElement(o.Redirect,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1560:function(e,t,n){"use strict";n.r(t);n(78),n(224);var r=n(0),a=n.n(r),o=n(40),i=(n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(104),n(46)),c=(n(132),n(23)),l=(n(225),n(86)),u=(n(69),n(19)),s=(n(91),n(24)),f=(n(157),n(37)),p=(n(112),n(58),n(45)),d=n(487),m=n(97),y=n(516),h=(n(142),n(200),n(85)),b=(n(103),n(48));n(159);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var a=S(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=c.a.Item,k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(i,e);var t,n,r,o=I(i);function i(){var e;E(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).onCancel=function(){var t=e.props,n=t.form,r=t.onCancel;n.resetFields(),r()},e.onOk=function(){e.props.form.validateFields((function(t,n){if(!t){var r=n.applyAllocated,a=n.allocationDesc,o=e.props.macItem,i=o.hetModuleTypeId,c=o.macAllocationId;e.props.onOk({applyAllocated:r,allocationDesc:a,hetModuleTypeId:i,macAllocationId:c})}}))},e.handleCheck=function(t,n,r){var a=e.props.macItem.remainAllocated;n>a||"0"===n?r("只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(a)):r()},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.macItem,r=e.visible,o=t.getFieldDecorator,i=n||{},u=i.hetName,s=i.remainAllocated,f={labelCol:{span:6},wrapperCol:{span:14}};return a.a.createElement(h.a,{width:600,visible:r,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},a.a.createElement(c.a,null,a.a.createElement(C,g({label:"模组型号"},f),o("hetName",{initialValue:u})(a.a.createElement(b.a,{disabled:!0}))),a.a.createElement(C,g({label:"申请数量"},f),a.a.createElement(l.a,{placement:"right",title:"只能输入1-65536之间的正整数,并且不能大于当前的未分配数量".concat(s),overlayStyle:{width:300}},o("applyAllocated",{rules:[{required:!0,message:"请输入申请数量"},{validator:this.handleCheck}],getValueFromEvent:function(e){return e.target.value.replace(/[^\d]/,"")}})(a.a.createElement(b.a,{placeholder:"请输入申请数量",maxLength:5})))),a.a.createElement(C,g({label:"申请描述"},f),a.a.createElement(l.a,{placement:"right",title:"最多支持输入50个字符。",overlayStyle:{width:300}},o("allocationDesc",{rules:[{required:!0,message:"请输入申请描述"}]})(a.a.createElement(b.a.TextArea,{maxLength:50,placeholder:"请输入申请描述",style:{height:100}}))))))}}])&&w(t.prototype,n),r&&w(t,r),i}(a.a.Component),P=c.a.create()(k);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var a=M(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=c.a.Item,A=f.a.Option,F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(i,e);var t,n,r,o=R(i);function i(){var e;L(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).onCancel=function(){var t=e.props,n=t.form,r=t.onCancel;n.resetFields(),r()},e.onOk=function(){e.props.form.validateFields((function(t,n){t||e.props.onOk(n)}))},e.handleCheck=function(e,t,n){/^[0-9A-F]{2}$/.test(t)||n("只能输入两位数的十六进制[0-9、A~F]"),n()},e}return t=i,(n=[{key:"componentWillReceiveProps",value:function(e){var t=e.visible;this.props.visible&&!t&&this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,r=e.moduleList,o=t.getFieldDecorator,i={labelCol:{span:8},wrapperCol:{span:14}};return a.a.createElement(h.a,{width:600,visible:n,onCancel:this.onCancel,onOk:this.onOk,title:"分配MAC"},a.a.createElement(c.a,null,a.a.createElement(B,T({label:"模组型号"},i),o("hetModuleTypeId",{rules:[{required:!0,message:"请选择模组型号"}]})(a.a.createElement(f.a,{placeholder:"请选择"},r.map((function(e){return a.a.createElement(A,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)}))))),a.a.createElement(B,T({label:"MAC地址（第四字节）"},i),a.a.createElement(l.a,{placement:"right",title:"只能输入两位数的十六进制[0-9、A~F]",overlayStyle:{width:300}},o("productCode",{rules:[{min:2,max:2,required:!0,message:"请MAC地址（第四字节）"},{validator:this.handleCheck}],getValueFromEvent:function(e){return String.prototype.toLocaleUpperCase.call(e.target.value.substr(0,2).replace(/[^0-9a-fA-F]/,""))}})(a.a.createElement(b.a,{maxLength:2,placeholder:"MAC地址（第四字节）"}))))))}}])&&D(t.prototype,n),r&&D(t,r),i}(a.a.Component),q=c.a.create()(F),V=n(33),U=n(1447);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q(e);if(t){var a=Q(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return H(this,n)}}function H(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y=f.a.Option,$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(p,e);var t,n,r,o=G(p);function p(){var e;K(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={loading:!1,moduleId:"",query:{},visible:!1,macItem:null,addVisible:!1},e.handleDetail=function(t){var n=t.hetModuleTypeId,r=t.productCode;e.props.history.push("./".concat(n,"/").concat(r))},e.handleEdit=function(t){e.setState({visible:!0,macItem:t})},e.onCancel=function(){e.setState({macItem:null,visible:!1})},e.handleAdd=function(){e.setState({addVisible:!0})},e.handleAddCancel=function(){e.setState({addVisible:!1})},e.onOk=function(t){console.log("----",t),e.props.macAllocation(t).then((function(t){t&&(s.a.success({message:"分配成功",duration:3}),e.props.onChange(1),e.onCancel())}))},e.handleAddMac=function(t){e.props.addMac(t).then((function(t){t&&(s.a.success({message:"新增MAC成功",duration:3}),e.props.onChange(1),e.handleAddCancel())}))},e}return t=p,(n=[{key:"componentDidMount",value:function(){this.props.getModuleList()}},{key:"render",value:function(){var e=this,t=this.state,n=(t.moduleId,t.visible),r=t.macItem,o=t.addVisible,s=this.props,p=s.macList,y=s.pager,h=s.moduleList,b=s.form,v=s.loading,g=b.getFieldDecorator,E=[{title:"模组型号",dataIndex:"hetName",width:"15%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"MAC地址（第4字节）",dataIndex:"productCode",width:"10%",className:"th-break"},{title:a.a.createElement("span",{title:"起始MAC"},"起始MAC"),dataIndex:"macBegin",width:"125px",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:a.a.createElement("span",{title:"结束MAC"},"结束MAC"),dataIndex:"macEnd",width:"125px",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"MAC总量",dataIndex:"maxinumAvailable",width:"10%"},{title:"已分配数",dataIndex:"quantityAllocated",width:"10%"},{title:"未分配数",dataIndex:"remainAllocated",width:"10%"},{title:"修改时间",dataIndex:"updateTime",width:"15%",className:"th-break",render:function(e){var t=V.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return a.a.createElement("span",{title:t},t)}},{title:"创建时间",dataIndex:"createTime",width:"15%",className:"th-break",render:function(e){var t=V.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return a.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",fixed:"right",render:function(t){return a.a.createElement("div",{className:"action"},a.a.createElement(l.a,{placement:"top",title:"分配"},a.a.createElement(u.a,{icon:"apartment",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",a.a.createElement(l.a,{placement:"top",title:"查看"},a.a.createElement(u.a,{icon:"info",shape:"circle",size:"small",onClick:e.handleDetail.bind(e,t)})))}}];return a.a.createElement("div",{className:"macList"},a.a.createElement(d.a,{title:"和而泰MAC分配"},a.a.createElement(c.a,{layout:"inline"},a.a.createElement(c.a.Item,{label:"模组型号"},g("hetModuleTypeId")(a.a.createElement(f.a,{style:{width:240},placeholder:"请选择模组型号"},a.a.createElement(Y,{key:"",value:""},"全部"),h.map((function(e){return a.a.createElement(Y,{value:e.moduleId,key:e.moduleId},e.hetModuleTypeName)}))))),a.a.createElement(c.a.Item,null,a.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),a.a.createElement(c.a.Item,null,a.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),a.a.createElement(c.a.Item,{style:{float:"right"}},a.a.createElement(u.a,{type:"primary",onClick:this.handleAdd},"新建")))),a.a.createElement(i.a,null,a.a.createElement(m.a,{rowKey:"macAllocationId",columns:E,dataSource:p,pager:y,onPageChange:this.props.onChange,loading:v,scroll:{x:1200,y:"auto"}})),a.a.createElement(P,{visible:n,macItem:r,onCancel:this.onCancel,onOk:this.onOk}),a.a.createElement(q,{visible:o,moduleList:h,onCancel:this.handleAddCancel,onOk:this.handleAddMac}))}}])&&J(t.prototype,n),r&&J(t,r),p}(a.a.Component),X=Object(p.b)((function(e){return{macList:e.getIn(["macAllocation","macList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS(),moduleList:e.getIn(["macAllocation","moduleList"]).toJS(),loading:e.getIn(["macAllocation","loading"])}}),(function(e){return{getList:function(t){return e(y.a.getMacList(t))},getModuleList:function(){return e(y.a.getModuleList())},macAllocation:function(t){return e(y.a.macAllocation(t))},addMac:function(t){return e(y.a.addMac(t))}}}))(c.a.create()(Object(U.a)($)));function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oe(e);if(t){var a=oe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ae(this,n)}}function ae(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(c,e);var t,n,r,o=re(c);function c(){var e;ee(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={hetModuleTypeId:"",productCode:"",loading:!1},e.onChange=function(t){var n=e.props.match.params,r=n.hetModuleTypeId,a=n.productCode;e.setState({loading:!0}),e.props.getMacDetailList({hetModuleTypeId:r,productCode:a,pageIndex:t}).then((function(){e.setState({loading:!1})}))},e.handleBack=function(){e.props.history.go(-1)},e}return t=c,(n=[{key:"componentDidMount",value:function(){this.onChange()}},{key:"render",value:function(){var e=this.state.loading,t=this.props,n=t.macDetailList,r=t.pager,o=[{title:"MAC起始地址",dataIndex:"macBegin",width:"15%"},{title:"MAC结束地址",dataIndex:"macEnd",width:"15%"},{title:"申请数量",dataIndex:"allocationCount",width:"10%"},{title:"描述",dataIndex:"allocationDesc",width:"30%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"创建时间",dataIndex:"createTime",width:"20%",render:function(e){var t=V.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return a.a.createElement("span",null,t)}},{title:"操作",render:function(e){return a.a.createElement("div",{className:"action"},a.a.createElement("a",{href:"/v1/web/manage-open/mac/allocation/excelExport?macBegin=".concat(e.macBegin,"&macEnd=").concat(e.macEnd),target:"blank"},"导出"))}}];return a.a.createElement("div",{className:"macList"},a.a.createElement(d.a,{title:"MAC详情"},a.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),a.a.createElement(i.a,null,a.a.createElement(m.a,{rowKey:"macAllocationId",pagination:!1,columns:o,dataSource:n,pager:r,onPageChange:this.onChange,loading:e})))}}])&&te(t.prototype,n),r&&te(t,r),c}(a.a.Component),ce=Object(p.b)((function(e){return{macDetailList:e.getIn(["macAllocation","macDetailList"]).toJS(),pager:e.getIn(["macAllocation","pager"]).toJS()}}),(function(e){return{getMacDetailList:function(t){return e(y.a.getMacDetailList(t))},exportList:function(){return e(y.a)}}}))(ie);n(1487),t.default=function(e){var t=e.match;return a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{path:"".concat(t.url,"/list"),component:X}),a.a.createElement(o.Route,{path:"".concat(t.url,"/:hetModuleTypeId/:productCode"),component:ce}),a.a.createElement(o.Redirect,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1564:function(e,t,n){"use strict";n.r(t);n(78),n(224);var r=n(0),a=n.n(r),o=n(40),i=(n(132),n(23)),c=(n(103),n(48)),l=(n(225),n(86)),u=(n(69),n(19)),s=(n(200),n(85)),f=(n(112),n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(45)),p=n(487),d=n(97),m=n(175),y=n(510),h=n(33),b=n(1447);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var a=S(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(f,e);var t,n,r,o=O(f);function f(){var e;g(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).handleEdit=function(t){e.props.history.push("./".concat(t.roleId||0)),e.props.setRoleDetail(t)},e.handleDel=function(t){var n=j(e);s.a.confirm({title:"提示",content:"是否确认删除？",onOk:function(){console.log("确认删除"),n.props.delRole(t)}})},e}return t=f,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.roleList,r=t.pager,o=t.loading,s=t.form.getFieldDecorator,f=[{title:"角色名",dataIndex:"roleName",width:"20%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"角色备注",dataIndex:"remark",width:"35%",render:function(e){return a.a.createElement("span",{title:e},e)}},{title:"最新修改时间",dataIndex:"modifyTime",width:"30%",render:function(e){var t=h.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return a.a.createElement("span",{title:t},t)}},{title:"操作",render:function(t){return a.a.createElement("div",{className:"action"},a.a.createElement(l.a,{placement:"top",title:"编辑"},a.a.createElement(u.a,{icon:"edit",shape:"circle",size:"small",onClick:e.handleEdit.bind(e,t)})),"  |  ",a.a.createElement(l.a,{placement:"top",title:"删除"},a.a.createElement(u.a,{icon:"delete",shape:"circle",size:"small",onClick:e.handleDel.bind(e,t.roleId)})))}}];return a.a.createElement("div",{className:"interface-role"},a.a.createElement(p.a,{title:"接口访问用户角色"},a.a.createElement(i.a,{layout:"inline"},a.a.createElement(i.a.Item,{label:"角色名"},s("roleName")(a.a.createElement(c.a,{placeholder:"请输入角色名",maxLength:20,style:{width:240},onPressEnter:this.props.onFilter}))),a.a.createElement(i.a.Item,null,a.a.createElement(u.a,{type:"primary",onClick:this.props.onFilter},"查询")),a.a.createElement(i.a.Item,null,a.a.createElement(u.a,{type:"primary",onClick:this.props.onReset},"重置")),a.a.createElement(i.a.Item,{style:{float:"right"}},a.a.createElement(u.a,{type:"primary",onClick:this.handleEdit.bind(this,{})},"新建")))),a.a.createElement("div",{className:"interface-role-content"},a.a.createElement(d.a,{rowKey:"roleId",columns:f,dataSource:n,pager:r,loading:o,onPageChange:this.props.onChange})))}}])&&E(t.prototype,n),r&&E(t,r),f}(a.a.Component),k=Object(f.b)((function(e){return{roleList:e.getIn(["interfaceRole","roleList"]).toJS(),pager:e.getIn(["interfaceRole","pager"]).toJS(),loading:e.getIn(["interfaceRole","loading"])}}),(function(e){return Object(m.b)({getList:y.a.getList,setRoleDetail:y.a.setRoleDetail,delRole:y.a.delRole},e)}))(i.a.create()(Object(b.a)(C))),P=(n(41),n(39),n(43),n(32),n(44),n(91),n(24)),x=(n(122),n(157),n(37)),T=(n(58),n(158),n(261),n(390),n(201),n(113),n(133),n(852),n(853),n(854),n(855),n(856),n(857),n(858),n(859),n(860),n(861),n(862),n(863),n(864),n(865),n(866),n(867),n(868),n(313),n(1452)),L=n(111);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var a=A(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M(this,n)}}function M(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=i.a.Item,U=x.a.Option,z=function e(t){return t&&t.map((function(t){return{id:t.boxId,name:(t.boxName||t.groupName||"").split("#")[0],children:e(t.subBoxs)}}))};var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(i,e);var t,n,r,o=_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).refInput=void 0,t.refTree=void 0,t.changeMenu=function(e){t.setState({menuCode:e,searchStr:""},(function(){t.refInput.setState({value:"",expandedKeys:[]})})),"dataDimension"===e?t.setState({searchType:L.a.Label}):"dataObject"===e&&t.setState({searchType:L.a.Product})},t.changeKey=function(e){var n=e.target.value,r=t.state.menuCode,a=t.props.authTree,o=a&&a.length?r||a[0].menuCode:"",i=a.find((function(e){return e.menuCode===o})),c=i?i.checkBoxGroupList:[];t.setState({searchStr:n},(function(){if(""!==n){var e=[];!function e(t,n,r,a){return t&&t.map((function(t){(t.boxName&&t.boxName.indexOf(r)>=0||t.groupName&&t.groupName.indexOf(r)>=0)&&n.push(a+t.boxId),e(t.subBoxs,n,r,a+t.boxId+"-")}))}(c,e,n,"");var r=[];e.map((function(e){var t=e.split("-").slice(0,-1),n="";t.forEach((function(e){n+=e,r.push(n),n+="-"}))}));var a=Array.from(new Set(r));t.refTree.setState({expandedKeys:a})}else t.refTree.setState({expandedKeys:[],selectedKeys:[]})}))},t.handleSearchType=function(e){t.setState({searchType:e},(function(){t.refInput.setState({value:""})}))},t.handleSearch=Object(h.h)((function(e){var n=t.state.searchType;t.props.searchAuth({type:n,typeName:e}).then((function(n){t.changeKey({target:{value:e}})}))}),800),t.handleChange=function(e,n){var r,a,o,i,c=t.props,l=c.authTree,u=c.authCheck,s=t.state.menuCode,f=l&&l.length?s||l[0].menuCode:"",p=l.findIndex((function(e){return e.menuCode===f})),d=(r=u[p],a=e,o=r.filter((function(e){return!a.includes(e)})),i=a.filter((function(e){return!r.includes(e)})),[].concat(F(o),F(i)));t.props.setAuthTreeCheck([].concat(F(u.slice(0,p)),[e],F(u.slice(p+1)))),"dataDimension"!==f&&"dataObject"!==f?t.props.setTargetTreeCheck([].concat(F(u.slice(0,p)),[e],F(u.slice(p+1)))):t.props.mergeToTargetTree(p,d,n.checked)},t.handleClear=function(){var e=t.props,n=e.targetCheck,r=e.authTree,a=e.authCheck,o=t.state.menuCode,i=r&&r.length?o||r[0].menuCode:"";r.findIndex((function(e){return e.menuCode===i}));t.props.setAuthTreeCheck(a.map((function(e){return[]}))),t.props.setTargetTreeCheck(n.map((function(e){return[]})))},t.handleSave=function(){var e=t.props,n=e.targetTree,r=e.targetCheck,a=Object(h.i)(n),o=r.reduce((function(e,t){return e.concat(t)}),[]),i=[];return o.map((function(e){var t=e.split("-").slice(1);i=i.concat(t)})),i=Array.from(new Set(i)),a&&a.map((function(e){"hideData"!==e.menuCode&&function e(t,n){return t&&t.length&&t.map((function(t){t.checked=n.includes(t.boxId+""),e(t.subBoxs,n)}))}(e.checkBoxGroupList,i)})),a.reduce((function(e,t){return e.concat(t.checkBoxGroupList)}),[])},t.state={menu:"",menuCode:"",menuIndex:0,searchStr:"",searchType:L.a.Product},t.props.onRef(B(t)),t}return t=i,(n=[{key:"componentWillUnmount",value:function(){this.props.clearRoleData()}},{key:"render",value:function(){var e=this,t=this.props,n=t.targetTree,r=t.targetCheck,o=t.authTree,i=t.authCheck,l=this.state,u=l.searchStr,s=l.searchType,f=l.menuCode,p={width:300},d={dataDimension:a.a.createElement(c.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t},style:p}),dataObject:a.a.createElement(c.a.Group,{compact:!0,className:"auth-key",style:p},a.a.createElement(x.a,{style:{width:110},value:s,onChange:this.handleSearchType},a.a.createElement(U,{key:"product",value:L.a.Product},"产品"),a.a.createElement(U,{key:"app",value:L.a.App},"APP应用"),a.a.createElement(U,{key:"appWeChat",value:L.a.AppWeChat},"微信小程序")),a.a.createElement(c.a,{style:{width:190},placeholder:"输入关键字查找",maxLength:20,onChange:function(t){return e.handleSearch(t.target.value)},ref:function(t){return e.refInput=t}}))},m=o&&o.length?f||o[0].menuCode:"",y=o.findIndex((function(e){return e.menuCode===m})),h=[];y>=0&&(h=z(o[y].checkBoxGroupList),z(n[y].checkBoxGroupList));var b=n.map((function(e,t){return{id:e.menuCode,name:e.menuName,children:z(e.checkBoxGroupList)}})),v=r.map((function(e,t){return e.map((function(e){return n[t].menuCode+"-"+e}))})).reduce((function(e,t){return e.concat(t)}),[]);return a.a.createElement(V,{label:"权限配置"},a.a.createElement("div",{className:"interface-role-search"},a.a.createElement(x.a,{className:"auth-api",onChange:this.changeMenu,style:{width:180},value:m},o&&o.length?o.map((function(e){return a.a.createElement(U,{key:e.menuCode,value:e.menuCode},e.menuName)})):a.a.createElement(U,{key:"",value:""},"")),["dataDimension","dataObject"].includes(m)?d[m]:a.a.createElement(c.a,{className:"auth-key",placeholder:"输入关键字查找",maxLength:20,onChange:this.changeKey,ref:function(t){return e.refInput=t},style:p})),a.a.createElement("div",{className:"interface-role-auth"},a.a.createElement("div",{className:"tree-transfer"},a.a.createElement("div",{className:"tree-transfer-wraper"},a.a.createElement(T.a,{dataSource:h,target:i[y],onChange:this.handleChange,ref:function(t){return e.refTree=t},searchStr:u})),a.a.createElement("h3",{className:"tree-transfer-tab"},a.a.createElement("span",null,"已选权限"),a.a.createElement("span",{className:"btn-clear",onClick:this.handleClear},"全部清除")),a.a.createElement("div",{className:"tree-transfer-wraper"},a.a.createElement(T.a,{dataSource:b,target:v,isCheck:!1,isExpand:!0})))))}}])&&N(t.prototype,n),r&&N(t,r),i}(a.a.Component),J=Object(f.b)((function(e){return{authTree:e.getIn(["interfaceRole","authTree"]).toJS(),authCheck:e.getIn(["interfaceRole","authCheck"]).toJS(),targetTree:e.getIn(["interfaceRole","targetTree"]).toJS(),targetCheck:e.getIn(["interfaceRole","targetCheck"]).toJS()}}),(function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,setRoleAuthTarget:y.a.setRoleAuthTarget,searchAuth:y.a.searchAuth,setAuthTreeCheck:y.a.setAuthTreeCheck,setTargetTreeCheck:y.a.setTargetTreeCheck,mergeToTargetTree:y.a.mergeToTargetTree,clearRoleData:y.a.clearRoleData},e)}))(K);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=te(e);if(t){var a=te(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ee(this,n)}}function ee(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ne=i.a.Item,re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(l,e);var t,n,r,o=Z(l);function l(){var e;Y(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).refSet=void 0,e.state={isChecked:!1},e.handleBack=function(){e.props.history.go(-1)},e.handleSave=function(){var t=e.props,n=t.form,r=t.roleDetail;n.validateFields((function(t,n){if(!t)if(n.roleName){var a=e.refSet.handleSave();e.props.saveRole(H(H({roleId:r.roleId||void 0},n),{},{dataJson:JSON.stringify(a)})).then((function(t){t&&(P.a.success({duration:3,message:"保存成功"}),e.props.history.go(-1))}))}else P.a.error({duration:3,message:"角色名不能为空"})}))},e}return t=l,(n=[{key:"componentDidMount",value:function(){var e=this.props.match.params.roleId;this.props.getRoleAuth(+e),+e&&this.props.getRoleDetail(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,r=t.roleDetail,o=n.getFieldDecorator;return a.a.createElement("div",{className:"interface-role"},a.a.createElement(p.a,{title:"用户角色"},a.a.createElement(u.a,{type:"primary",className:"btn-back",onClick:this.handleBack},"返回")),a.a.createElement("div",{className:"interface-role-content"},a.a.createElement(i.a,null,a.a.createElement(ne,{label:"用户角色名"},o("roleName")(a.a.createElement(c.a,{style:{width:500},placeholder:"20个字符以内",maxLength:20}))),a.a.createElement(ne,{label:"角色备注"},o("remark")(a.a.createElement(c.a,{style:{width:500},placeholder:"不超过100个字符",maxLength:100}))),a.a.createElement(J,{onRef:function(t){return e.refSet=t}}),a.a.createElement(ne,{style:{textAlign:"center"}},a.a.createElement(u.a,{type:"primary",onClick:this.handleSave},r.roleId?"保存":"创建用户角色"),a.a.createElement(u.a,{type:"default",style:{marginLeft:20},onClick:this.handleBack},"取消")))))}}])&&$(t.prototype,n),r&&$(t,r),l}(a.a.Component),ae=Object(f.b)((function(e){return{roleDetail:e.getIn(["interfaceRole","roleDetail"]).toJS()}}),(function(e){return Object(m.b)({getRoleAuth:y.a.getRoleAuth,getRoleDetail:y.a.getRoleDetail,modifyRoleDetail:y.a.modifyRoleDetail,saveRole:y.a.saveRole},e)}))(i.a.create({mapPropsToFields:function(e){return e.roleDetail?{roleName:i.a.createFormField({value:e.roleDetail.roleName}),remark:i.a.createFormField({value:e.roleDetail.remark})}:null},onFieldsChange:function(e,t){for(var n in t)e.modifyRoleDetail(Q({},n,t[n].value))}})(re)),oe=(n(1488),n(1449));t.default=function(e){var t=e.match;return a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{exact:!0,path:"".concat(t.url,"/list"),component:k}),a.a.createElement(o.Route,{exact:!0,path:"".concat(t.url,"/:roleId"),component:Object(oe.a)(ae)}),a.a.createElement(o.Redirect,{from:"".concat(t.url,"/"),to:"".concat(t.url,"/list")}))}},1571:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(104);var r=n(46),a=(n(869),n(392)),o=(n(78),n(224),n(58),n(0)),i=n.n(o),c=(n(39),n(43),n(32),n(44),n(142),n(69),n(19)),l=(n(851),n(264)),u=(n(103),n(48)),s=(n(132),n(23)),f=(n(200),n(85)),p=(n(157),n(37)),d=(n(112),n(41),n(1421),n(45)),m=n(504),y=n(217);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=p.a.Option,P=f.a.confirm,x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(o,e);var t,n,r,a=j(o);function o(){var e;w(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a.call.apply(a,[this].concat(n))).generateOptions=function(e){if(e&&e.length>0)return e.map((function(e,t){return i.a.createElement(k,{value:e.moduleBrandId,key:e.moduleBrandId},e.brandName)}))},e.saveModuleInfo=function(){var t=e.props,n=t.moduleInfo,r=t.form.validateFields;n&&n.moduleId?r((function(t,n){t||e.props.changeCurrent()})):r((function(t,n){if(!t){console.log("第一步提交了====",n);var r=g(g({},n),{},{stepIndex:1});Object(y.j)(r).then((function(t){var n=t.data;if(0===n.code){var r=n.data.moduleId;e.props.getModuleInfo(r),e.props.changeCurrent()}}))}}))},e.canleClick=function(){P({title:"当前编辑信息未保存，是否继续退出",content:"",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){e.props.goBack()},onCancel:function(){}})},e.checkNumber=function(e,t,n){t<0?n("仅允许输入正整数"):n()},e}return t=o,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,n=t.moduleInfo,r=t.brandItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,b({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"模组生产厂家"},e("moduleBrandId",{rules:[{required:!0,message:"请选择模组生产厂家"}]})(i.a.createElement(p.a,{placeholder:"请选择模组生产厂家"},this.generateOptions(r)))),i.a.createElement(s.a.Item,{label:"模组型号"},e("hetModuleTypeName",{rules:[{required:!0,message:"请输入模组型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"模组IC型号"},e("originalModuleTypeName",{rules:[{required:!0,message:"请输入模组IC型号"},{type:"string",max:50,message:"上限50个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组IC型号",maxLength:50}))),i.a.createElement(s.a.Item,{label:"适用范围"},e("applyScope",{rules:[{required:!0,message:"请输入模组适用范围"},{type:"string",max:50,message:"上限20个字符长度"}]})(i.a.createElement(u.a,{type:"text",placeholder:"请输入模组适用范围，如：家电产品",maxLength:50}))),i.a.createElement(s.a.Item,{className:"moduleSize",label:"模组尺寸"},i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeThickness",{initialValue:n.sizeThickness,rules:[{required:!0,message:"请输入厚"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{label:"",style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeWidth",{initialValue:n.sizeWidth,rules:[{required:!0,message:"请输入宽"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("span",null," -   "),i.a.createElement(s.a.Item,{style:{display:"inline-block",width:"100px",marginBottom:0}},e("sizeHeight",{initialValue:n.sizeHeight,rules:[{required:!0,message:"请输入高"},{validator:this.checkNumber.bind(this)}]})(i.a.createElement(l.a,{maxLength:3,max:999}))),i.a.createElement("br",null),i.a.createElement("span",null,"（长*宽*高 mm）")),i.a.createElement(s.a.Item,b({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(c.a,{type:"primary",onClick:this.saveModuleInfo,style:{marginRight:10}},"下一步"),i.a.createElement(c.a,{type:"default",onClick:this.canleClick},"取 消"))))}}])&&O(t.prototype,n),r&&O(t,r),o}(o.Component),T=Object(d.b)((function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}}),(function(e){return{saveModuleInfo:function(t){var n=m.a.saveModuleInfo(t);e(n)},getModuleInfo:function(t,n){var r=m.a.getModuleInfo(t,n);e(r)},changeCurApi:function(t,n){var r=m.a.changeCurApi(t,n);e(r)}}}))(s.a.create({name:"BasicParamsFrom",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0],r=Object.values(t)[0];e.changeCurApi(n,r.value)}},mapPropsToFields:function(e){for(var t=e.moduleInfo,n={},r=0,a=Object.keys(t);r<a.length;r++){var o=a[r];n[o]=s.a.createFormField({value:t[o]})}return n}})(x)),L=(n(849),n(493)),D=(n(488),n(174)),N=(n(262),n(118)),R=(n(172),n(7)),_=(n(223),n(123)),M=(n(391),n(65),n(122),n(1480),n(33));function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function F(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var a=K(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return z(this,n)}}function z(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J=p.a.Option,W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(o,e);var t,n,r,a=U(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).moduleTypeOption=function(e){if(e&&e.length>0)return e.map((function(e,t){return i.a.createElement(J,{value:e.moduleId,key:e.moduleId},e.moduleId+" "+e.hetModuleTypeName)}))},t.potocolOption=function(e){if(e&&e.length>0)return e.map((function(e,t){return i.a.createElement(J,{value:e.supportProtocol,key:e.supportProtocol},e.supportProtocolName)}))},t.sceneOptions=function(e){if(e&&e.length>0)return e.map((function(e,t){return i.a.createElement(J,{value:e.sceneTypeId,key:e.sceneTypeId},e.sceneTypeName)}))},t.dataLengthLimitOption=function(e){if(e&&e.length>0)return e.map((function(e,t){return i.a.createElement(J,{value:e.dataLengthLimit,key:e.dataLengthLimit},e.dataLengthLimitName)}))},t.preClick=function(){t.props.changeCurrent()},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){F(o,r,a,i,c,"next",e)}function c(e){F(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),t.getBase64=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.handleSubmit=function(){var e=t.props.moduleInfo;t.props.form.validateFields((function(n,r){if(!n){var a={moduleTypeList:r.moduleTypeList,appModuleId:r.appModuleId,networkTypeList:r.networkTypeList,supportProtocolType:r.supportProtocolType,communicateSpeed:r.communicateSpeed,bindSceneType:r.bindSceneType,supportFileTransfer:r.supportFileTransfer,supportSocProject:r.supportSocProject,burnFileVersion:r.burnFileVersion,libraryFileVersion:r.libraryFileVersion,sourceCodeVersion:r.sourceCodeVersion,moduleId:e.moduleId,dataLengthLimit:r.dataLengthLimit,stepIndex:2,sizeWidth:e.sizeWidth,sizeHeight:e.sizeHeight,sizeThickness:e.sizeThickness,applyScope:e.applyScope,originalModuleTypeName:e.originalModuleTypeName,hetModuleTypeName:e.hetModuleTypeName,moduleBrandId:e.moduleBrandId};Object(y.j)(a).then((function(e){0===e.data.code&&_.a.success("提交成功",2,(function(){return t.props.goBack()}))}))}}))},t.checkboxOnChange=function(e){t.props.getAllModuleTypeList(e),t.props.form.resetFields("appModuleId")},t.handleChange=function(e,n){console.log(e,n.file,n.file.status,n.fileList);var r=n.file,a=n.fileList;if("done"===r.status){var o=a[0];o.url=o.response.data.url;var i=[];i.push(o),t.props.changeCurApi(e,i),t.saveFileUrl(e,n.file)}else"error"===r.status?(_.a.error("".concat(n.file.name," 上传失败")),n.fileList.length=0,t.props.changeCurApi(e,n.fileList)):"removed"===r.status?t.props.changeCurApi(e,n.fileList):void 0===n.file.status&&(n.fileList.length=0,t.props.changeCurApi(e,n.fileList))},t.saveFileUrl=function(e,n){var r=t.props.moduleInfo,a=r.historyObj,o={moduleId:r.moduleId,columnName:e,historyFileUrl:a[e],fileUrl:n.response.data.url,fileName:n.name};Object(y.k)(o).then((function(e){0===e.data.code&&console.log("文件保存成功")}))},t.getFile=function(e,t){var n=[],r=t[e];if(void 0!==r){var a=e+"Name",o={url:r,status:"done",name:t[a],uid:0+a};n.push(o),console.log("render file :",o)}return n},t.state={previewVisible:!1,previewImage:""},t}return t=o,(n=[{key:"sourceCodeBeforeUpload",value:function(e){var t="application/zip"===e.type||"application/x-zip-compressed"===e.type;t||_.a.error("只能上传zip文件");var n=e.size/1024/1024<=512;n||_.a.error("zip文件必须小于512M!");var r=e.name.length<=50;return r||_.a.error("文件名称长度不超过50个字符"),t&&n&&r}},{key:"libraryFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t=".a"===e.name.substr(e.name.lastIndexOf(".")).toLowerCase();t||_.a.error("只能上传.a库文件");var n=e.size/1024/1024<=512;n||_.a.error(".a库文件必须小于512M!");var r=e.name.length<=50;return r||_.a.error("文件名称长度不超过50个字符"),t&&n&&r}},{key:"burnFileBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/macbinary"===e.type||"application/octet-stream"===e.type;t||_.a.error("只能上传烧录文件!");var n=e.size/1024/1024<=32;n||_.a.error(".bin文件必须小于32M!");var r=e.name.length<=50;return r||_.a.error("文件名称长度不超过50个字符"),t&&n&&r}},{key:"modulePictureBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="image/jpeg"===e.type||"image/png"===e.type;t||_.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;n||_.a.error("图片必须小于500KB!");var r=e.name.length<=50;return r||_.a.error("文件名称长度不超过50个字符"),t&&n&&r}},{key:"referenceCircuitDiagramBeforeUpload",value:function(e){console.log("file,file.type",e,e.type);var t="application/pdf"===e.type;t||_.a.error("只能上传PDF文件");var n=e.size/1024/1024<=2;n||_.a.error("PDF must smaller than 2M!");var r=e.name.length<=50;return r||_.a.error("文件名称长度不超过50个字符"),t&&n&&r}},{key:"render",value:function(){var e={action:M.j,className:"upload-list-inline",data:function(e){return{appId:31438,domainType:4}}},t=this.props.form.getFieldDecorator,n=i.a.createElement(c.a,null,i.a.createElement(R.a,{type:"upload"})," 上传文档"),r=this.props,a=r.moduleInfo,o=r.communicationMethodList,d=r.dataLengthLimitList,m=r.networkMethodList,y=r.protocolList,h=r.bindSceneList,b=r.moduleTypeItems;return i.a.createElement("div",{className:"first-content"},i.a.createElement(s.a,A({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:9}}},{className:"data-label-form"}),i.a.createElement(s.a.Item,{label:"通信方式"},t("moduleTypeList",{rules:[{required:!0,message:"请选择通信方式"}]})(i.a.createElement(N.a.Group,{onChange:this.checkboxOnChange},o&&o.length?o.map((function(e){return i.a.createElement(N.a,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)})):null))),i.a.createElement(s.a.Item,{label:"模组所属库"},t("appModuleId",{rules:[{required:!0,message:"请您选择模组所属库"}]})(i.a.createElement(p.a,{placeholder:"请选择模组所属库"},this.moduleTypeOption(b)))),i.a.createElement(s.a.Item,{label:"配网方式"},t("networkTypeList",{rules:[{required:!0,message:"请选择配网方式"}]})(i.a.createElement(N.a.Group,null,m&&m.length?m.map((function(e){return i.a.createElement(N.a,{value:e.networkType,key:e.networkType},e.networkTypeName)})):null))),i.a.createElement(s.a.Item,{label:"支持协议"},t("supportProtocolType",{rules:[{required:!0,message:"请选择支持协议"}]})(i.a.createElement(p.a,{placeholder:"请选择支持协议"},this.potocolOption(y)))),i.a.createElement(s.a.Item,{label:"通信速率"},t("communicateSpeed",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(l.a,{placeholder:"请输入通信速率",style:{width:"100%"},maxLength:6}))),i.a.createElement(s.a.Item,{label:"数据长度上限"},t("dataLengthLimit",{rules:[{required:!0,message:"请输入通信速率"}]})(i.a.createElement(p.a,{placeholder:"请选择数据长度上限"},this.dataLengthLimitOption(d)))),i.a.createElement(s.a.Item,{label:"绑定场景"},t("bindSceneType",{rules:[{required:!0,message:"请选择绑定场景"}]})(i.a.createElement(p.a,{placeholder:"请选择绑定场景"},this.sceneOptions(h)))),i.a.createElement(s.a.Item,{label:"支持文件传输"},t("supportFileTransfer",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(D.a.Group,null,i.a.createElement(D.a,{value:1},"是"),i.a.createElement(D.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"支持SOC方案"},t("supportSocProject",{rules:[{required:!0,message:"请输入模组型号"}]})(i.a.createElement(D.a.Group,null,i.a.createElement(D.a,{value:1},"是"),i.a.createElement(D.a,{value:0},"否")))),i.a.createElement(s.a.Item,{label:"模组文件",style:{marginBottom:0}}),1===a.supportSocProject?i.a.createElement(s.a.Item,{label:"源码",extra:"（请上传格式为.zip源文件压缩包）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("sourceCode",{rules:[{required:!1,message:"请上传源码"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{beforeUpload:this.sourceCodeBeforeUpload,onChange:this.handleChange.bind(this,"sourceCode"),defaultFileList:a.sourceCode||[],accept:".zip "}),a.sourceCode&&a.sourceCode.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("sourceCodeVersion",{rules:[{required:!1,message:"请输入源码版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,1===a.supportSocProject?i.a.createElement(s.a.Item,{label:"库文件",extra:"（请上传格式为.a的库文件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("libraryFile",{rules:[{required:!1,message:"请上传库文件"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{beforeUpload:this.libraryFileBeforeUpload,onChange:this.handleChange.bind(this,"libraryFile"),defaultFileList:a.libraryFile||[],accept:".a"}),a.libraryFile&&a.libraryFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("libraryFileVersion",{initialValue:a.libraryFileVersion,rules:[{required:!1,message:"请输入库文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))):null,i.a.createElement(s.a.Item,{label:"烧录文件",extra:"（请上传格式为.bin的烧录件）"},i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},t("burnFile",{rules:[{required:!1,message:"请上传烧录文件"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{beforeUpload:this.burnFileBeforeUpload,onChange:this.handleChange.bind(this,"burnFile"),defaultFileList:a.burnFile||[],accept:".bin"}),a.burnFile&&a.burnFile.length>=1?null:n)))),i.a.createElement("span",null,"      "),i.a.createElement(s.a.Item,{style:{display:"inline-block",marginBottom:0}},i.a.createElement("div",null,"版本号：",t("burnFileVersion",{initialValue:a.burnFileVersion,rules:[{required:!1,message:"请输入烧录文件版本号"}]})(i.a.createElement(u.a,{style:{width:162},type:"text",maxLength:10,placeholder:"v1.1.1"}))))),i.a.createElement(s.a.Item,{label:"模组图片",extra:"（请上传格式为.png，小于500k图片）"},t("modulePicture",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{listType:"picture",defaultFileList:a.modulePicture||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"modulePicture")}),a.modulePicture&&a.modulePicture.length>=1?null:i.a.createElement(c.a,null,i.a.createElement(R.a,{type:"upload"})," 上传图片")),i.a.createElement(f.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"参考电路",extra:"（请上传格式为.png，小于500k图片）"},t("referenceCircuitDiagram",{rules:[{required:!1,message:"请上传一张图片"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{listType:"picture",defaultFileList:a.referenceCircuitDiagram||[],onPreview:this.handlePreview,beforeUpload:this.modulePictureBeforeUpload,accept:"image/png",onChange:this.handleChange.bind(this,"referenceCircuitDiagram")}),a.referenceCircuitDiagram&&a.referenceCircuitDiagram.length>=1?null:i.a.createElement(c.a,null,i.a.createElement(R.a,{type:"upload"})," 上传图片")),i.a.createElement(f.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),i.a.createElement(s.a.Item,{label:"说明文档",extra:"（请上传格式为.pdf，大小2M说明文件)"},t("readmePdf",{rules:[{required:!1,message:"请上传文档"}]})(i.a.createElement("div",null,i.a.createElement(L.a,A({},e,{defaultFileList:a.readmePdf||[],beforeUpload:this.referenceCircuitDiagramBeforeUpload,accept:".pdf",onChange:this.handleChange.bind(this,"readmePdf")}),a.readmePdf&&a.readmePdf.length>=1?null:n)))),i.a.createElement(s.a.Item,A({},{labelCol:{span:24},wrapperCol:{span:24}},{style:{textAlign:"center"}}),i.a.createElement(c.a,{className:"functionParmsForms_Next",onClick:this.preClick},"上一步"),i.a.createElement(c.a,{type:"primary",onClick:this.handleSubmit},"提  交"))))}}])&&q(t.prototype,n),r&&q(t,r),o}(o.Component),G=Object(d.b)((function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),networkMethodList:e.getIn(["moduleManager","networkMethodList"]).toJS(),protocolList:e.getIn(["moduleManager","protocolList"]).toJS(),moduleTypeItems:e.getIn(["moduleManager","moduleTypeItems"]).toJS(),bindSceneList:e.getIn(["moduleManager","bindSceneList"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS(),dataLengthLimitList:e.getIn(["moduleManager","dataLengthLimitList"]).toJS()}}),(function(e){return{getAllModuleTypeList:function(t){var n=m.a.getAllModuleTypeList(t);e(n)},socRadioChangeAction:function(t){var n=m.a.socRadioChangeAction(t);e(n)},changeCurApi:function(t,n){var r=m.a.changeCurApi(t,n);e(r)}}}))(s.a.create({name:"FunctionParamsForm",onFieldsChange:function(e,t){if("{}"!==JSON.stringify(t)&&!(Object.keys(t).length>1)){var n=Object.keys(t)[0];if("sourceCode"!==n&&"libraryFile"!==n&&"burnFile"!==n&&"modulePicture"!==n&&"referenceCircuitDiagram"!==n&&"readmePdf"!==n){var r=Object.values(t)[0];e.changeCurApi(n,r.value)}}},mapPropsToFields:function(e){var t=e.moduleInfo,n={};return Object.keys(t).map((function(e){n[e]=s.a.createFormField({value:void 0!==t[e]&&null!==t[e]?t[e]:void 0})})),console.log("props--",n),n}})(W));n(1481);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var a=Z(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=a.a.Step,te=r.a.Meta,ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(u,e);var t,n,c,l=$(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).next=function(){var e=t.state.current+1;t.setState({current:e})},t.prev=function(){var e=t.state.current-1;t.setState({current:e})},t.goBack=function(){t.props.history.goBack()},t.state={current:0},t}return t=u,(n=[{key:"componentWillUnmount",value:function(){this.props.clearModuleInfo({})}},{key:"componentDidMount",value:function(){var e=this.props.brandItems,t=this.props.match.params;if(t&&t.moduleId&&(this.props.getModuleInfo(t.moduleId,"edit"),e&&0===e.length)){var n=this.props,r=n.getBindSceneList,a=n.getAllModuleBrandList,o=n.getModuleTypeMenuAction;a(),r(),o()}}},{key:"getCurStepContent",value:function(){return[{title:"基本参数",content:i.a.createElement(T,{changeCurrent:this.next,goBack:this.goBack})},{title:"功能参数",content:i.a.createElement(G,{changeCurrent:this.prev,goBack:this.goBack})}]}},{key:"render",value:function(){var e=this.getCurStepContent(),t=this.state.current;return i.a.createElement(o.Fragment,null,i.a.createElement(r.a,null,i.a.createElement(te,{title:"添加模组",description:""})),i.a.createElement(r.a,{style:{marginTop:10}},i.a.createElement("div",null,i.a.createElement(a.a,{className:"antd-pro-pages-form-step-form-style-steps",current:t},e.map((function(e){return i.a.createElement(ee,{key:e.title,title:e.title})}))),i.a.createElement("div",{className:"steps-content"},e[t].content))))}}])&&Q(t.prototype,n),c&&Q(t,c),u}(o.Component);t.default=Object(d.b)((function(e){return{brandItems:e.getIn(["moduleManager","brandItems"]).toJS(),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}}),(function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},clearModuleInfo:function(t){var n=m.a.moduleInfoChangeAcion(t);e(n)},getModuleInfo:function(t,n){var r=m.a.getModuleInfo(t,n);e(r)}}}))(ne)},1572:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(35),n(36),n(26),n(27),n(28),n(225);var r=n(86),a=(n(69),n(19)),o=(n(172),n(7)),i=(n(200),n(85)),c=(n(223),n(123)),l=(n(104),n(46)),u=(n(22),n(65),n(389),n(58),n(313),n(0)),s=n.n(u),f=n(1456),p=n(314),d=(n(133),n(113),n(262),n(118)),m=(n(103),n(48)),y=(n(1417),n(1418)),h=(n(157),n(37)),b=(n(132),n(23));n(112),n(122);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k,P=b.a.Item,x=h.a.Option,T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(i,e);var t,n,r,o=j(i);function i(){var e;w(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).handleFilterSubmit=function(){var t=e.props.form.getFieldsValue();e.props.filterSubmit(t)},e.reset=function(){e.props.form.resetFields()},e.getOptionList=function(e){if(!e)return[];var t=[];return e.map((function(e){t.push(s.a.createElement(x,{value:e.id,key:e.id},e.name))})),t},e.initFormList=function(){var t=e.props.form.getFieldDecorator,n=e.props.formList,r=[];return n&&n.length>0&&n.forEach((function(n,o){var i=n.label,c=n.field||"",l=n.initialValue||void 0,u=n.placeholder,f=n.width||120,p=n.onSelect,b=n.resetFields;if("DatePicker"===n.type){var v=s.a.createElement(P,{label:i,key:c},t(c)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));r.push(v);var E=s.a.createElement(P,{label:"~",colon:!1,key:c},t(c)(s.a.createElement(y.a,{showTime:!0,placeholder:u,format:"YYYY-MM-DD HH:mm:ss"})));r.push(E)}else if("Input"===n.type){var w=s.a.createElement(P,{label:i,key:c},t(c,{initialValue:l})(s.a.createElement(m.a,{style:{width:f},type:"text",placeholder:u,maxLength:20})));r.push(w)}else if("Select"===n.type){var O=s.a.createElement(P,{label:i,key:c},t(c,{initialValue:l})(s.a.createElement(h.a,{className:c,style:{width:f,marginBottom:0},placeholder:u,onChange:function(t){n.resetFields&&e.props.form.resetFields(g(b)),p&&p(t)}},e.getOptionList(n.list))));r.push(O)}else if("Checkbox"===n.type){var I=s.a.createElement(P,{label:i,key:c},t(c,{valuePropName:"checked",initialValue:l})(s.a.createElement(d.a,null,i)));r.push(I)}else if("Button"===n.type){var j=s.a.createElement(P,{key:c},s.a.createElement(a.a,{type:"primary",onClick:p},i));r.push(j)}})),r},e}return t=i,(n=[{key:"render",value:function(){var e=this.props.node;return s.a.createElement(b.a,{layout:"inline"},this.initFormList(),s.a.createElement(P,null,s.a.createElement(a.a,{type:"primary",onClick:this.handleFilterSubmit},"查询")),s.a.createElement(P,null,s.a.createElement(a.a,{onClick:this.reset},"重置")),s.a.createElement(P,null,e))}}])&&O(t.prototype,n),r&&O(t,r),i}(s.a.Component),L=b.a.create({})(T),D=(n(849),n(493)),N=(n(391),n(142),n(40)),R=(n(1469),n(33));function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function B(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var a=J(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return K(this,n)}}function K(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W=b.a.Item,G=h.a.Option,H=Object(N.withRouter)(k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(u,e);var t,n,r,l=z(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).categorySelect=function(e){t.setState({categoryId:e,subCategoryList:[]});t.props.form.resetFields([].concat(["subCategoryId","deviceTypeId"]));var n=t.props.allCategoryList,r=n.findIndex((function(t){return e===t.id}));if(r>-1){var a=n[r];t.setState({subCategoryList:t.makeFormData(a.subCategoryList,"subCategoryName","subCategoryId")})}},t.subCategorySelect=function(e){t.setState({subCategoryId:e,deviceTypeList:[]}),t.props.form.resetFields("deviceTypeId");var n=t.state.subCategoryList,r=n.findIndex((function(t){return e===t.id}));if(r>-1){var a=n[r];t.setState({deviceTypeList:t.makeFormData(a.deviceTypeList,"deviceTypeName","deviceTypeId")})}},t.threeCategorySelect=function(e){var n=t.state.deviceTypeList,r=n.findIndex((function(t){return e===t.id}));if(r>-1){var a=n[r];console.log("三级菜单选择后：",a);var o=e,i=a.defaultDeviceSubtype.deviceSubtypeId;t.setState({deviceTypeId:o,deviceSubtypeId:i}),console.log("三级菜单选择后：deviceSubtypeId ===",i)}t.getProtocol(e)},t.makeFormData=function(e,t,n){var r=[];return console.log("data ===",e),e.map((function(e){var a=F(F({},e),{},{id:e[n],name:e[t]});r.push(a)})),r},t.getProtocol=function(e){var n={deviceTypeId:e};Object(p.f)(n).then((function(e){var n=e.data;0===n.code&&t.setState({protocoloList:t.makeFormData(n.data,"templateName","templateNumber")})}))},t.handleChange=function(e){console.log("----info.file---",e.file),"error"===e.file.status?(c.a.error("".concat(e.file.name," 上传失败")),e.fileList.length=e.fileList.length-1):void 0===e.file.status&&(e.fileList.length=e.fileList.length-1),t.setState({fileList:e.fileList})},t.showModal=function(){t.setState({visible:!0,iconLoading:!1})},t.handleOk=function(e){var n=t.state,r=n.fileList,a=n.deviceTypeId,o=n.deviceSubtypeId,i={};r.length<=0?c.a.warning("请上传模板图片!"):(r.map((function(e,t){"done"===e.status&&(i["page".concat(t+1)]=e.response.data.url)})),t.props.form.validateFields((function(e,n){if(!e){n.status=0,delete n.templatePicList,delete n.categoryId,delete n.subCategoryId,Object.assign(n,i);var r=F(F(F({},n),i),{},{deviceTypeId:a,deviceSubtypeId:o});t.setState({iconLoading:!0}),Object(f.e)(r).then((function(e){var n=e.data;if(0===n.code){t.setState({visible:!1,iconLoading:!1});var r=n.data.templateId;c.a.success("恭喜您，模板已创建成功！我们将进入自助接入系统",3,t.handleMessageClose(r))}})).finally((function(){t.setState((function(){return{iconLoading:!1}}))}))}})))},t.handlePreview=function(){var e,n=(e=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.url||n.preview){e.next=4;break}return e.next=3,t.getBase64(n.originFileObj);case 3:n.preview=e.sent;case 4:t.setState({previewImage:n.url||n.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){B(o,r,a,i,c,"next",e)}function c(e){B(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),t.getBase64=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},t.handleMessageClose=function(e){var t=window.location.host,n="",r="";"cms.clife.cn"===t?(n="open.clife.cn",r=""):"pre.cms.clife.cn"===t?(n="pre.cms.clife.cn",r="/pre-wCloud-v2"):(n="dp.clife.net",r="/wCloud_v2");var a="https://"+n+r+"/app-developer/page/playground.html#/develop/edit/"+e+"?platform=1&operate=edit";window.open(a,"_self")},t.handleCancel=function(e){t.setState({visible:!1,fileList:[]}),t.props.form.resetFields("templatePicList"),t.props.form.resetFields()},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.textareaChange=function(e){e.target.value.length>=500&&c.a.warning("最大支持输入500个字符",1)},t.getOptionList=function(e){if(!e)return[];var t=[];return e.map((function(e){t.push(s.a.createElement(G,{value:e.id,key:e.id},e.name))})),t},t.state={fileList:[],visible:!1,previewVisible:!1,previewImage:"",subCategoryList:[],deviceTypeList:[],protocoloList:[],categoryId:"",subCategoryId:"",deviceTypeId:"",deviceSubtypeId:""},t}return t=u,(n=[{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||c.a.error("只能上传JPG或者PNG格式");var n=e.size/1024/1024<=.5;return n||c.a.error("图片必须小于500KB!"),t&&n}},{key:"render",value:function(){var e={action:R.j,data:function(e){return{appId:31438,domainType:4}}},t=this.props,n=t.form,r=t.allCategoryList,c=n.getFieldDecorator,l=s.a.createElement("div",null,s.a.createElement(o.a,{type:"plus"}),s.a.createElement("div",{className:"ant-upload-text"},"Upload")),u=this.state,f=u.subCategoryList,p=u.deviceTypeList,d=u.protocoloList;return u.fileList,s.a.createElement("div",null,s.a.createElement(a.a,{type:"primary",onClick:this.showModal},"新建H5模板"),s.a.createElement(i.a,{width:800,title:"新建H5模板",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,cancelText:"取消",okText:"创建",confirmLoading:this.state.iconLoading,destroyOnClose:!0},s.a.createElement(b.a,M({},{labelCol:{span:6},wrapperCol:{span:15}},{className:"CreataH5Template_from"}),s.a.createElement(W,{label:"模板名称"},c("templateName",{rules:[{required:!0,message:"模板名称不能为空"}]})(s.a.createElement(m.a,{allowClear:!0,type:"text",placeholder:"请输入您喜欢的模板名称",maxLength:20}))),s.a.createElement(b.a.Item,{className:"chooseProduct",label:"所属分类"},s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("categoryId",{rules:[{required:!0,message:"请您选择一级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"一级类目",onChange:this.categorySelect},this.getOptionList(r)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("subCategoryId",{rules:[{required:!0,message:"请您选择二级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"二级类目",onChange:this.subCategorySelect},this.getOptionList(f)))),s.a.createElement("span",null," "),s.a.createElement(b.a.Item,{style:{display:"inline-block",width:"calc(35% - 12px)"}}," ",c("deviceTypeId",{rules:[{required:!0,message:"请您选择三级类目"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"三级类目",onChange:this.threeCategorySelect},this.getOptionList(p))))),s.a.createElement(W,{label:"调取协议"}," ",c("templateNumber",{rules:[{required:!0,message:"请您选择协议"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择协议"},this.getOptionList(d)))),s.a.createElement(W,{label:"性质"},c("isFree",{rules:[{required:!0,message:"请您选择性质"}]})(s.a.createElement(h.a,{style:{width:150},placeholder:"请选择"},s.a.createElement(G,{value:"1"},"免费")))),s.a.createElement(W,{label:"模板图片",extra:"格式:jpg/png    大小:500k以内"},c("templatePicList",{rules:[{required:!0,message:"请上传一张图片"}]})(s.a.createElement("div",{className:"product-div"},s.a.createElement(D.a,M({},e,{accept:"image/png,image/jpeg",listType:"picture-card",className:"avatar-uploader product-uploader",beforeUpload:this.beforeUpload,onChange:this.handleChange,defaultFileList:this.state.fileList,onPreview:this.handlePreview}),this.state.fileList.length>=5?null:l),s.a.createElement(i.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},s.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))))),s.a.createElement(W,{label:"描述"},c("remark",{})(s.a.createElement(m.a.TextArea,{onChange:this.textareaChange,maxLength:500,rows:3,placeholder:"请您输入模板的描述内容"}))))))}}])&&V(t.prototype,n),r&&V(t,r),u}(u.Component))||k,Q=b.a.create()(H),Y=(n(1482),n(97));function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oe(e);if(t){var a=oe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ae(this,n)}}function ae(e,t){if(t&&("object"===$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=l.a.Meta,ce=[{title:"模板信息",icon:"info",status:0,key:0},{title:"编辑",icon:"edit",status:0,key:1},{title:"发布",icon:"cloud-upload",status:0,key:2},{title:"删除",icon:"delete",status:0,key:3}],le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(m,e);var t,n,u,d=re(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e)).getH5TemplateList=function(e){t.setState({loading:!0,oldParams:e}),Object(f.d)(e).then((function(e){var n=e.data;0===n.code&&t.setState((function(){return{h5TemplateList:t.makeAntTableData(n.data),pager:n.data.pager}}))})).finally((function(){t.setState((function(){return{loading:!1}}))}))},t.getAllCategoryList=function(){Object(p.a)().then((function(e){var n=e.data;0===n.code&&t.setState({allCategoryList:t.makeFormData(n.data,"categoryName","categoryId")})}))},t.h5Publish=function(e){Object(f.b)({templateId:e.templateId,status:e.status?0:1}).then((function(n){if(0===n.data.code){var r=e.status?"撤销成功！":"发布模板成功！";c.a.success(r,2).then(t.getH5TemplateList(t.state.oldParams))}}))},t.h5Del=function(e){Object(f.a)({templateId:e.templateId}).then((function(e){if(0===e.data.code){c.a.success("删除模板成功！",2).then(t.getH5TemplateList(t.state.oldParams))}}))},t.editTemplate=function(e){if(1!==e.status){var n=window.location.host;console.log(t.props);var r="",a="";"cms.clife.cn"===n?(r="open.clife.cn",a=""):"pre.cms.clife.cn"===n?(r="pre.cms.clife.cn",a="/pre-wCloud-v2"):(r="dp.clife.net",a="/wCloud_v2");var o="https://"+r+a+"/app-developer/page/playground.html#/develop/edit/"+e.templateId+"?platform=1&operate=edit";window.open(o,"_self")}else c.a.warning('对不起！模板"'+e.templateName+'" 是发布状态，禁止编辑',3)},t.makeFormData=function(e,t,n){var r=[];return e.map((function(e){var a=Z(Z({},e),{},{id:e[n],name:e[t]});r.push(a)})),r},t.categorySelect=function(e){t.setState({categoryId:e,subCategoryList:[]});var n=t.state.allCategoryList,r=n.findIndex((function(t){return e===t.id}));if(r>-1){var a=n[r];console.log("一级菜单选择后：",a),t.setState({subCategoryList:t.makeFormData(a.subCategoryList,"subCategoryName","subCategoryId")})}},t.subCategorySelect=function(e){t.setState({subCategoryId:e,deviceTypeList:[]});var n=t.state.subCategoryList,r=n.findIndex((function(t){return e===t.id}));if(r>-1){var a=n[r];console.log("二级菜单选择后：",a),t.setState({deviceTypeList:t.makeFormData(a.deviceTypeList,"deviceTypeName","deviceTypeId")})}},t.handleDelete=function(e,n){switch(n.key){case 0:t.props.history.push({pathname:"/config/h5template/info/".concat(e.templateId)});break;case 1:t.editTemplate(e);break;case 2:i.a.confirm({title:"确认",okText:"确定",cancelText:"取消",content:e.status?"点击确定将模板从模板市场撤销发布并保存为草稿":"点击确定后将同步到模板市场并对用户可见，点击取消可取消发布。",onOk:function(){t.h5Publish(e)}});break;case 3:i.a.confirm({title:"确认",okText:"确定",okType:"danger",cancelText:"取消",content:e.status?"点击确定将从模板管理页面删除模板，点击取消返回。":"点击确定将模板从模板管理页面和模板市场同时删除，点击取消返回",onOk:function(){t.h5Del(e)}})}},t.filterSubmit=function(e){var n=Z(Z({},t.state.oldParams),{},{deviceTypeId:e.deviceTypeId,status:e.status,nature:e.nature,templateName:e.templateName});for(var r in n){if(n.hasOwnProperty(r))n[r]||delete n[r]}t.getH5TemplateList(n)},t.paginationChange=function(e){console.log("分页选择了：",e);var n=Z(Z({},t.state.oldParams),{},{pageIndex:e});console.log(n),t.getH5TemplateList(n),document.querySelector(".ant-table-body").scrollTop=0},t.makeAntTableData=function(e){var t=[];return e.list.map((function(e,n){t.push(Z(Z({},e),{},{key:e.templateId}))})),t},t.state={h5TemplateList:[],loading:!1,oldParams:{},allCategoryList:[],subCategoryList:[],deviceTypeList:[],categoryId:"",subCategoryId:"",pager:{}},t}return t=m,(n=[{key:"componentWillMount",value:function(){this.getH5TemplateList({pageRows:10,sort:"modifyTime",order:"desc"}),this.getAllCategoryList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.allCategoryList,i=t.subCategoryList,c=t.deviceTypeList,u=(t.pagination,t.loading),f=t.h5TemplateList,p=t.pager,d=[{type:"Input",label:"关键字",field:"templateName",placeholder:"请输入模板名称",width:260},{type:"Select",label:"所属分类",field:"categoryId",placeholder:"一级类目",list:n,onSelect:this.categorySelect,resetFields:["subCategoryId","deviceTypeId"],width:140},{type:"Select",label:"",field:"subCategoryId",placeholder:"二级类目",list:i,onSelect:this.subCategorySelect,resetFields:["deviceTypeId"],width:140},{type:"Select",label:"",field:"deviceTypeId",placeholder:"三级类目",list:c,width:140},{type:"Select",label:"状态",field:"status",placeholder:"请选择",list:[{id:"0",name:"未发布"},{id:"1",name:"已发布"}],width:140},{type:"Select",label:"性质",field:"nature",placeholder:"请选择",list:[{id:"1",name:"免费"}],width:140}],m=[{title:"模板名称-CN",width:"15%",key:"templateName",dataIndex:"templateName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"所属分类",width:"15%",key:"allCategoryName",dataIndex:"allCategoryName",render:function(e){return s.a.createElement("span",{title:e},e)}},{title:"二维码",width:"8%",key:"qrcode",dataIndex:"qrcode",render:function(e){var t=e?s.a.createElement("img",{className:"codeimg",src:e}):"二维码生成中";return s.a.createElement("div",{className:"td-qrcode"},s.a.createElement(o.a,{type:"barcode",className:"s-qrcode"}),s.a.createElement("div",{className:"hovershow"},s.a.createElement("span",{className:"leftarrow"}),t))}},{title:"性质",width:"80px",key:"isFree",dataIndex:"isFree",render:function(e){return 1===e?"免费":""}},{title:"状态",width:"80px",key:"status",dataIndex:"status",render:function(e){var t=1===e?"已发布":"未发布";return s.a.createElement("span",{title:t,style:{color:"".concat(["red","gray"][e])}},t)}},{title:"更新时间",width:"12%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=R.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return s.a.createElement("span",{title:t},t)}},{title:"操作",width:"13%",key:"operation",dataIndex:"operation",render:function(t,n){return s.a.createElement("div",null,ce.map((function(t,o){return s.a.createElement(r.a,{key:o,placement:"top",title:2===t.key&&1===n.status?"下线":t.title},s.a.createElement(a.a,{style:{marginLeft:"5px"},shape:"circle",size:"small",icon:2===t.key&&1===n.status?"cloud-download":t.icon,key:n.templateId,onClick:function(){return e.handleDelete(n,t)}}))})))}}];return s.a.createElement("div",{className:"H5TemplateContent"},s.a.createElement(l.a,null,s.a.createElement(ie,{title:"H5模板",description:"",style:{marginBottom:10}}),s.a.createElement(L,{formList:d,filterSubmit:this.filterSubmit,node:s.a.createElement(Q,{allCategoryList:n})})),s.a.createElement(l.a,{className:"H5TemplateTable"},s.a.createElement(Y.a,{rowKey:"id",bordered:!0,columns:m,dataSource:f,pager:p,onPageChange:this.paginationChange,loading:u})))}}])&&te(t.prototype,n),u&&te(t,u),m}(u.Component);t.default=le},1582:function(e,t,n){"use strict";n.r(t);n(104);var r=n(46),a=(n(112),n(133),n(27),n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(28),n(0)),o=n.n(a),i=n(45),c=(n(1477),n(122),n(1432),n(58),function(e){var t=e.list,n=e.type,r=e.active,a=e.name,i=e.id,c=e.onChange,l=e.sub;if(0==t.length)return null;var u=t.reduce((function(e,t){return e[a].length>t[a].length?e:t}),t[0]);return o.a.createElement("div",{style:{display:"block",position:"relative",minWidth:"1200px"}},o.a.createElement("div",{className:"list-category",style:{height:"".concat("top"==n?36*u[a].length:36*u[a].length+40,"px")}},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,"top"!==n?o.a.createElement("span",{className:"line-horizontal"}):null,t.map((function(e,t){return o.a.createElement("div",{className:"list-item ".concat(t==r&&l&&l.length>0?"active":""),onClick:function(){return"function"==typeof c?c(t):null},key:t},"top"!==n?o.a.createElement("span",{className:"line-vertical"}):null,o.a.createElement("div",{className:"list-name"},o.a.createElement("span",null,"".concat(e[a]),o.a.createElement("br",null),o.a.createElement("b",{className:"list-num"},"(",e[i],")"))))})),void 0!==r&&l&&l.length>0?o.a.createElement("span",{className:"line-horizontal bottom ".concat(r>=t.length/2?"left":"right"),style:{width:56*Math.abs((t.length+1)/2-r-1)}}):null))});function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var a=h(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(l,e);var t,n,a,i=d(l);function l(){var e;s(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=i.call.apply(i,[this].concat(n))).state={first:0,second:0},e.changeState=function(t){var n=y(e);return function(e){console.log(e),"first"==t&&n.setState({second:0}),n.setState(u({},t,e))}},e}return t=l,(n=[{key:"render",value:function(){var e=this.state,t=e.first,n=e.second,a=this.props.allCategoryList,i=Array.from(a)||[],l=i[t]&&i[t].subCategoryList||[],u=l[n]&&l[n].deviceTypeList||[];return o.a.createElement("div",null,o.a.createElement(r.a,null,o.a.createElement(r.a.Meta,{title:"产品类目",description:"硬件产品的形态分类，开放平台接入产品，终端APP绑定设备时可获取类目数据。"})),o.a.createElement("div",{className:"product-categroy"},o.a.createElement("div",{style:{display:"inline-block"}},o.a.createElement(c,{type:"top",list:i,sub:l,active:t,name:"categoryName",id:"categoryId",onChange:this.changeState("first")}),o.a.createElement(c,{list:l,sub:u,active:n,name:"subCategoryName",id:"subCategoryId",onChange:this.changeState("second")}),o.a.createElement(c,{list:u,name:"deviceTypeName",id:"deviceTypeId"}))))}}])&&f(t.prototype,n),a&&f(t,a),l}(o.a.Component);t.default=Object(i.b)((function(e){return{allCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"])}}))(b)},1583:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(35),n(36),n(26),n(27),n(28),n(132);var r=n(23),a=(n(103),n(48)),o=(n(225),n(86)),i=(n(69),n(19)),c=(n(200),n(85)),l=(n(104),n(46)),u=(n(157),n(37)),s=(n(22),n(65),n(389),n(58),n(0)),f=n.n(s),p=n(40),d=n(45),m=n(504),y=n(33),h=n(217),b=(n(308),n(160)),v=(n(312),n(71));n(1478);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var a=j(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(o,e);var t,n,r,a=O(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).handleCancel=function(){t.props.viewModuleInfoCancle(!1)},t.handlePreview=function(){var e=t.props.moduleInfo;t.setState({previewImage:e.historyObj.referenceCircuitDiagram,previewVisible:!0})},t.handleCancelPreview=function(){t.setState({previewVisible:!1})},t.getDataSource=function(e){return 0===e.supportSocProject?[{key:"1",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]:[{key:"1",fileType:"源码",fileName:e.sourceCodeName,version:""+e.sourceCodeVersion,fileUrl:e.historyObj.sourceCode},{key:"2",fileType:"库文件",fileName:e.libraryFileName,version:""+e.libraryFileVersion,fileUrl:e.historyObj.libraryFile},{key:"3",fileType:"烧录文件",fileName:e.burnFileName,version:""+e.burnFileVersion,fileUrl:e.historyObj.burnFile}]},t.state={previewVisible:!1,previewImage:""},t}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.moduleInfo,r=[{title:"模板文件",key:"fileType",dataIndex:"fileType"},{title:"文件名",key:"fileName",dataIndex:"fileName",render:function(e,t){return console.log("=====",t),f.a.createElement("a",{href:t.fileUrl,target:"_blank"},e)}},{title:"版本号",key:"version",dataIndex:"version"}],a=this.getDataSource(n);return f.a.createElement("div",null,f.a.createElement(c.a,{style:{top:20},width:800,title:"查看模组",visible:t,onCancel:this.handleCancel,footer:this.state.status?[f.a.createElement(i.a,{key:"back",onClick:this.handleCancel},"取消"),f.a.createElement(i.a,{key:"submit",type:"primary",onClick:this.handleOk},"确定")]:null},f.a.createElement(v.a,{title:"基础信息",size:"small"},f.a.createElement(v.a.Item,{label:"生产厂家",span:2},n.brandName),f.a.createElement(v.a.Item,{label:"模组所属库",span:2},n.moduleAffiliation),f.a.createElement(v.a.Item,{label:"模组型号",span:2},n.hetModuleTypeName),f.a.createElement(v.a.Item,{label:"模组IC型号",span:2},n.originalModuleTypeName),f.a.createElement(v.a.Item,{label:"使用范围",span:2},n.applyScope)),f.a.createElement(v.a,{title:"审核内容",size:"small"},f.a.createElement(v.a.Item,{label:"通信方式",span:2},n.moduleTypeNameList),f.a.createElement(v.a.Item,{label:"配网方式",span:2},n.networkTypeNameList),f.a.createElement(v.a.Item,{label:"支持协议",span:2},n.supportProtocolTypeName),f.a.createElement(v.a.Item,{label:"支持文件传输",span:2},0===n.supportFileTransfer?"否":"是"),f.a.createElement(v.a.Item,{label:"通信速率",span:2},n.communicateSpeed),f.a.createElement(v.a.Item,{label:"支持SOC方案",span:2},0===n.supportSocProject?"否":"是"),f.a.createElement(v.a.Item,{label:"数据上限",span:4},n.dataLengthLimitName)),f.a.createElement(v.a.Item,null,f.a.createElement(b.a,{bordered:!0,columns:r,dataSource:a,size:"small",pagination:!1})),f.a.createElement(v.a,{title:"说明文档",size:"small",style:{marginTop:10}},f.a.createElement(v.a.Item,{label:"参考电路",span:4},f.a.createElement("div",{className:"ReferenceCircuitPic",style:{background:"url("+n.historyObj.referenceCircuitDiagram+") no-repeat center / contain",border:"1px solid #1890ff"},onClick:this.handlePreview}," "),f.a.createElement(c.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancelPreview},f.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage}))),f.a.createElement(v.a.Item,{label:"说明文档",span:4},f.a.createElement("a",{href:n.historyObj.readmePdf,target:"_blank"},n.readmePdfName)))))}}])&&E(t.prototype,n),r&&E(t,r),o}(s.Component),k=(n(1479),n(97));function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M(e);if(t){var a=M(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=u.a.Option,A=l.a.Meta,F=c.a.confirm,q=Object(p.withRouter)(S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(d,e);var t,n,c,p=R(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=p.call(this,e)).getModuleList=function(e){t.setState({loading:!0,oldparams:e}),Object(h.h)(e).then((function(e){if(0===e.data.code){var n=e.data.data.list;n.map((function(e,t){e.key=e.moduleId}));var r=y.e.pagination(e.data.data.pager,t.paginationChange);t.setState((function(){return{moduleList:n,pagination:r,pager:e.data.data.pager}}))}})).finally((function(){t.setState((function(){return{loading:!1}}))}))},t.generateOptions=function(e){if(e)return e.map((function(e,t){return f.a.createElement(B,{value:e.moduleType,key:e.moduleType},e.moduleTypeName)}))},t.searchClick=function(){var e=t.state.oldparams;t.props.form.validateFields((function(n,r){var a=T(T(T({},e),r),{},{pageIndex:1});t.getModuleList(a)}))},t.addModule=function(){t.props.history.push({pathname:"/config/ModuleManager/add/"})},t.reset=function(){t.props.form.resetFields()},t.releaseOperation=function(e,n){Object(h.i)(e,n).then((function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}}))},t.deleteOperation=function(e){Object(h.e)(e).then((function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}}))},t.OfflineOperataion=function(e,n){Object(h.i)(e,n).then((function(e){if(0===e.data.code){var n=t.state.oldparams;t.getModuleList(n)}}))},t.generateOperationBtn=function(e){return 1===e.releaseStatus?t.releaseBtnArr().map((function(n,r){return t.createOperationBtn(n,e)})):t.unReleaseBtnArr().map((function(n,r){return t.createOperationBtn(n,e)}))},t.createOperationBtn=function(e,n){return f.a.createElement(o.a,{key:e.key,placement:"top",title:e.title},f.a.createElement(i.a,{style:{marginLeft:"10px"},shape:"circle",size:"small",icon:e.icon,key:e.templateId,onClick:function(){return t.handleOperation(e,n)}}))},t.releaseBtnArr=function(){return[{title:"查看",icon:"info",key:"View"},{title:"下线",icon:"cloud-download",key:"Offline"}]},t.unReleaseBtnArr=function(){return[{title:"发布",icon:"cloud-upload",key:"release"},{title:"编辑",icon:"edit",key:"edit"},{title:"删除",icon:"delete",key:"delete"}]},t.paginationChange=function(e){t.setState({pageIndex:e}),console.log("分页选择了：",e);var n=T(T({},t.state.oldparams),{},{pageIndex:e});t.getModuleList(n)},t.handleOperation=function(e,n){switch(e.key){case"View":t.props.getModuleInfoPreview(n.moduleId,"view");break;case"Offline":F({title:"下线模组?",content:"确认下线后，模组将同步从开放平台下线，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.OfflineOperataion(n.moduleId,0)},onCancel:function(){}});break;case"release":console.log(n.completeStatus),0===n.completeStatus?F({title:"发布模组",content:"当前模组信息不完整，请完善后提交发布",okText:"确定",cancelText:"取消",onOk:function(){},onCancel:function(){}}):F({title:"发布模组",content:"确认发布后，模组信息将会同步到开放平台,确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.releaseOperation(n.moduleId,1)},onCancel:function(){}});break;case"edit":var r=n.moduleId;t.props.history.push({pathname:"/config/ModuleManager/edit/".concat(r)});break;case"delete":F({title:"删除模组",content:"删除后，模组信息将同步删除，无法撤销，确定要这样做吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.deleteOperation(n.moduleId)},onCancel:function(){}})}},t.state={moduleList:[],loading:!1,pagination:{},oldparams:{},pager:{}},t}return t=d,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.getBindSceneList,n=e.getAllModuleBrandList,r=e.getModuleTypeMenuAction;this.getModuleList({pageIndex:1,moduleType:"",hetModuleTypeName:"",pageRows:10}),n(),t(),r()}},{key:"render",value:function(){var e=this,t=[{title:"模组型号",width:"15%",key:"hetModuleTypeName",dataIndex:"hetModuleTypeName",render:function(e){return f.a.createElement("span",{title:e},e)}},{title:"支持通信",width:"15%",key:"moduleTypeList",dataIndex:"moduleTypeList",render:function(e){return f.a.createElement("span",{title:e},e)}},{title:"生产厂商",width:"15%",key:"brandName",dataIndex:"brandName"},{title:"状态",width:"65px",key:"releaseStatus",dataIndex:"releaseStatus",render:function(e){return f.a.createElement("span",{style:{color:"".concat(["green","gray"][e])}},1===e?"已发布":"草稿")}},{title:"更新时间",width:"15%",key:"modifyTime",dataIndex:"modifyTime",render:function(e){var t=y.b.formateDate(e,"yyyy-MM-dd hh:mm:ss");return f.a.createElement("span",{title:t},t)}},{title:"操作",width:"120px",key:"operation",dataIndex:"operation",render:function(t,n){return f.a.createElement("div",null,e.generateOperationBtn(n))}}],n=this.state,o=n.moduleList,c=n.loading,p=(n.pagination,n.pager),d=this.props,m=d.moduleInfo,h=d.visible,b=d.communicationMethodList,v=d.visibleChangeAcion,g=this.props.form.getFieldDecorator;return f.a.createElement(s.Fragment,null,f.a.createElement(l.a,null,f.a.createElement(C,{visible:h,moduleInfo:m,viewModuleInfoCancle:v}),f.a.createElement(A,{title:"模组管理",description:"",style:{marginBottom:10,fontSize:20}}),f.a.createElement(r.a,{layout:"inline",onSubmit:this.handleSubmit},f.a.createElement(r.a.Item,{label:"关键字"},g("hetModuleTypeName",{})(f.a.createElement(a.a,{placeholder:"请输入生产厂商或模组型号",style:{width:260},maxLength:20}))),f.a.createElement(r.a.Item,{label:"通信方式"},g("moduleType",{initialValue:void 0})(f.a.createElement(u.a,{style:{width:140,marginBottom:0},placeholder:"请选择通信方式"},this.generateOptions(b)))),f.a.createElement(r.a.Item,null,f.a.createElement(i.a,{type:"primary",onClick:this.searchClick},"查询")),f.a.createElement(r.a.Item,null,f.a.createElement(i.a,{type:"default",onClick:this.reset},"重置")),f.a.createElement(r.a.Item,null,f.a.createElement(i.a,{type:"primary",onClick:this.addModule},"添加模组")))),f.a.createElement(l.a,{className:"ModuleManagerListTable",style:{marginTop:10}},f.a.createElement(k.a,{rowKey:"id",bordered:!0,columns:t,dataSource:o,pager:p,onPageChange:this.paginationChange,loading:c})))}}])&&D(t.prototype,n),c&&D(t,c),d}(s.Component))||S;t.default=Object(d.b)((function(e){return{communicationMethodList:e.getIn(["moduleManager","communicationMethodList"]).toJS(),visible:e.getIn(["moduleManager","visible"]),moduleInfo:e.getIn(["moduleManager","moduleInfo"]).toJS()}}),(function(e){return{getAllModuleBrandList:function(){var t=m.a.getAllModuleBrandList();e(t)},getBindSceneList:function(){var t=m.a.getBindSceneList();e(t)},visibleChangeAcion:function(t){var n=m.a.visibleChangeAcion(t);e(n);var r=m.a.moduleInfoChangeAcion({});e(r)},getModuleTypeMenuAction:function(t){var n=m.a.getModuleTypeMenuAction(t);e(n)},getModuleInfoPreview:function(t){var n=m.a.getModuleInfoPreviewAction(t);e(n)}}}))(r.a.create({})(q))},1584:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(18),n(35),n(22),n(36),n(26),n(27),n(28),n(104);var r,a=n(46),o=(n(225),n(86)),i=(n(69),n(19)),c=(n(142),n(0)),l=n.n(c),u=n(45),s=(n(103),n(48)),f=(n(870),n(499)),p=(n(132),n(23)),d=(n(157),n(37)),m=n(1),y=n.n(m),h=n(314),b=n(9);n(1461);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var a=I(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}d.a.Option;var j=Object(u.b)((function(e){var t=e.getIn(["globalDeviceInfo","deviceType"]);return{deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceType:t,deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}}))(r=p.a.create({name:"horizontal_pannel"})(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(o,e);var t,n,r,a=w(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).state={deviceSubType:[]},t}return t=o,(n=[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e,n){if(!e){console.log(n);var r=n.deviceTypeSelect,a=n.templateName;if(r&&3==r.length){var o=r[2];t.props.filterPannelOperation({deviceTypeId:o,templateName:a})}else t.props.filterPannelOperation({templateName:a})}}))}},{key:"deviceTypeSelect",value:function(e){var t=this;Object(h.c)({deviceTypeId:e}).then((function(e){if(e.data.code===b.a){var n=e.data.data;t.props.form.resetFields(["deviceSubType"]),t.setState({deviceSubType:n})}}))}},{key:"deviceSubTypeSelect",value:function(e){console.log("deviceSubTypeSelect: "+e)}},{key:"resetContent",value:function(){this.props.form.resetFields(),this.props.filterPannelOperation({deviceTypeId:void 0})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=(this.props.deviceCategoryList,this.props.deviceCascaderList);return l.a.createElement("div",null,l.a.createElement(p.a,{layout:"inline",onSubmit:this.handleSubmit.bind(this)},l.a.createElement(p.a.Item,{label:"所属分类"},e("deviceTypeSelect")(l.a.createElement(f.a,{options:t,placeholder:"请选择所属分类",style:{width:260}}))),l.a.createElement(p.a.Item,{label:"模板名称"},e("templateName")(l.a.createElement(s.a,{type:"text",onChange:this.handleNumberChange,style:{width:200},placeholder:"输入模板名称"}))),l.a.createElement(p.a.Item,null,l.a.createElement(i.a,{type:"primary",htmlType:"submit"},"查询"),l.a.createElement("span",null," "),l.a.createElement(i.a,{type:"primary",onClick:this.resetContent.bind(this)},"重置"))))}}])&&g(t.prototype,n),r&&g(t,r),o}(c.Component))||r)||r;j.prototype={filterPannelOperation:y.a.func};var S,C=j,k=n(1470),P=n(33),x=n(40),T=n(97);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var a=B(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=Object(x.withRouter)(S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(u,e);var t,n,r,c=R(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).tableColumn=[{title:"模板ID",dataIndex:"protocolTemplateId",key:"protocolTemplateId",width:"75px"},{title:"模板名称",dataIndex:"templateName",key:"templateName",width:"20%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"语言版本",dataIndex:"language",key:"language",width:"9%",render:function(e){return l.a.createElement("span",null,0===e?"中文":"英文")}},{title:"所属分类",dataIndex:"allCategoryName",key:"allCategoryName",width:"28%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"状态",dataIndex:"templateStatus",key:"templateStatus",width:"10%",render:function(e){return l.a.createElement("span",null,1===e?"正式":"草稿")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"15%",render:function(e){var t=P.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return l.a.createElement("span",{title:t,className:"td-break"},t)}},{title:"修改时间",dataIndex:"updateTime",key:"updateTime",width:"15%",render:function(e){var t=P.b.utc2beijing(e,"yyyy-MM-dd hh:mm:ss");return l.a.createElement("span",{className:"td-break",title:t},t)}},{title:"操作",dataIndex:"templateNumber",key:"operation",width:"100px",fixed:"right",render:function(e){return l.a.createElement(o.a,{placement:"top",title:"编辑"},l.a.createElement(i.a,{onClick:t.editProtocolTemp.bind(M(t),e),icon:"edit",shape:"circle",size:"small"}))}}],t.state={tableDataSources:[],pageRows:10,currentPage:0,totalRows:0,isLoading:!1,searchParams:{},pager:{}},t}return t=u,(n=[{key:"componentDidMount",value:function(){this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:this.state.currentPage})}},{key:"getProtocolTemplateList",value:function(e){var t=this;this.setState({isLoading:!0}),e=Object.assign({},this.state.searchParams,e),e=P.d.filterParam(e),Object(k.c)(e).then((function(e){if(t.setState({isLoading:!1}),e.data.code===b.a){var n=e.data.data.list,r=e.data.data.pager;t.setState({tableDataSources:n,totalRows:r.totalRows,currentPage:r.pageIndex,pager:r})}})).catch((function(){t.setState({isLoading:!1})}))}},{key:"handleFilter",value:function(e){console.log("Receve values of form:",e),this.setState({searchParams:e});var t={pageRows:this.state.pageRows,sort:"modifyTime",order:"desc",deviceTypeId:e.deviceTypeId,templateName:e.templateName,pageIndex:0};this.getProtocolTemplateList(t)}},{key:"handlePagination",value:function(e){console.log("Receve values of page:",e),this.setState({currentPage:e}),this.getProtocolTemplateList({pageRows:this.state.pageRows,pageIndex:e})}},{key:"addTemplate",value:function(){this.props.history.push("/config/protocoltemplate/add")}},{key:"editProtocolTemp",value:function(e){this.props.history.push({pathname:"/config/protocoltemplate/edit/".concat(e)})}},{key:"render",value:function(){var e=this.tableColumn,t=this.state.tableDataSources;return this.state.totalRows,l.a.createElement("div",null,l.a.createElement(a.a,null,l.a.createElement("h2",{style:{fontSize:"20px",fontWeight:"bold"}},"协议模板"),l.a.createElement(C,{filterPannelOperation:this.handleFilter.bind(this)}),l.a.createElement("div",{style:{marginTop:"20px"}},l.a.createElement(i.a,{type:"primary",onClick:this.addTemplate.bind(this)},"新增协议模板"))),l.a.createElement(a.a,{style:{marginTop:"10px"}},l.a.createElement(T.a,{bordered:!0,columns:e,dataSource:t,rowKey:"protocolTemplateId",loading:this.state.isLoading,onPageChange:this.handlePagination.bind(this),pager:this.state.pager,scroll:{x:1200,y:"auto"}})))}}])&&D(t.prototype,n),r&&D(t,r),u}(c.Component))||S,F=Object(u.b)((function(e){return{deviceType:e.getIn(["globalDeviceInfo","deviceType"])}}))(A);t.default=F},1585:function(e,t,n){"use strict";n.r(t);n(50),n(51),n(41),n(18),n(39),n(43),n(32),n(44),n(142),n(35),n(22),n(36),n(26),n(27),n(28),n(104);var r=n(46),a=(n(849),n(493)),o=(n(69),n(19)),i=(n(488),n(174)),c=(n(262),n(118)),l=(n(103),n(48)),u=(n(172),n(7)),s=(n(223),n(123)),f=(n(91),n(24)),p=(n(157),n(37)),d=(n(132),n(23)),m=(n(226),n(78),n(224),n(158),n(58),n(112),n(122),n(0)),y=n.n(m),h=n(45),b=n(40),v=n(314),g=n(1470),E=n(9),w=(n(308),n(160)),O=(n(173),n(72));n(1483);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var a=P(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return k(this,n)}}function k(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x,T,L,D=O.a.TabPane,N=[{id:1,name:"字符"},{id:2,name:"数值"},{id:3,name:"枚举"},{id:4,name:"布尔"},{id:5,name:"绝对时间"},{id:6,name:"相对时间"},{id:7,name:"循环时间"},{id:8,name:"RGB颜色"},{id:9,name:"二进制"},{id:10,name:"数组"},{id:11,name:"结构体"}],R=[{title:"协议属性(key)",dataIndex:"mark"},{title:"协议属性名",dataIndex:"describe"},{title:"数据单位",dataIndex:"propertyValueType",width:"90px"},{title:"数据类型",dataIndex:"functionDataType",width:"100px",render:function(e){return e?N[e-1].name:y.a.createElement("span",null,"LONG")}},{title:"字节数",dataIndex:"length",width:"90px"},{title:"数据属性",ellipsis:!0,dataIndex:"dataProperty",render:function(e,t,n){var r="";if(10==t.functionDataType){var a=t.extend||[],o=N[a[0].functionDataType-1].name;r="".concat(a.length,"个").concat(o,"型元素")}else if(11==t.functionDataType){(t.extend||[]).map((function(e,t){var n=e.gap,a=e.mulriple,o=e.unit,i=e.range;r+="数值范围：".concat(i||"--",", 间距：").concat(n||"--",", 倍数：").concat(a||"--",", 单位：").concat(o||"--")}))}else{var i=t.gap,c=t.mulriple,l=t.unit,u=t.range;r="数值范围：".concat(u||"--",", 间距：").concat(i||"--",", 倍数：").concat(c||"--",", 单位：").concat(l||"--")}return y.a.createElement("span",{key:"dataProperty"+n},r)}},{title:"是否保留字",dataIndex:"ignore",width:"110px",render:function(e){return y.a.createElement("span",null,e?"是":"否")}}],_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(o,e);var t,n,r,a=C(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).state={controlList:[],runList:[],errList:[],configList:[]},t}return t=o,(n=[{key:"filterPannel",value:function(){var e=this.props.protocolList||{},t=e["控制数据"]||[],n=e["运行数据"]||[],r=e["故障数据"]||[],a=e["配置数据"]||[];return{dataSource:t.concat(n,r,a),controlList:t,runList:n,errList:r,configList:a}}},{key:"render",value:function(){var e=this.filterPannel(),t=e.dataSource,n=e.controlList,r=e.runList,a=e.errList,o=e.configList;return y.a.createElement(O.a,{animated:!1,className:"protocoltable"},y.a.createElement(D,{tab:"全部",key:"0"},y.a.createElement(w.a,{tableLayout:"fixed",bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:t,pagination:!1})),y.a.createElement(D,{tab:"控制数据",key:"1"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:n,pagination:!1})),y.a.createElement(D,{tab:"运行数据",key:"2"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:r,pagination:!1})),y.a.createElement(D,{tab:"故障数据",key:"3"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:a,pagination:!1})),y.a.createElement(D,{tab:"配置数据",key:"4"},y.a.createElement(w.a,{bordered:!0,rowKey:function(e){return e.mark+e.dataTypeName},columns:R,dataSource:o,pagination:!1})))}}])&&j(t.prototype,n),r&&j(t,r),o}(m.Component),M=n(1461),B=n(33);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G(e);if(t){var a=G(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return W(this,n)}}function W(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=d.a.Item,Q=(p.a.Option,x=Object(h.b)((function(e){return{deviceTypeList:e.getIn(["globalDeviceInfo","deviceType"]),deviceCategoryList:e.getIn(["globalDeviceInfo","deviceCategoryList"]),deviceCascaderList:e.getIn(["globalDeviceInfo","deviceCascaderList"])}})),T=d.a.create({name:"template"}),x(L=Object(b.withRouter)(L=T(L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(h,e);var t,n,p,m=J(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=m.call(this,e)).handeleUpdate=function(e){e.protocolTemplateId=t.state.protocolTemplateId,Object(g.d)(e).then((function(e){t.props.history.push("/config/protocoltemplate/list")}))},t.handleAdd=function(e){Object(g.b)(e).then((function(e){t.props.history.push("/config/protocoltemplate/list")}))},t.handleSubmit=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll((function(e,n){if(!e){if(!n.deviceTypeSelect||!n.deviceTypeSelect.deviceTypeId)return void f.a.warn({message:"提示",description:"请选择设备类型"});var r=n.deviceTypeSelect.deviceTypeId||"",a=n.deviceTypeSelect.deviceSubTypeId||"",o={templateName:n.templateName||"",deviceTypeId:r,deviceSubtypeId:a,templateStatus:n.templateStatus,remark:n.remark||"",language:n.language,bindTypeIds:n.bindTypeIds.join(",")};t.state.templateId&&(o.tempId=t.state.templateId),o=B.d.filterParam(o),t.state.isEdit?t.handeleUpdate(o):t.handleAdd(o)}}))},t.state={isEdit:!1,templateNumber:"0",bindTypeList:[],protocolTempList:[],protocolTemplateId:"",templateId:null,bindTypeIds:[],templateName:"",deviceTypeId:void 0,deviceSubtypeId:void 0,templateStatus:"",remark:"",language:""},t}return t=h,(n=[{key:"checkDeviceTypeSelect",value:function(e,t,n){t.deviceTypeId&&t.deviceSubTypeId?n():n("请选择设备分类")}},{key:"componentDidMount",value:function(){var e=this;Object(v.b)().then((function(t){if(t.data.code===E.a){var n=t.data.data;n?e.setState({bindTypeList:n}):f.a.warn({message:"提示",description:"获取数据字段为空"})}}));var t=this.props.match.params;if(t&&t.templateNumber){this.setState({isEdit:!0,templateNumber:t.templateNumber});var n=t.templateNumber;Object(g.a)(n).then((function(t){if(t.data.code===E.a){var n=t.data.data,r=(n.bindTypeIds||"").split(",");r=r.map((function(e){return+e})),e.setState({templateName:n.templateName||"",deviceTypeId:n.deviceTypeId||"",deviceSubtypeId:n.deviceSubtypeId||"",catagoryId:n.categoryId||"",subCategoryId:n.subCategoryId||"",templateStatus:n.templateStatus+"",templateNumber:n.templateNumber,remark:n.remark||"",language:n.language+"",protocolTempList:n.map||[],protocolTemplateId:n.protocolTemplateId||"",bindTypeIds:r||[]})}}))}}},{key:"handelUploadFile",value:function(e){if(console.log("info.file---",e.file),e.file.status,"done"===e.file.status){var t=e.file.response;if(t.code===E.a){var n=t.data;this.setState({protocolTempList:n.map,templateId:n.tempId}),s.a.success("".concat(e.file.name," 文件上传成功， 文件ID： ").concat(t.data.tempId))}else{var r=t.data;s.a.error("".concat(e.file.name," 文件上传失败， 原因： ").concat(r),10)}}else"error"===e.file.status&&s.a.error("".concat(e.file.name," 文件上传失败"))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.isEdit||!1,n=this.state.bindTypeList,s=this.props.deviceCategoryList||[],f=this.state,p=f.bindTypeIds,m=f.templateName,h=f.deviceTypeId,v=f.deviceSubtypeId,g=f.catagoryId,E=f.subCategoryId,w=f.templateStatus,O=f.remark,I=f.language,j={initialValue:{categoryId:g,subCategoryId:E,deviceTypeId:h,deviceSubTypeId:v}};return y.a.createElement("div",null,y.a.createElement(r.a,null,y.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},y.a.createElement("p",{style:{fontSize:"20px",fontWeight:"bold"}},t?"编辑协议模板":"新增协议模板"),y.a.createElement("div",null,y.a.createElement(b.Link,{to:"/config/protocoltemplate/list",style:{padding:"10px"}},y.a.createElement(u.a,{type:"left"})," 返回"))),y.a.createElement(d.a,F({},{labelCol:{span:2},wrapperCol:{span:22}},{onSubmit:this.handleSubmit}),y.a.createElement(H,{label:"模板名称"},e("templateName",{initialValue:m,rules:[{required:!0,message:"模板名称不能为空"}]})(y.a.createElement(l.a,{maxLength:30,type:"text",style:{width:"300px"},placeholder:"请输入您喜欢的模板名称"}))),y.a.createElement(H,{label:"所属分类"},e("deviceTypeSelect",V(V({},j),{},{rules:[{required:!0,message:"请选择所属分类",validator:this.checkDeviceTypeSelect.bind(this)}]}))(y.a.createElement(M.a,{deviceCategoryList:s}))),y.a.createElement(H,{label:"技术方案"},e("bindTypeIds",{initialValue:p,rules:[{required:!0,message:"请您选择技术方案"}]})(y.a.createElement(c.a.Group,null,n.map((function(e){return y.a.createElement(c.a,{value:e.bindTypeId,key:e.bindTypeName},e.bindTypeName)}))))),y.a.createElement(d.a.Item,{label:"语言版本"},e("language",{rules:[{required:!0,message:"请选择语言版本"}],initialValue:I})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"0",key:"0"},"中文"),y.a.createElement(i.a,{value:"1",key:"1"},"英文")))),y.a.createElement(d.a.Item,{label:"状态"},e("templateStatus",{rules:[{required:!0,message:"请选择发布状态"}],initialValue:w})(y.a.createElement(i.a.Group,{style:{width:150},onChange:this.handleSelectDeviceTypeId},y.a.createElement(i.a,{value:"1",key:"1"},"正式"),y.a.createElement(i.a,{value:"0",key:"0"},"草稿")))),y.a.createElement(H,{label:"模板设置"},e("tempId",{rules:[{required:!t,message:"选择模板"}]})(y.a.createElement("div",null,y.a.createElement(a.a,{name:"uploadJson",showUploadList:!1,action:"/v1/web/manage-open/protocol/template/importJson",onChange:this.handelUploadFile.bind(this),accept:".json"},y.a.createElement(o.a,null,y.a.createElement(u.a,{type:"upload"})," 选择模板")),y.a.createElement("div",null,"（仅支持导入json文件类型，文件扩展名：.json，",y.a.createElement("a",{href:"/v1/web/manage-open/protocol/template/download",style:{color:"#27a9e3"}},"下载模板范本"),"）")))),y.a.createElement(H,{label:"备注"},e("remark",{initialValue:O})(y.a.createElement(l.a.TextArea,{rows:3,placeholder:"请您输入模板的备注内容",maxLength:100}))),y.a.createElement(H,{label:"数据分类"},y.a.createElement(_,{protocolList:this.state.protocolTempList})),y.a.createElement(o.a,{htmlType:"submit",style:{float:"right"}},"提交"))))}}])&&z(t.prototype,n),p&&z(t,p),h}(m.Component))||L)||L)||L);t.default=Q}}]);